<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Global NRI Savings Optimizer ¬∑ India ¬∑ UK ¬∑ USA ¬∑ Netherlands</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root{
  --ink:#0f0e0d;--cream:#f7f3ee;--parch:#ede8e0;
  --india:#e05c2a;--uk:#1a3a6b;--usa:#b22234;--nl:#e67000;
  --gold:#c9a84c;--green:#2d7a4f;--red:#c0392b;
  --bd:rgba(15,14,13,0.14);--sh:0 4px 20px rgba(15,14,13,0.10);
  --r:10px;--sw:310px;
}
*{box-sizing:border-box;margin:0;padding:0;}
html{-webkit-text-size-adjust:100%;}
body{font-family:'DM Sans',sans-serif;background:var(--cream);color:var(--ink);min-height:100vh;}
.hdr{background:var(--ink);color:var(--cream);padding:12px 18px;display:flex;align-items:center;justify-content:space-between;border-bottom:3px solid var(--gold);gap:8px;flex-wrap:wrap;position:sticky;top:0;z-index:50;}
.hdr-l{display:flex;align-items:center;gap:10px;}
.flags{font-size:18px;letter-spacing:-3px;line-height:1;}
.htitle{font-family:'Playfair Display',serif;font-size:16px;font-weight:700;line-height:1.2;}
.hsub{font-size:9.5px;color:rgba(247,243,238,0.5);margin-top:2px;}
.hdr-r{display:flex;align-items:center;gap:6px;flex-wrap:wrap;}
.hbadge{font-size:9px;font-weight:600;letter-spacing:0.6px;text-transform:uppercase;padding:2px 7px;border-radius:20px;border:1px solid rgba(247,243,238,0.2);color:rgba(247,243,238,0.5);}
.email-btn{padding:7px 13px;background:var(--gold);color:var(--ink);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap;}
.menu-btn{display:none;background:none;border:none;color:var(--cream);font-size:22px;cursor:pointer;padding:2px 6px;line-height:1;}
.app{display:flex;min-height:calc(100vh - 52px);}
.sidebar{width:var(--sw);flex-shrink:0;background:var(--parch);border-right:1px solid var(--bd);overflow-y:auto;height:calc(100vh - 52px);position:sticky;top:52px;}
.sb-inner{padding:14px 13px 24px;}
.backdrop{display:none;position:fixed;inset:0;top:52px;background:rgba(15,14,13,0.45);z-index:39;}
.backdrop.show{display:block;}
.main{flex:1;overflow-x:hidden;min-width:0;}
.main-inner{padding:18px 20px;}
.priv{background:#fff8e6;border:1px solid #f0c040;border-left:4px solid var(--gold);border-radius:6px;padding:8px 10px;margin-bottom:12px;font-size:9.5px;line-height:1.5;color:#5a4a0a;display:flex;gap:6px;}
.c-grid{display:grid;grid-template-columns:1fr 1fr;gap:5px;margin-bottom:12px;}
.cbtn{padding:7px 4px;border:1.5px solid var(--bd);border-radius:7px;font-size:11px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;background:#fff;color:rgba(15,14,13,0.55);text-align:center;transition:all .18s;}
.cbtn.on-india{border-color:var(--india);background:rgba(224,92,42,.07);color:var(--india);}
.cbtn.on-uk{border-color:var(--uk);background:rgba(26,58,107,.07);color:var(--uk);}
.cbtn.on-usa{border-color:var(--usa);background:rgba(178,34,52,.07);color:var(--usa);}
.cbtn.on-nl{border-color:var(--nl);background:rgba(230,112,0,.07);color:var(--nl);}
.stitle{font-family:'Playfair Display',serif;font-size:11px;font-weight:700;letter-spacing:.9px;text-transform:uppercase;margin-bottom:9px;padding-bottom:5px;border-bottom:2px solid var(--ink);display:flex;align-items:center;justify-content:space-between;}
.stitle.uk{color:var(--uk);border-color:var(--uk);}
.stitle.india{color:var(--india);border-color:var(--india);}
.stitle.usa{color:var(--usa);border-color:var(--usa);}
.stitle.nl{color:var(--nl);border-color:var(--nl);}
.stitle.gold{color:#7a5a0a;border-color:var(--gold);}
.csec{margin-bottom:7px;border-radius:8px;overflow:hidden;border:1px solid var(--bd);}
.cshdr{display:flex;align-items:center;justify-content:space-between;padding:9px 12px;background:#fff;cursor:pointer;user-select:none;}
.cshdr-l{display:flex;align-items:center;gap:7px;font-size:12px;font-weight:600;}
.arr{font-size:10px;color:rgba(15,14,13,0.4);transition:transform .2s;}
.arr.o{transform:rotate(180deg);}
.csbody{padding:11px;background:#fff;border-top:1px solid var(--bd);}
.csbody.closed{display:none;}
.fg{margin-bottom:10px;}
.fg label{display:block;font-size:9.5px;font-weight:600;letter-spacing:.5px;text-transform:uppercase;color:rgba(15,14,13,.48);margin-bottom:4px;}
.fg input,.fg select{width:100%;padding:7px 10px;border:1.5px solid var(--bd);border-radius:7px;background:var(--cream);font-family:'DM Mono',monospace;font-size:12px;color:var(--ink);outline:none;transition:border-color .18s;-webkit-appearance:none;appearance:none;}
.fg input:focus,.fg select:focus{border-color:var(--gold);background:#fff;}
.fg-hint{font-size:9px;color:rgba(15,14,13,.38);margin-top:3px;font-style:italic;}
.fgrow{display:grid;grid-template-columns:1fr 1fr;gap:7px;}
.sdiv{border:none;border-top:1px dashed var(--bd);margin:11px 0;}
.goal-box{background:linear-gradient(135deg,rgba(201,168,76,.09),rgba(15,14,13,.03));border:1px solid rgba(201,168,76,.35);border-radius:8px;padding:11px;margin-bottom:12px;}
.goal-box-t{font-size:9.5px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:#7a5a0a;margin-bottom:8px;}
.itotal{font-family:'DM Mono',monospace;font-size:11px;font-weight:600;float:right;}
.calc-btn{width:100%;padding:11px;background:var(--ink);color:var(--cream);border:none;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;margin-top:8px;transition:background .18s;}
.calc-btn:hover{background:var(--india);}
.tabs-row{display:flex;border-bottom:1px solid var(--bd);overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;}
.tabs-row::-webkit-scrollbar{display:none;}
.tbtn{padding:9px 13px;font-size:11px;font-weight:600;color:rgba(15,14,13,.5);cursor:pointer;border-bottom:2.5px solid transparent;white-space:nowrap;background:none;border-top:none;border-left:none;border-right:none;font-family:'DM Sans',sans-serif;transition:all .18s;flex-shrink:0;}
.tbtn.active{color:var(--ink);border-bottom-color:var(--gold);}
.tpane{display:none;padding-top:16px;}
.tpane.active{display:block;}
.cg4{display:grid;grid-template-columns:repeat(4,1fr);gap:11px;margin-bottom:14px;}
.cg3{display:grid;grid-template-columns:repeat(3,1fr);gap:11px;margin-bottom:16px;}
.sc{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;position:relative;overflow:hidden;}
.sc::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;}
.sc.uk::before{background:var(--uk);}
.sc.usa::before{background:var(--usa);}
.sc.nl::before{background:var(--nl);}
.sc.india::before{background:var(--india);}
.sc.goal::before{background:var(--green);}
.sc.total::before{background:var(--gold);}
.sc-lbl{font-size:9px;font-weight:600;letter-spacing:.7px;text-transform:uppercase;color:rgba(15,14,13,.42);margin-bottom:5px;}
.sc-val{font-family:'Playfair Display',serif;font-size:21px;font-weight:700;line-height:1;}
.sc.uk .sc-val{color:var(--uk);}
.sc.usa .sc-val{color:var(--usa);}
.sc.nl .sc-val{color:var(--nl);}
.sc.india .sc-val{color:var(--india);}
.sc.goal .sc-val{color:var(--green);}
.sc-sub{font-size:10px;color:rgba(15,14,13,.48);margin-top:4px;line-height:1.4;}
.stpanel{background:var(--ink);border-radius:var(--r);padding:18px;margin-bottom:15px;color:var(--cream);}
.stpanel h2{font-family:'Playfair Display',serif;font-size:15px;margin-bottom:11px;}
.gbar{height:7px;background:rgba(247,243,238,.1);border-radius:4px;margin:8px 0 5px;overflow:hidden;}
.gbar-fill{height:100%;background:var(--gold);border-radius:4px;transition:width .8s ease;}
.gmeta{display:flex;justify-content:space-between;font-size:10px;color:rgba(247,243,238,.5);margin-bottom:13px;flex-wrap:wrap;gap:4px;}
.sgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:9px;}
.scard{background:rgba(247,243,238,.07);border:1px solid rgba(247,243,238,.1);border-radius:7px;padding:11px;}
.scard h3{font-size:9.5px;font-weight:700;letter-spacing:.6px;text-transform:uppercase;color:var(--gold);margin-bottom:7px;}
.si{font-size:11px;line-height:1.5;color:rgba(247,243,238,.82);padding:3.5px 0;border-bottom:1px solid rgba(247,243,238,.07);}
.si:last-child{border-bottom:none;}
.chart-box{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:16px;margin-bottom:15px;}
.chart-box-t{font-family:'Playfair Display',serif;font-size:14px;margin-bottom:12px;}
canvas{width:100%!important;max-height:250px;}
.alloc-box{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:15px;margin-bottom:15px;}
.abar{display:flex;gap:2px;height:24px;border-radius:5px;overflow:hidden;margin-bottom:9px;}
.aseg{height:100%;display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:700;color:#fff;overflow:hidden;white-space:nowrap;}
.aleg{display:flex;flex-wrap:wrap;gap:7px;}
.aleg-item{display:flex;align-items:center;gap:4px;font-size:10px;}
.adot{width:8px;height:8px;border-radius:2px;flex-shrink:0;}
.sal-tabs{display:flex;border:1px solid var(--bd);border-radius:7px;overflow:hidden;margin-bottom:14px;}
.stab{flex:1;padding:8px 6px;text-align:center;font-size:11px;font-weight:600;cursor:pointer;background:#fff;border:none;font-family:'DM Sans',sans-serif;color:rgba(15,14,13,.5);transition:all .18s;border-right:1px solid var(--bd);}
.stab:last-child{border-right:none;}
.stab.a-uk{background:var(--uk);color:#fff;}
.stab.a-usa{background:var(--usa);color:#fff;}
.stab.a-nl{background:var(--nl);color:#fff;}
.stab.a-india{background:var(--india);color:#fff;}
.spane{display:none;}
.spane.active{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.sal-in{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:16px;}
.sal-in h3{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:12px;}
.sal-res{background:var(--ink);border-radius:var(--r);padding:16px;color:var(--cream);}
.sal-res h3{font-family:'Playfair Display',serif;font-size:13px;color:var(--cream);margin-bottom:10px;}
.ptabs{display:flex;gap:4px;margin-bottom:10px;}
.ptab{padding:4px 8px;font-size:10px;font-weight:600;border:1px solid rgba(247,243,238,.2);border-radius:5px;cursor:pointer;background:transparent;color:rgba(247,243,238,.55);font-family:'DM Sans',sans-serif;}
.ptab.active{background:var(--gold);color:var(--ink);border-color:var(--gold);}
.rr{display:flex;justify-content:space-between;align-items:center;padding:5.5px 0;border-bottom:1px solid rgba(247,243,238,.08);font-size:10.5px;}
.rr:last-child{border-bottom:none;}
.rl{color:rgba(247,243,238,.65);}
.rv{font-family:'DM Mono',monospace;font-weight:600;color:var(--cream);}
.rv.hi{color:var(--gold);}
.rv.dn{color:#f4a07a;}
.rv.up{color:#7fd4a8;}
.rsec{font-size:9px;font-weight:700;letter-spacing:.8px;text-transform:uppercase;color:rgba(247,243,238,.35);padding:8px 0 2px;}
.ig{display:grid;grid-template-columns:1fr 1fr;gap:13px;margin-bottom:14px;}
.ipanel{background:#fff;border:1px solid var(--bd);border-radius:var(--r);overflow:hidden;}
.ihdr{padding:10px 14px;font-family:'Playfair Display',serif;font-size:12.5px;font-weight:700;display:flex;align-items:center;gap:7px;}
.ipanel.p-uk .ihdr{background:rgba(26,58,107,.06);color:var(--uk);}
.ipanel.p-usa .ihdr{background:rgba(178,34,52,.06);color:var(--usa);}
.ipanel.p-nl .ihdr{background:rgba(230,112,0,.06);color:var(--nl);}
.ipanel.p-india .ihdr{background:rgba(224,92,42,.06);color:var(--india);}
.irow{display:grid;grid-template-columns:1fr auto auto;gap:6px;padding:7px 14px;border-top:1px solid var(--bd);align-items:center;font-size:11px;}
.irow:hover{background:var(--parch);}
.ilimit{font-size:9px;color:rgba(15,14,13,.4);font-style:italic;}
.irate{font-family:'DM Mono',monospace;font-size:9.5px;padding:2px 5px;border-radius:20px;background:rgba(201,168,76,.13);color:#7a5a0a;font-weight:600;white-space:nowrap;}
.ibadge{font-size:9px;font-weight:600;padding:2px 5px;border-radius:20px;white-space:nowrap;}
.ib-ok{background:rgba(45,122,79,.11);color:var(--green);}
.ib-w{background:rgba(224,92,42,.11);color:var(--india);}
.ib-no{background:rgba(192,57,43,.11);color:var(--red);}
.tgrid{display:grid;grid-template-columns:1fr 1fr;gap:13px;}
.tcard{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:15px;}
.tcard h3{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:10px;}
.tr2{display:flex;justify-content:space-between;padding:6px 0;border-top:1px solid var(--bd);font-size:11px;}
.tr2:first-of-type{border-top:none;}
.tv{font-family:'DM Mono',monospace;font-size:10.5px;font-weight:500;}
.tv.r{color:var(--red);}
.tv.g{color:var(--green);}
.cgrid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px;}
.ccard{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;}
.ccard h3{font-family:'Playfair Display',serif;font-size:12.5px;margin-bottom:9px;}
.ci{display:flex;justify-content:space-between;align-items:flex-start;padding:6px 0;border-top:1px solid var(--bd);gap:8px;font-size:11px;}
.ci:first-of-type{border-top:none;}
.ci-d{font-size:9.5px;color:rgba(15,14,13,.45);margin-top:2px;}
.chip{font-size:9px;font-weight:700;padding:2px 5px;border-radius:20px;white-space:nowrap;flex-shrink:0;}
.chip.ok{background:rgba(45,122,79,.12);color:var(--green);}
.chip.rev{background:rgba(201,168,76,.18);color:#7a5a0a;}
.chip.alert{background:rgba(192,57,43,.12);color:var(--red);}
.rgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:13px;}
.rcard{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:12px;}
.rcard.best{border-color:var(--green);}
.rcard.best .rp::after{content:' ‚òÖ Best';font-size:9px;color:var(--green);}
.rp{font-weight:700;font-size:12px;margin-bottom:3px;}
.rrate{font-family:'DM Mono',monospace;font-size:15px;color:var(--uk);font-weight:600;}
.rfee{font-size:10px;color:rgba(15,14,13,.45);margin-top:2px;}
.ai-wrap{background:var(--ink);border-radius:var(--r);padding:18px;color:var(--cream);}
.ai-hdr{display:flex;align-items:center;gap:9px;margin-bottom:12px;}
.ai-av{width:34px;height:34px;background:var(--gold);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;}
.ai-hdr h2{font-family:'Playfair Display',serif;font-size:15px;}
.ai-hdr p{font-size:10px;color:rgba(247,243,238,.45);margin-top:2px;}
.chat-win{background:rgba(247,243,238,.06);border-radius:8px;padding:11px;height:260px;overflow-y:auto;margin-bottom:9px;display:flex;flex-direction:column;gap:8px;}
.msg{max-width:88%;}
.msg.ai{align-self:flex-start;}
.msg.user{align-self:flex-end;}
.mb{padding:8px 11px;border-radius:9px;font-size:11.5px;line-height:1.55;}
.msg.ai .mb{background:rgba(247,243,238,.1);color:var(--cream);border-bottom-left-radius:3px;}
.msg.user .mb{background:var(--gold);color:var(--ink);font-weight:500;border-bottom-right-radius:3px;}
.mtime{font-size:9px;color:rgba(247,243,238,.28);margin-top:2px;padding:0 3px;}
.msg.user .mtime{text-align:right;}
.chat-row{display:flex;gap:7px;}
.chat-in{flex:1;padding:9px 12px;background:rgba(247,243,238,.1);border:1.5px solid rgba(247,243,238,.14);border-radius:8px;color:var(--cream);font-family:'DM Sans',sans-serif;font-size:11.5px;outline:none;}
.chat-in::placeholder{color:rgba(247,243,238,.28);}
.chat-in:focus{border-color:var(--gold);}
.send-btn{padding:9px 15px;background:var(--gold);color:var(--ink);border:none;border-radius:8px;font-weight:700;font-size:11.5px;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap;}
.send-btn:disabled{opacity:.5;}
.qq-wrap{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:9px;}
.qq{font-size:10px;padding:4px 9px;border-radius:20px;border:1px solid rgba(247,243,238,.18);color:rgba(247,243,238,.6);background:transparent;cursor:pointer;font-family:'DM Sans',sans-serif;}
.qq:hover{background:rgba(247,243,238,.1);border-color:var(--gold);}
.dot{width:6px;height:6px;background:var(--gold);border-radius:50%;animation:bop 1.2s infinite;display:inline-block;margin:0 2px;}
.dot:nth-child(2){animation-delay:.2s;}
.dot:nth-child(3){animation-delay:.4s;}
@keyframes bop{0%,80%,100%{transform:translateY(0);}40%{transform:translateY(-5px);}}
.banner{background:linear-gradient(135deg,rgba(224,92,42,.06),rgba(26,58,107,.06));border:1px solid var(--bd);border-left:4px solid var(--india);border-radius:7px;padding:11px 14px;margin-bottom:14px;font-size:11.5px;line-height:1.6;}
.ibox{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;margin-bottom:14px;}
.ibox h3{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:9px;}
.treaty-tbl{width:100%;border-collapse:collapse;font-size:11px;}
.treaty-tbl th{padding:7px 10px;text-align:left;background:var(--parch);border-bottom:2px solid var(--bd);}
.treaty-tbl td{padding:6px 10px;border-bottom:1px solid var(--bd);}
.treaty-tbl tr:nth-child(even) td{background:rgba(15,14,13,.02);}
.modal-bg{display:none;position:fixed;inset:0;background:rgba(15,14,13,.55);z-index:200;align-items:center;justify-content:center;padding:16px;}
.modal-bg.open{display:flex;}
.modal{background:var(--cream);border-radius:12px;padding:22px;width:100%;max-width:460px;box-shadow:var(--sh);position:relative;}
.modal h2{font-family:'Playfair Display',serif;font-size:17px;margin-bottom:5px;}
.modal p{font-size:11px;color:rgba(15,14,13,.58);margin-bottom:13px;line-height:1.5;}
.modal-x{position:absolute;top:12px;right:12px;background:none;border:none;font-size:18px;cursor:pointer;color:rgba(15,14,13,.38);}
.modal-priv{font-size:9.5px;color:rgba(15,14,13,.42);margin-bottom:11px;font-style:italic;}
.modal-btns{display:flex;gap:7px;justify-content:flex-end;margin-top:12px;}
.btn-sec{padding:8px 15px;background:transparent;border:1.5px solid var(--bd);border-radius:7px;font-size:11.5px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;color:var(--ink);}
.btn-pri{padding:8px 17px;background:var(--ink);color:var(--cream);border:none;border-radius:7px;font-size:11.5px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;}
.btn-pri:hover{background:var(--india);}
.disclaimer{background:rgba(15,14,13,.04);border-top:1px solid var(--bd);padding:8px 18px;font-size:10px;color:rgba(15,14,13,.42);text-align:center;line-height:1.5;}
.hidden{display:none!important;}
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-thumb{background:rgba(15,14,13,.16);border-radius:3px;}

/* ‚îÄ‚îÄ UK SALARY TABS ‚îÄ‚îÄ */
.uk-sal-hero{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.uk-sal-lbl{font-size:15px;font-weight:400;white-space:nowrap}
.uk-sal-input{flex:1;min-width:140px;padding:9px 12px;border:2px solid var(--bd);border-radius:8px;font-family:'DM Mono',monospace;font-size:16px;color:var(--ink);outline:none;background:var(--cream)}
.uk-sal-input:focus{border-color:#8b1a2a}
.uk-tip{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:50%;background:rgba(15,14,13,.12);font-size:10px;cursor:help;flex-shrink:0}
.uk-tabs-strip{display:flex;background:#8b1a2a;border-radius:8px 8px 0 0;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;margin-top:10px}
.uk-tabs-strip::-webkit-scrollbar{display:none}
.uk-tab{padding:9px 11px;font-size:11px;font-weight:600;color:rgba(255,255,255,.65);cursor:pointer;border:none;background:transparent;font-family:'DM Sans',sans-serif;white-space:nowrap;border-right:1px solid rgba(255,255,255,.12);flex-shrink:0;transition:all .15s}
.uk-tab:last-child{border-right:none}
.uk-tab.active,.uk-tab:hover{color:#fff;background:rgba(0,0,0,.18)}
.uk-tab-pane{display:none;padding:12px;border:1px solid var(--bd);border-top:none;border-radius:0 0 8px 8px;background:#fff}
.uk-tab-pane.active{display:block}
.uk-pen-toggle{flex:1;padding:8px 10px;font-size:11px;font-weight:600;cursor:pointer;border:none;background:#fff;color:rgba(15,14,13,.5);font-family:'DM Sans',sans-serif;transition:all .15s}
.uk-pen-toggle.active{background:#8b1a2a;color:#fff}
.uk-periods{display:flex;flex-wrap:wrap;gap:12px;padding:10px 0;border-top:1px dashed var(--bd);margin-top:6px}
.uk-period-lbl{display:flex;align-items:center;gap:5px;font-size:12px;cursor:pointer}
/* ‚îÄ‚îÄ QUESTIONNAIRE ‚îÄ‚îÄ */
.qsec{border:1px solid var(--bd);border-radius:8px;margin-bottom:8px;overflow:hidden}
.qsec-hdr{display:flex;align-items:center;justify-content:space-between;padding:11px 14px;background:#fff;cursor:pointer;user-select:none;font-size:12px;font-weight:600}
.qsec-hdr:hover{background:var(--parch)}
.qsec-body{padding:13px;background:#fff;border-top:1px solid var(--bd)}
.qgrid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
@media(max-width:500px){.qgrid{grid-template-columns:1fr}.uk-sal-lbl{font-size:13px}}


@media(max-width:1100px){
  :root{--sw:270px;}
  .cg4{grid-template-columns:1fr 1fr;}
  .sgrid{grid-template-columns:1fr 1fr;}
  .tgrid{grid-template-columns:1fr 1fr;}
  .spane.active{grid-template-columns:1fr;}
}
@media(max-width:820px){
  :root{--sw:260px;}
  .cg4{grid-template-columns:1fr 1fr;}
  .cg3{grid-template-columns:1fr 1fr;}
  .sgrid{grid-template-columns:1fr 1fr;}
  .ig{grid-template-columns:1fr;}
  .cgrid{grid-template-columns:1fr;}
  .spane.active{grid-template-columns:1fr;}
  .main-inner{padding:13px 13px;}
  .hbadge{display:none;}
}
@media(max-width:640px){
  .app{display:block;}
  .sidebar{
    position:fixed;top:52px;left:0;bottom:0;
    width:88vw;max-width:300px;z-index:40;
    transform:translateX(-100%);
    transition:transform .28s cubic-bezier(.4,0,.2,1);
    height:calc(100vh - 52px);
    box-shadow:4px 0 24px rgba(15,14,13,.2);
  }
  .sidebar.open{transform:translateX(0);}
  .menu-btn{display:flex;align-items:center;}
  .hsub{display:none;}
  .main{display:block;width:100%;}
  .main-inner{padding:11px 11px;}
  .cg4{grid-template-columns:1fr 1fr;}
  .cg3{grid-template-columns:1fr;}
  .sgrid{grid-template-columns:1fr;}
  .ig{grid-template-columns:1fr;}
  .tgrid{grid-template-columns:1fr;}
  .cgrid{grid-template-columns:1fr;}
  .rgrid{grid-template-columns:1fr 1fr;}
  .spane.active{grid-template-columns:1fr;}
  .sal-tabs{flex-wrap:wrap;}
  .stab{flex:1 0 40%;}
  .tbtn{font-size:10.5px;padding:8px 10px;}
  canvas{max-height:200px;}
  .fgrow{grid-template-columns:1fr;}
  .sc-val{font-size:18px;}
}
@media(max-width:380px){
  .cg4{grid-template-columns:1fr;}
  .rgrid{grid-template-columns:1fr;}
  .sal-tabs{flex-direction:column;}
}
</style>
</head>
<body>

<header class="hdr">
  <div class="hdr-l">
    <button class="menu-btn" id="menuBtn" onclick="toggleSB()" aria-label="Menu">‚ò∞</button>
    <div class="flags">üáÆüá≥üá¨üáßüá∫üá∏üá≥üá±</div>
    <div>
      <div class="htitle">Global NRI Savings Optimizer</div>
      <div class="hsub">India ¬∑ UK ¬∑ USA ¬∑ Netherlands ¬∑ Educational Tool</div>
    </div>
  </div>
  <div class="hdr-r">
    <span class="hbadge">FEMA 2000</span>
    <span class="hbadge">DTAA</span>
    <span class="hbadge">FY 2025‚Äì26</span>
    <button class="email-btn" onclick="openMail()">üìß Email Summary</button>
  </div>
</header>

<div class="backdrop" id="bd" onclick="closeSB()"></div>
<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar" id="sb">
<div class="sb-inner">
<div class="priv"><span style="font-size:13px;flex-shrink:0">üîí</span><div><strong>Privacy:</strong> No names, NI/PAN/SSN or bank details. Approximate figures only. All calculations run locally ‚Äî nothing stored or sent.</div></div>

<div class="stitle" style="margin-bottom:8px">Active Countries</div>
<div class="c-grid">
  <button class="cbtn on-india" id="cb-india" onclick="toggleC('india')">üáÆüá≥ India</button>
  <button class="cbtn on-uk" id="cb-uk" onclick="toggleC('uk')">üá¨üáß UK</button>
  <button class="cbtn on-usa" id="cb-usa" onclick="toggleC('usa')">üá∫üá∏ USA</button>
  <button class="cbtn on-nl" id="cb-nl" onclick="toggleC('nl')">üá≥üá± Netherlands</button>
</div>

<div class="stitle">üë§ Profile</div>
<div class="fg"><label>Current Age</label><input type="number" id="age" value="32" min="18" max="70"></div>
<div class="goal-box">
  <div class="goal-box-t">üéØ Wealth Goal</div>
  <div class="fg"><label>Target (¬£ equiv.)</label><input type="number" id="goalAmt" value="500000"><div class="fg-hint">Use ¬£ as base currency for cross-country comparison</div></div>
  <div class="fgrow">
    <div class="fg"><label>By Age</label><input type="number" id="goalAge" value="55" min="20" max="80"></div>
    <div class="fg"><label>Risk</label><select id="risk"><option value="conservative">Conservative</option><option value="moderate" selected>Moderate</option><option value="aggressive">Aggressive</option></select></div>
  </div>
</div>

<div class="stitle gold">üí± Exchange Rates</div>
<div class="fgrow">
  <div class="fg"><label>‚Çπ INR/¬£</label><input type="number" id="fxI" value="107" min="1"></div>
  <div class="fg"><label>$ USD/¬£</label><input type="number" id="fxU" value="0.79" step="0.01"></div>
</div>
<div class="fg"><label>‚Ç¨ EUR/¬£</label><input type="number" id="fxE" value="0.85" step="0.01"></div>
<div class="sdiv"></div>

<!-- UK -->
<div class="csec" id="csec-uk">
  <div class="cshdr" onclick="toggleSec('uk')">
    <div class="cshdr-l">üá¨üáß <span style="color:var(--uk)">UK</span></div>
    <span class="arr o" id="arr-uk">‚ñº</span>
  </div>
  <div class="csbody" id="body-uk">
    <div class="fg"><label>Base Salary (¬£/yr) <span class="itotal" id="ukTot">¬£0</span></label><input type="number" id="ukBase" value="65000" oninput="updTotals()"></div>
    <div class="fgrow">
      <div class="fg"><label>Bonus (¬£/yr)</label><input type="number" id="ukBonus" value="8000" oninput="updTotals()"></div>
      <div class="fg"><label>RSU/Stock (¬£/yr)</label><input type="number" id="ukStock" value="5000" oninput="updTotals()"></div>
    </div>
    <div class="fg"><label>Employee Pension %</label><input type="number" id="ukPen" value="5" min="0" max="60"></div>
    <div class="fgrow">
      <div class="fg"><label>Student Loan</label><select id="ukSL"><option value="none">None</option><option value="plan1">Plan 1</option><option value="plan2" selected>Plan 2</option><option value="plan5">Plan 5</option></select></div>
      <div class="fg"><label>Scotland?</label><select id="ukScot"><option value="no">No</option><option value="yes">Yes</option></select></div>
    </div>
    <div class="sdiv"></div>
    <div class="stitle uk">Allocations (¬£/mo)</div>
    <div class="fg"><label>ISA</label><input type="number" id="isa" value="1000"><div class="fg-hint">Limit ¬£20K/yr ‚Äî all growth tax-free</div></div>
    <div class="fg"><label>SIPP Pension</label><input type="number" id="sipp" value="600"></div>
    <div class="fg"><label>Cash / HYSA</label><input type="number" id="ukCash" value="400"></div>
  </div>
</div>

<!-- USA -->
<div class="csec" id="csec-usa">
  <div class="cshdr" onclick="toggleSec('usa')">
    <div class="cshdr-l">üá∫üá∏ <span style="color:var(--usa)">USA</span></div>
    <span class="arr o" id="arr-usa">‚ñº</span>
  </div>
  <div class="csbody" id="body-usa">
    <div class="fg"><label>Base Salary ($/yr) <span class="itotal" id="usaTot">$0</span></label><input type="number" id="usaBase" value="120000" oninput="updTotals()"></div>
    <div class="fgrow">
      <div class="fg"><label>Bonus ($/yr)</label><input type="number" id="usaBonus" value="15000" oninput="updTotals()"></div>
      <div class="fg"><label>RSU/Stock ($/yr)</label><input type="number" id="usaStock" value="20000" oninput="updTotals()"></div>
    </div>
    <div class="fgrow">
      <div class="fg"><label>Filing Status</label><select id="usaFiling"><option value="single" selected>Single</option><option value="mfj">MFJ</option></select></div>
      <div class="fg"><label>State Tax</label><select id="usaState"><option value="0">TX/FL/WA 0%</option><option value="4.95">IL 4.95%</option><option value="5">Other ~5%</option><option value="6">VA/GA ~6%</option><option value="9.3">CA up to 13.3%</option><option value="9">NY ~10.9%</option><option value="10.75">NJ max 10.75%</option></select></div>
    </div>
    <div class="sdiv"></div>
    <div class="stitle usa">Allocations ($/mo)</div>
    <div class="fg"><label>401(k)</label><input type="number" id="k401" value="1500"><div class="fg-hint">2025 limit $23,500/yr ‚Äî pre-tax</div></div>
    <div class="fg"><label>Roth IRA</label><input type="number" id="roth" value="583"><div class="fg-hint">2025 limit $7,000/yr ‚Äî tax-free growth</div></div>
    <div class="fg"><label>HSA (HDHP)</label><input type="number" id="hsa" value="300"><div class="fg-hint">$4,300/yr self ‚Äî triple tax advantage</div></div>
    <div class="fg"><label>Brokerage</label><input type="number" id="usaBrok" value="500"></div>
  </div>
</div>

<!-- Netherlands -->
<div class="csec" id="csec-nl">
  <div class="cshdr" onclick="toggleSec('nl')">
    <div class="cshdr-l">üá≥üá± <span style="color:var(--nl)">Netherlands</span></div>
    <span class="arr o" id="arr-nl">‚ñº</span>
  </div>
  <div class="csbody" id="body-nl">
    <div class="fg"><label>Base Salary (‚Ç¨/yr) <span class="itotal" id="nlTot">‚Ç¨0</span></label><input type="number" id="nlBase" value="80000" oninput="updTotals()"></div>
    <div class="fgrow">
      <div class="fg"><label>Bonus (‚Ç¨/yr)</label><input type="number" id="nlBonus" value="10000" oninput="updTotals()"></div>
      <div class="fg"><label>RSU/Stock (‚Ç¨/yr)</label><input type="number" id="nlStock" value="8000" oninput="updTotals()"></div>
    </div>
    <div class="fg"><label>30% Ruling?</label><select id="nl30"><option value="no">No</option><option value="yes" selected>Yes ‚Äî up to 5 yrs</option></select><div class="fg-hint">30% of salary tax-free for eligible expats</div></div>
    <div class="sdiv"></div>
    <div class="stitle nl">Allocations (‚Ç¨/mo)</div>
    <div class="fg"><label>Pensioenrekening</label><input type="number" id="nlPen" value="400"><div class="fg-hint">Tax-deductible ‚Äî reduces Box 1 tax</div></div>
    <div class="fg"><label>Beleggingsrekening</label><input type="number" id="nlBrok" value="600"><div class="fg-hint">Box 3 wealth tax applies above ‚Ç¨57K</div></div>
    <div class="fg"><label>Spaarrekening</label><input type="number" id="nlCash" value="300"></div>
  </div>
</div>

<!-- India -->
<div class="csec" id="csec-india">
  <div class="cshdr" onclick="toggleSec('india')">
    <div class="cshdr-l">üáÆüá≥ <span style="color:var(--india)">India</span></div>
    <span class="arr o" id="arr-india">‚ñº</span>
  </div>
  <div class="csbody" id="body-india">
    <div class="fg"><label>India Income <span class="itotal" id="inTot">‚Çπ0</span></label></div>
    <div class="fgrow">
      <div class="fg"><label>Rental (‚Çπ/yr)</label><input type="number" id="inRent" value="300000" oninput="updTotals()"></div>
      <div class="fg"><label>Dividends (‚Çπ/yr)</label><input type="number" id="inDiv" value="50000" oninput="updTotals()"></div>
    </div>
    <div class="fgrow">
      <div class="fg"><label>FD Interest (‚Çπ/yr)</label><input type="number" id="inFD" value="100000" oninput="updTotals()"></div>
      <div class="fg"><label>Cap Gains (‚Çπ/yr)</label><input type="number" id="inCG" value="50000" oninput="updTotals()"></div>
    </div>
    <div class="sdiv"></div>
    <div class="stitle india">Allocations (‚Çπ/mo)</div>
    <div class="fg"><label>NRE Fixed Deposit</label><input type="number" id="nreFD" value="20000"><div class="fg-hint">Tax-free in India; taxable in residence country</div></div>
    <div class="fg"><label>NRO Fixed Deposit</label><input type="number" id="nroFD" value="10000"><div class="fg-hint">TDS 30% ‚Üí ~15% via Form 10F + TRC</div></div>
    <div class="fg"><label>Mutual Funds</label><input type="number" id="mf" value="15000"><div class="fg-hint">NRI KYC + FATCA; ‚ö† US persons ‚Äî PFIC rules apply</div></div>
  </div>
</div>

<button class="calc-btn" onclick="calc()">‚ö° Calculate Strategy</button>
</div><!-- /sb-inner -->
</aside>

<!-- MAIN CONTENT -->
<main class="main">
<div class="main-inner">

<div class="tabs-row">
  <button class="tbtn active" onclick="switchTab('strategy',this)">üß≠ Strategy</button>
  <button class="tbtn" onclick="switchTab('salary',this)">üí∂ Salary</button>
  <button class="tbtn" onclick="switchTab('instruments',this)">üè¶ Instruments</button>
  <button class="tbtn" onclick="switchTab('tax',this)">üí∏ Tax & Treaties</button>
  <button class="tbtn" onclick="switchTab('compliance',this)">‚öñÔ∏è Compliance</button>
  <button class="tbtn" onclick="switchTab('remittance',this)">üí± Remittance</button>
  <button class="tbtn" onclick="switchTab('questionnaire',this)">üìã Profile</button>
  <button class="tbtn" onclick="switchTab('advisor',this)">ü§ñ AI Advisor</button>
</div>

<!-- ‚ïê‚ïê‚ïê STRATEGY ‚ïê‚ïê‚ïê -->
<div class="tpane active" id="tab-strategy">
  <div class="cg4">
    <div class="sc uk" id="sc-uk"><div class="sc-lbl">üá¨üáß UK Take-Home</div><div class="sc-val" id="cv-uk">¬£52K</div><div class="sc-sub" id="cs-uk">After tax & NI</div></div>
    <div class="sc usa" id="sc-usa"><div class="sc-lbl">üá∫üá∏ USA Take-Home</div><div class="sc-val" id="cv-usa">$92K</div><div class="sc-sub" id="cs-usa">After federal + state + FICA</div></div>
    <div class="sc nl" id="sc-nl"><div class="sc-lbl">üá≥üá± NL Take-Home</div><div class="sc-val" id="cv-nl">‚Ç¨61K</div><div class="sc-sub" id="cs-nl">After Box 1 tax</div></div>
    <div class="sc india" id="sc-india"><div class="sc-lbl">üáÆüá≥ India Portfolio</div><div class="sc-val" id="cv-india">‚Çπ5.4L</div><div class="sc-sub">NRE + NRO + MF annual</div></div>
  </div>
  <div class="cg3">
    <div class="sc total"><div class="sc-lbl">üåç Annual Savings (¬£ equiv.)</div><div class="sc-val" id="cv-total">¬£31K</div><div class="sc-sub" id="cs-total">All active countries</div></div>
    <div class="sc goal"><div class="sc-lbl">üéØ Goal Progress</div><div class="sc-val" id="cv-goal">6%</div><div class="sc-sub" id="cs-goal">Toward ¬£500K target</div></div>
    <div class="sc" style="border-top:3px solid var(--green)"><div class="sc-lbl">‚è± Years to Goal</div><div class="sc-val" id="cv-yrs" style="color:var(--green)">23</div><div class="sc-sub" id="cs-yrs">Age 32 ‚Üí 55</div></div>
  </div>
  <div class="stpanel">
    <h2>üß≠ Personalised Multi-Country Wealth Strategy</h2>
    <div class="gbar"><div class="gbar-fill" id="gbarFill" style="width:6%"></div></div>
    <div class="gmeta"><span id="gmetaL">¬£0/yr saving toward ¬£500K</span><span id="gmetaR">23 years to goal age 55</span></div>
    <div class="sgrid" id="stratGrid"><div class="scard"><h3>Loading‚Ä¶</h3><div class="si">Press Calculate to generate your personalised strategy</div></div></div>
  </div>
  <div class="chart-box">
    <div class="chart-box-t">üìà Projected Wealth Growth by Country (¬£)</div>
    <canvas id="growthChart"></canvas>
  </div>
  <div class="alloc-box">
    <div style="font-family:'Playfair Display',serif;font-size:14px;margin-bottom:10px">üíº Annual Savings Allocation</div>
    <div class="abar" id="allocBar"></div>
    <div class="aleg" id="allocLeg"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê SALARY ‚ïê‚ïê‚ïê -->
<div class="tpane" id="tab-salary">
  <div style="margin-bottom:13px">
    <div style="font-family:'Playfair Display',serif;font-size:18px;margin-bottom:4px">üí∂ Take-Home Salary Calculators</div>
    <p style="font-size:11.5px;color:rgba(15,14,13,.58)">Full net-pay breakdown for UK, USA and Netherlands, plus India NRI tax position. Estimates ‚Äî consult a tax professional for exact figures.</p>
  </div>
  <div class="sal-tabs">
    <button class="stab a-uk" onclick="switchSal('uk',this)">üá¨üáß UK</button>
    <button class="stab" onclick="switchSal('usa',this)">üá∫üá∏ USA</button>
    <button class="stab" onclick="switchSal('nl',this)">üá≥üá± Netherlands</button>
    <button class="stab" onclick="switchSal('india',this)">üáÆüá≥ India (NRI)</button>
  </div>

  <!-- UK Salary -->
  <div class="spane active" id="sal-uk">
    <div class="sal-in">
      <h3>üá¨üáß UK Salary Calculator</h3>

      <!-- Salary input row -->
      <div class="uk-sal-hero">
        <label class="uk-sal-lbl">I want to see the breakdown for a salary of ¬£</label>
        <input type="number" id="su_base" value="65000" oninput="calcUK()" class="uk-sal-input" placeholder="e.g. 65000">
      </div>
      <div class="fg" style="margin-top:8px">
        <label style="display:flex;align-items:center;gap:7px;font-size:12px;font-weight:500;cursor:pointer">
          <input type="checkbox" id="su_scot" onchange="calcUK()" style="width:16px;height:16px;cursor:pointer"> Resident in Scotland?
          <span class="uk-tip" title="Scottish income tax rates differ from the rest of the UK">?</span>
        </label>
      </div>

      <!-- Tab strip -->
      <div class="uk-tabs-strip" id="ukTabStrip">
        <button class="uk-tab active" data-tab="taxcode" onclick="switchUKTab('taxcode',this)">Tax Code</button>
        <button class="uk-tab" data-tab="studentloan" onclick="switchUKTab('studentloan',this)">Student Loan</button>
        <button class="uk-tab" data-tab="pension" onclick="switchUKTab('pension',this)">Pension</button>
        <button class="uk-tab" data-tab="bonus" onclick="switchUKTab('bonus',this)">Bonus</button>
        <button class="uk-tab" data-tab="overtime" onclick="switchUKTab('overtime',this)">Overtime</button>
        <button class="uk-tab" data-tab="childcare" onclick="switchUKTab('childcare',this)">Childcare</button>
        <button class="uk-tab" data-tab="salsac" onclick="switchUKTab('salsac',this)">Salary Sacrifice</button>
        <button class="uk-tab" data-tab="taxbenefits" onclick="switchUKTab('taxbenefits',this)">Taxable Benefits</button>
        <button class="uk-tab" data-tab="addopts" onclick="switchUKTab('addopts',this)">Additional Options</button>
      </div>

      <!-- Tab panes -->
      <div class="uk-tab-pane active" id="ukt-taxcode">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">If you know your tax code, please enter it here.</p>
        <div class="fg"><input type="text" id="su_taxcode" placeholder="e.g. 1257L" oninput="calcUK()" style="font-size:13px"></div>
        <div class="fg-hint">Leave blank to use the standard 1257L personal allowance (¬£12,570). The most common tax code for 2025/26.</div>
      </div>
      <div class="uk-tab-pane" id="ukt-studentloan">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">If you're still repaying your Student Loan, please select the repayment option that applies to you.</p>
        <div class="fg">
          <label style="display:flex;align-items:center;gap:7px;font-size:12px;margin-bottom:6px;cursor:pointer"><input type="checkbox" id="su_sl1" onchange="calcUK()" style="width:15px;height:15px"> Repayment Plan 1</label>
          <label style="display:flex;align-items:center;gap:7px;font-size:12px;margin-bottom:6px;cursor:pointer"><input type="checkbox" id="su_sl2" onchange="calcUK()" style="width:15px;height:15px"> Repayment Plan 2</label>
          <label style="display:flex;align-items:center;gap:7px;font-size:12px;margin-bottom:6px;cursor:pointer"><input type="checkbox" id="su_sl4" onchange="calcUK()" style="width:15px;height:15px"> Repayment Plan 4 (Scotland)</label>
          <label style="display:flex;align-items:center;gap:7px;font-size:12px;margin-bottom:6px;cursor:pointer"><input type="checkbox" id="su_sl5" onchange="calcUK()" style="width:15px;height:15px"> Repayment Plan 5</label>
          <label style="display:flex;align-items:center;gap:7px;font-size:12px;cursor:pointer"><input type="checkbox" id="su_slpg" onchange="calcUK()" style="width:15px;height:15px"> Postgraduate Loan</label>
        </div>
      </div>
      <div class="uk-tab-pane" id="ukt-pension">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">Do you contribute to a pension?</p>
        <div style="display:flex;gap:7px;align-items:flex-start;flex-wrap:wrap">
          <div style="border:1px solid var(--bd);border-radius:7px;overflow:hidden;min-width:160px">
            <button class="uk-pen-toggle active" id="penPctBtn" onclick="switchPenMode('pct')">Percentage</button>
            <button class="uk-pen-toggle" id="penAmtBtn" onclick="switchPenMode('amt')">¬£ Amount</button>
          </div>
          <div style="flex:1;min-width:120px">
            <div class="fg" id="penPctDiv"><label>I contribute</label><input type="number" id="su_eep" value="5" min="0" max="100" step="0.5" oninput="calcUK()"><span style="font-size:12px;margin-top:3px;display:block">%</span></div>
            <div class="fg" id="penAmtDiv" style="display:none"><label>I contribute ¬£</label><input type="number" id="su_eep_amt" value="0" min="0" oninput="calcUK()"><span style="font-size:11px;margin-top:3px;display:block">per month</span></div>
          </div>
          <div style="display:flex;flex-direction:column;gap:5px;padding-top:4px">
            <label style="font-size:11px;display:flex;align-items:center;gap:6px;cursor:pointer"><input type="radio" name="pentype" value="autoenrol" onchange="calcUK()" checked style="cursor:pointer"> Auto-enrolment</label>
            <label style="font-size:11px;display:flex;align-items:center;gap:6px;cursor:pointer"><input type="radio" name="pentype" value="employer" onchange="calcUK()" style="cursor:pointer"> Employer</label>
            <label style="font-size:11px;display:flex;align-items:center;gap:6px;cursor:pointer"><input type="radio" name="pentype" value="salsac" onchange="calcUK()" style="cursor:pointer"> Salary sacrifice</label>
            <label style="font-size:11px;display:flex;align-items:center;gap:6px;cursor:pointer"><input type="radio" name="pentype" value="personal" onchange="calcUK()" style="cursor:pointer"> Personal</label>
          </div>
        </div>
        <div class="fg" style="margin-top:8px"><label>Employer Pension %</label><input type="number" id="su_emp" value="3" min="0" oninput="calcUK()"></div>
      </div>
      <div class="uk-tab-pane" id="ukt-bonus">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">Are you receiving a one-off bonus?</p>
        <div class="fg"><label>I get an annual bonus of ¬£</label><input type="number" id="su_bonus" value="0" oninput="calcUK()"></div>
        <div class="fg"><label>My normal pay period is</label>
          <select id="su_bonusperiod" onchange="calcUK()">
            <option value="monthly" selected>Monthly</option>
            <option value="weekly">Weekly</option>
            <option value="4weekly">4-Weekly</option>
          </select>
        </div>
      </div>
      <div class="uk-tab-pane" id="ukt-overtime">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">How many hours of paid overtime do you do each month?</p>
        <div class="fgrow">
          <div class="fg"><label>I do</label><input type="number" id="su_ot1h" value="0" min="0" oninput="calcUK()"></div>
          <div class="fg"><label>hours at <strong>1.5√ó</strong> normal hourly rate</label><input type="number" id="su_ot1r" value="1.5" step="0.1" style="width:70px;display:inline" oninput="calcUK()"></div>
        </div>
        <div class="fgrow">
          <div class="fg"><label>I do</label><input type="number" id="su_ot2h" value="0" min="0" oninput="calcUK()"></div>
          <div class="fg"><label>hours at <strong>2√ó</strong> normal hourly rate</label><input type="number" id="su_ot2r" value="2" step="0.1" style="width:70px;display:inline" oninput="calcUK()"></div>
        </div>
        <div class="fg"><label>Normal working week is <strong id="su_wkhrs_lbl">37.5</strong> hours</label><input type="number" id="su_wkhrs" value="37.5" step="0.5" oninput="this.previousElementSibling.querySelector('strong').textContent=this.value;calcUK()"></div>
        <div class="fg" style="margin-top:4px"><p style="font-size:11px;color:rgba(15,14,13,.55)">If it is easier, you can enter the cash value of the overtime:</p>
          <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
            <span style="font-size:12px">I receive ¬£</span>
            <input type="number" id="su_otcash" value="0" oninput="calcUK()" style="width:110px;padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:12px;background:var(--cream)">
            <span style="font-size:12px">in overtime pay every</span>
            <select id="su_otperiod" onchange="calcUK()" style="padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px">
              <option value="month">Month</option><option value="week">Week</option>
            </select>
          </div>
        </div>
      </div>
      <div class="uk-tab-pane" id="ukt-childcare">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">What value of childcare vouchers do you receive from your employer?</p>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:8px">
          <span style="font-size:12px">I receive ¬£</span>
          <input type="number" id="su_childcare" value="0" oninput="calcUK()" style="width:110px;padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:12px;background:var(--cream)">
          <span style="font-size:12px">of vouchers each month</span>
        </div>
        <label style="display:flex;align-items:center;gap:7px;font-size:12px;cursor:pointer"><input type="checkbox" id="su_childcare_pre2011" onchange="calcUK()" style="width:15px;height:15px"> I joined the scheme before 6th April 2011.</label>
      </div>
      <div class="uk-tab-pane" id="ukt-salsac">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">Do you have any salary sacrifice arrangements (excluding your pension if you entered it on the "Pension" tab)?</p>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:8px">
          <span style="font-size:12px">I sacrifice ¬£</span>
          <input type="number" id="su_sac_ni" value="0" oninput="calcUK()" style="width:100px;padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:12px;background:var(--cream)">
          <span style="font-size:12px">NI only, of my salary every</span>
          <select id="su_sac_ni_per" onchange="calcUK()" style="padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px">
            <option value="month">Month</option><option value="year">Year</option>
          </select>
        </div>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <span style="font-size:12px">I sacrifice ¬£</span>
          <input type="number" id="su_sac" value="0" oninput="calcUK()" style="width:100px;padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:12px;background:var(--cream)">
          <span style="font-size:12px">tax exempt, of my salary every</span>
          <select id="su_sac_per" onchange="calcUK()" style="padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px">
            <option value="month">Month</option><option value="year">Year</option>
          </select>
        </div>
      </div>
      <div class="uk-tab-pane" id="ukt-taxbenefits">
        <p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:8px">Do you receive any taxable benefits?</p>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:8px">
          <span style="font-size:12px">I receive ¬£</span>
          <input type="number" id="su_taxbens" value="0" oninput="calcUK()" style="width:100px;padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:12px;background:var(--cream)">
          <span style="font-size:12px">in taxable benefits every</span>
          <select id="su_taxbens_per" onchange="calcUK()" style="padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px">
            <option value="month">Month</option><option value="year">Year</option>
          </select>
        </div>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <span style="font-size:12px">I receive ¬£</span>
          <input type="number" id="su_cashalw" value="0" oninput="calcUK()" style="width:100px;padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:12px;background:var(--cream)">
          <span style="font-size:12px">in cash allowances every</span>
          <select id="su_cashalw_per" onchange="calcUK()" style="padding:6px 8px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px">
            <option value="month">Month</option><option value="year">Year</option>
          </select>
        </div>
      </div>
      <div class="uk-tab-pane" id="ukt-addopts">
        <div class="fg"><label style="display:flex;align-items:center;gap:7px;font-size:12px;cursor:pointer"><input type="checkbox" id="su_noni" onchange="calcUK()" style="width:15px;height:15px"> I do not pay National Insurance</label></div>
        <div class="fg"><label style="display:flex;align-items:center;gap:7px;font-size:12px;cursor:pointer"><input type="checkbox" id="su_blind" onchange="calcUK()" style="width:15px;height:15px"> I am eligible for the Blind Person's Allowance</label></div>
        <div class="fg"><label style="display:flex;align-items:center;gap:7px;font-size:12px;cursor:pointer"><input type="checkbox" id="su_married" onchange="calcUK()" style="width:15px;height:15px"> I am married and one of us was born before 6th April 1935</label></div>
        <div class="fg"><label style="display:flex;align-items:center;gap:7px;font-size:12px;cursor:pointer"><input type="checkbox" id="su_showni" onchange="calcUK()" style="width:15px;height:15px"> Show my Employer's NI contributions</label></div>
        <div class="fg"><label style="display:flex;align-items:center;gap:7px;font-size:12px;cursor:pointer"><input type="checkbox" id="su_adjnet" onchange="calcUK()" style="width:15px;height:15px"> Show my Adjusted Net Income</label></div>
        <div class="fgrow" style="margin-top:8px">
          <div class="fg"><label>I work</label><select id="su_daysperweek" onchange="calcUK()"><option>1</option><option>2</option><option>3</option><option>4</option><option value="5" selected>5</option><option>6</option><option>7</option></select><span style="font-size:11px">days per week</span></div>
          <div class="fg"><label>There are</label><select id="su_weeksyr" onchange="calcUK()"><option value="52" selected>52</option><option value="53">53</option></select><span style="font-size:11px">weeks in a year</span></div>
        </div>
        <div class="fg" style="margin-top:6px"><p style="font-size:11px;font-weight:600;margin-bottom:5px">Other Deductions?</p><p style="font-size:11px;color:rgba(15,14,13,.55);margin-bottom:7px">Do you have any other deductions, either before tax (Give As You Earn) or after tax (like Gift Aid)?</p>
          <div style="display:flex;gap:7px;align-items:center;flex-wrap:wrap;margin-bottom:5px">
            <span style="font-size:12px">I give ¬£</span><input type="number" id="su_gayet" value="0" oninput="calcUK()" style="width:90px;padding:5px 8px;border:1.5px solid var(--bd);border-radius:6px;font-size:12px;background:var(--cream)">
            <span style="font-size:12px">each month before tax</span>
          </div>
          <div style="display:flex;gap:7px;align-items:center;flex-wrap:wrap">
            <span style="font-size:12px">I give ¬£</span><input type="number" id="su_giftaid" value="0" oninput="calcUK()" style="width:90px;padding:5px 8px;border:1.5px solid var(--bd);border-radius:6px;font-size:12px;background:var(--cream)">
            <span style="font-size:12px">each month after tax</span>
          </div>
        </div>
        <div class="fg" style="margin-top:8px"><p style="font-size:11px;font-weight:600;margin-bottom:5px">Age:</p>
          <div style="display:flex;gap:12px;flex-wrap:wrap">
            <label style="font-size:12px;display:flex;align-items:center;gap:5px;cursor:pointer"><input type="radio" name="ukage" value="u77" checked onchange="calcUK()"> Under 77</label>
            <label style="font-size:12px;display:flex;align-items:center;gap:5px;cursor:pointer"><input type="radio" name="ukage" value="77to86" onchange="calcUK()"> 77 - 86</label>
            <label style="font-size:12px;display:flex;align-items:center;gap:5px;cursor:pointer"><input type="radio" name="ukage" value="87plus" onchange="calcUK()"> 87 plus</label>
          </div>
        </div>
      </div>

      <!-- Period checkboxes -->
      <div class="uk-periods" style="margin-top:14px">
        <label class="uk-period-lbl"><input type="checkbox" class="uk-per-chk" id="per_yearly" checked onchange="setUKPeriods()"> Yearly</label>
        <label class="uk-period-lbl"><input type="checkbox" class="uk-per-chk" id="per_monthly" checked onchange="setUKPeriods()"> Monthly</label>
        <label class="uk-period-lbl"><input type="checkbox" class="uk-per-chk" id="per_4weekly" onchange="setUKPeriods()"> 4 Weekly</label>
        <label class="uk-period-lbl"><input type="checkbox" class="uk-per-chk" id="per_2weekly" onchange="setUKPeriods()"> 2 Weekly</label>
        <label class="uk-period-lbl"><input type="checkbox" class="uk-per-chk" id="per_weekly" checked onchange="setUKPeriods()"> Weekly</label>
        <label class="uk-period-lbl"><input type="checkbox" class="uk-per-chk" id="per_daily" checked onchange="setUKPeriods()"> Daily</label>
      </div>

      <!-- Tax Year + Calculate -->
      <div style="display:flex;align-items:center;gap:10px;margin-top:12px;flex-wrap:wrap">
        <span style="font-size:13px;font-weight:700">Tax Year</span>
        <select id="su_taxyear" onchange="calcUK()" style="padding:7px 10px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px;background:var(--cream)">
          <option value="2526" selected>2025 / 26</option>
          <option value="2425">2024 / 25</option>
          <option value="2324">2023 / 24</option>
        </select>
        <button onclick="calcUK()" style="flex:1;min-width:140px;padding:10px 16px;background:#8b1a2a;color:#fff;border:none;border-radius:22px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer">Calculate!</button>
      </div>
    </div>
    <div class="sal-res">
      <h3>UK Take-Home</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('uk','annual',this)">Annual</button><button class="ptab" onclick="setPer('uk','monthly',this)">Monthly</button><button class="ptab" onclick="setPer('uk','weekly',this)">Weekly</button><button class="ptab" onclick="setPer('uk','daily',this)">Daily</button></div>
      <div class="rsec">Income</div>
      <div class="rr"><span class="rl">Base Salary</span><span class="rv hi" id="uk_base">¬£65,000</span></div>
      <div class="rr"><span class="rl">Bonus</span><span class="rv" id="uk_bonus">¬£0</span></div>
      <div class="rr"><span class="rl">RSU / Stock Awards</span><span class="rv" id="uk_stock">¬£0</span></div>
      <div class="rr"><span class="rl">Overtime</span><span class="rv" id="uk_overtime">¬£0</span></div>
      <div class="rr"><span class="rl">Taxable Benefits</span><span class="rv" id="uk_taxbens">¬£0</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="uk_gross">¬£65,000</span></div>
      <div class="rsec">Deductions</div>
      <div class="rr"><span class="rl">Income Tax</span><span class="rv dn" id="uk_tax">‚àí¬£17,432</span></div>
      <div class="rr"><span class="rl">National Insurance</span><span class="rv dn" id="uk_ni">‚àí¬£3,764</span></div>
      <div class="rr"><span class="rl">Employee Pension</span><span class="rv dn" id="uk_eep">‚àí¬£3,250</span></div>
      <div class="rr"><span class="rl">Student Loan</span><span class="rv dn" id="uk_sl">‚àí¬£0</span></div>
      <div class="rr"><span class="rl">Salary Sacrifice</span><span class="rv dn" id="uk_sac">‚àí¬£0</span></div>
      <div class="rr" id="uk_ni_emp_row" style="display:none"><span class="rl">Employer NI</span><span class="rv dn" id="uk_ni_emp">‚àí¬£0</span></div>
      <div class="rsec">Summary</div>
      <div class="rr"><span class="rl">üí∞ Take-Home Pay</span><span class="rv hi" id="uk_th">¬£40,554</span></div>
      <div class="rr"><span class="rl">+ Employer Pension</span><span class="rv up" id="uk_empp">+¬£1,950</span></div>
      <div class="rr" id="uk_adjnet_row" style="display:none"><span class="rl">Adjusted Net Income</span><span class="rv" id="uk_adjnet">¬£0</span></div>
      <div class="rr"><span class="rl">Effective Tax Rate</span><span class="rv" id="uk_eff">32%</span></div>
      <div class="rr"><span class="rl">Marginal Rate</span><span class="rv" id="uk_marg">40%</span></div>
      <div class="rsec">Tax-Free Headroom</div>
      <div class="rr"><span class="rl">ISA Remaining</span><span class="rv up" id="uk_isa_l">¬£20,000/yr</span></div>
      <div class="rr"><span class="rl">SIPP Headroom</span><span class="rv up" id="uk_sipp_l">¬£55,000/yr</span></div>
      <!-- Multi-period breakdown table -->
      <div class="rsec" id="uk_periods_sec">Period Breakdown</div>
      <div id="uk_periods_tbl" style="font-size:10px"></div>
    </div>
  </div>

  <!-- USA Salary -->
  <div class="spane" id="sal-usa">
    <div class="sal-in">
      <h3>üá∫üá∏ USA Income Details</h3>
      <div class="fg"><label>Base Salary ($)</label><input type="number" id="uu_base" value="120000" oninput="calcUSA()"></div>
      <div class="fgrow"><div class="fg"><label>Bonus ($)</label><input type="number" id="uu_bonus" value="15000" oninput="calcUSA()"></div><div class="fg"><label>RSU/Stock ($)</label><input type="number" id="uu_stock" value="20000" oninput="calcUSA()"></div></div>
      <div class="fg"><label>Filing Status</label><select id="uu_filing" onchange="calcUSA()"><option value="single" selected>Single</option><option value="mfj">Married Filing Jointly</option></select></div>
      <div class="fg"><label>State Tax Rate</label><select id="uu_state" onchange="calcUSA()"><option value="0">Texas / Florida / Washington (0%)</option><option value="4.95">Illinois (4.95%)</option><option value="5">Other states (~5%)</option><option value="6">Virginia / Georgia (~6%)</option><option value="9.3">California (up to 13.3%)</option><option value="9">New York (~10.9%)</option><option value="10.75">New Jersey (max 10.75%)</option></select></div>
      <div class="fg"><label>401(k) ($/mo)</label><input type="number" id="uu_401k" value="1500" oninput="calcUSA()"><div class="fg-hint">2025 limit $23,500/yr ‚Äî pre-tax; reduces federal AGI</div></div>
      <div class="fg"><label>HSA ($/mo, HDHP)</label><input type="number" id="uu_hsa" value="300" oninput="calcUSA()"><div class="fg-hint">$4,300/yr self ‚Äî triple tax advantage</div></div>
      <div class="fg"><label>Pre-tax Benefits ($/mo)</label><input type="number" id="uu_pre" value="200" oninput="calcUSA()"><div class="fg-hint">Medical, FSA, commuter, etc.</div></div>
    </div>
    <div class="sal-res">
      <h3>USA Take-Home</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('usa','annual',this)">Annual</button><button class="ptab" onclick="setPer('usa','monthly',this)">Monthly</button><button class="ptab" onclick="setPer('usa','biweekly',this)">Bi-weekly</button></div>
      <div class="rsec">Income</div>
      <div class="rr"><span class="rl">Base Salary</span><span class="rv hi" id="ua_base">$120,000</span></div>
      <div class="rr"><span class="rl">Annual Bonus</span><span class="rv" id="ua_bonus">$15,000</span></div>
      <div class="rr"><span class="rl">RSU / Stock</span><span class="rv" id="ua_stock">$20,000</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="ua_gross">$155,000</span></div>
      <div class="rsec">Deductions</div>
      <div class="rr"><span class="rl">Federal Income Tax</span><span class="rv dn" id="ua_fed">‚àí$30,427</span></div>
      <div class="rr"><span class="rl">Social Security (6.2%)</span><span class="rv dn" id="ua_ss">‚àí$9,114</span></div>
      <div class="rr"><span class="rl">Medicare (1.45%+)</span><span class="rv dn" id="ua_mc">‚àí$2,248</span></div>
      <div class="rr"><span class="rl">State Income Tax</span><span class="rv dn" id="ua_state">‚àí$0</span></div>
      <div class="rr"><span class="rl">401(k) Contribution</span><span class="rv dn" id="ua_401k">‚àí$18,000</span></div>
      <div class="rr"><span class="rl">HSA Contribution</span><span class="rv dn" id="ua_hsa">‚àí$3,600</span></div>
      <div class="rsec">Summary</div>
      <div class="rr"><span class="rl">üí∞ Take-Home Pay</span><span class="rv hi" id="ua_th">$91,611</span></div>
      <div class="rr"><span class="rl">Effective Tax Rate</span><span class="rv" id="ua_eff">25%</span></div>
      <div class="rr"><span class="rl">Marginal Federal Rate</span><span class="rv" id="ua_marg">24%</span></div>
      <div class="rsec">NRI-Specific</div>
      <div class="rr"><span class="rl">FBAR Required?</span><span class="rv dn" id="ua_fbar">If India accts &gt;$10K</span></div>
      <div class="rr"><span class="rl">Indian MF (PFIC)</span><span class="rv dn">Avoid ‚Äî punitive tax</span></div>
      <div class="rr"><span class="rl">401(k) Headroom</span><span class="rv up" id="ua_401l">$5,500/yr</span></div>
    </div>
  </div>

  <!-- NL Salary -->
  <div class="spane" id="sal-nl">
    <div class="sal-in">
      <h3>üá≥üá± Netherlands Income Details</h3>
      <div class="fg"><label>Base Salary (‚Ç¨)</label><input type="number" id="un_base" value="80000" oninput="calcNL()"></div>
      <div class="fgrow"><div class="fg"><label>Bonus (‚Ç¨)</label><input type="number" id="un_bonus" value="10000" oninput="calcNL()"></div><div class="fg"><label>RSU/Stock (‚Ç¨)</label><input type="number" id="un_stock" value="8000" oninput="calcNL()"></div></div>
      <div class="fg"><label>30% Ruling?</label><select id="un_30" onchange="calcNL()"><option value="no">No</option><option value="yes" selected>Yes ‚Äî valid up to 5 years</option></select><div class="fg-hint">30% of salary exempt from income tax. Apply within 4 months of starting work.</div></div>
      <div class="fg"><label>Health Insurance (‚Ç¨/mo)</label><input type="number" id="un_health" value="140" oninput="calcNL()"><div class="fg-hint">~‚Ç¨130‚Äì160/mo typical; zorgtoeslag subsidy may reduce this</div></div>
      <div class="fg"><label>Employee Pension (%)</label><input type="number" id="un_pen" value="5" min="0" max="30" oninput="calcNL()"></div>
    </div>
    <div class="sal-res">
      <h3>Netherlands Take-Home</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('nl','annual',this)">Annual</button><button class="ptab" onclick="setPer('nl','monthly',this)">Monthly</button></div>
      <div class="rsec">Income</div>
      <div class="rr"><span class="rl">Base Salary</span><span class="rv hi" id="un_base_r">‚Ç¨80,000</span></div>
      <div class="rr"><span class="rl">Bonus</span><span class="rv" id="un_bonus_r">‚Ç¨10,000</span></div>
      <div class="rr"><span class="rl">RSU / Stock</span><span class="rv" id="un_stock_r">‚Ç¨8,000</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="un_gross">‚Ç¨98,000</span></div>
      <div class="rr"><span class="rl">30% Ruling Exempt</span><span class="rv up" id="un_30r">‚Ç¨29,400</span></div>
      <div class="rr"><span class="rl">Taxable Gross (Box 1)</span><span class="rv" id="un_taxable">‚Ç¨68,600</span></div>
      <div class="rsec">Deductions</div>
      <div class="rr"><span class="rl">Box 1 Income Tax</span><span class="rv dn" id="un_tax">‚àí‚Ç¨25,030</span></div>
      <div class="rr"><span class="rl">Employee Pension</span><span class="rv dn" id="un_pen_r">‚àí‚Ç¨4,000</span></div>
      <div class="rr"><span class="rl">Health Insurance</span><span class="rv dn" id="un_health_r">‚àí‚Ç¨1,680</span></div>
      <div class="rsec">Summary</div>
      <div class="rr"><span class="rl">üí∞ Netto Take-Home</span><span class="rv hi" id="un_th">‚Ç¨67,290</span></div>
      <div class="rr"><span class="rl">Effective Tax Rate</span><span class="rv" id="un_eff">38%</span></div>
      <div class="rr"><span class="rl">Box 3 Wealth Tax Est.</span><span class="rv dn" id="un_box3">~‚Ç¨0</span></div>
      <div class="rsec">NRI-Specific</div>
      <div class="rr"><span class="rl">NL‚ÄìIndia DTAA</span><span class="rv up">Active ‚Äî claim TDS credit</span></div>
      <div class="rr"><span class="rl">NRE FD declared in</span><span class="rv dn">Box 3 (wealth tax, Jan 1)</span></div>
    </div>
  </div>

  <!-- India NRI -->
  <div class="spane" id="sal-india">
    <div class="sal-in">
      <h3>üáÆüá≥ India Income (NRI)</h3>
      <div class="fg"><label>Rental Income (‚Çπ/yr)</label><input type="number" id="si_rent" value="300000" oninput="calcIndia()"><div class="fg-hint">30% standard deduction applied automatically</div></div>
      <div class="fgrow"><div class="fg"><label>Dividends (‚Çπ/yr)</label><input type="number" id="si_div" value="50000" oninput="calcIndia()"></div><div class="fg"><label>FD Interest (‚Çπ/yr)</label><input type="number" id="si_fd" value="100000" oninput="calcIndia()"></div></div>
      <div class="fgrow"><div class="fg"><label>LTCG &gt;1yr (‚Çπ)</label><input type="number" id="si_ltcg" value="50000" oninput="calcIndia()"><div class="fg-hint">12.5% above ‚Çπ1.25L</div></div><div class="fg"><label>STCG &lt;1yr (‚Çπ)</label><input type="number" id="si_stcg" value="0" oninput="calcIndia()"><div class="fg-hint">20% flat</div></div></div>
      <div class="fg"><label>Residence Country (DTAA rate)</label><select id="si_dtaa" onchange="calcIndia()"><option value="0.15" selected>UK (~15%)</option><option value="0.15">USA (~15%)</option><option value="0.10">Netherlands (~10%)</option></select></div>
    </div>
    <div class="sal-res">
      <h3>India Tax Position (NRI)</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('india','annual',this)">Annual</button><button class="ptab" onclick="setPer('india','monthly',this)">Monthly</button></div>
      <div class="rsec">India-Sourced Income</div>
      <div class="rr"><span class="rl">Rental (after 30% deduction)</span><span class="rv hi" id="si_rent_r">‚Çπ2,10,000</span></div>
      <div class="rr"><span class="rl">Dividends</span><span class="rv" id="si_div_r">‚Çπ50,000</span></div>
      <div class="rr"><span class="rl">FD / Interest</span><span class="rv" id="si_fd_r">‚Çπ1,00,000</span></div>
      <div class="rr"><span class="rl">LTCG + STCG</span><span class="rv" id="si_cg_r">‚Çπ50,000</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="si_gross">‚Çπ4,10,000</span></div>
      <div class="rsec">Tax Deducted (TDS)</div>
      <div class="rr"><span class="rl">NRO FD TDS (30%)</span><span class="rv dn" id="si_fdtds">‚àí‚Çπ30,000</span></div>
      <div class="rr"><span class="rl">Dividend TDS (20%)</span><span class="rv dn" id="si_divtds">‚àí‚Çπ10,000</span></div>
      <div class="rr"><span class="rl">LTCG Tax (12.5% above ‚Çπ1.25L)</span><span class="rv dn" id="si_ltcgt">‚àí‚Çπ0</span></div>
      <div class="rr"><span class="rl">Total India Tax</span><span class="rv dn" id="si_totaltax">‚àí‚Çπ40,000</span></div>
      <div class="rsec">Net & DTAA Relief</div>
      <div class="rr"><span class="rl">üí∞ Net India Income</span><span class="rv hi" id="si_net">‚Çπ3,70,000</span></div>
      <div class="rr"><span class="rl">DTAA Credit (claimable)</span><span class="rv up" id="si_dtaa_r">+¬£373</span></div>
      <div class="rr"><span class="rl">Form 10F Saving (est.)</span><span class="rv up" id="si_10f">‚Çπ15,000/yr</span></div>
      <div class="rr"><span class="rl">File ITR-2?</span><span class="rv dn">Yes if income &gt;‚Çπ2.5L (Jul 31)</span></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê INSTRUMENTS ‚ïê‚ïê‚ïê -->
<div class="tpane" id="tab-instruments">
  <div class="ig">
    <div class="ipanel p-uk"><div class="ihdr">üá¨üáß UK Instruments</div>
      <div class="irow"><div><div>Stocks &amp; Shares ISA</div><div class="ilimit">¬£20K/yr ‚Äî all growth tax-free</div></div><span class="irate">7‚Äì9%</span><span class="ibadge ib-ok">‚úì OK</span></div>
      <div class="irow"><div><div>SIPP Pension</div><div class="ilimit">¬£60K/yr; 25% tax-free at 57</div></div><span class="irate">Tax relief</span><span class="ibadge ib-ok">‚úì Priority</span></div>
      <div class="irow"><div><div>Cash ISA</div><div class="ilimit">Within ¬£20K allowance</div></div><span class="irate">4.5‚Äì5%</span><span class="ibadge ib-ok">‚úì OK</span></div>
      <div class="irow"><div><div>Workplace Pension</div><div class="ilimit">Employer match 3‚Äì8%</div></div><span class="irate">Match!</span><span class="ibadge ib-ok">‚úì Max</span></div>
      <div class="irow"><div><div>Lifetime ISA (LISA)</div><div class="ilimit">25% govt bonus; ages 18‚Äì39</div></div><span class="irate">+25%</span><span class="ibadge ib-ok">‚úì OK</span></div>
      <div class="irow"><div><div>Premium Bonds</div><div class="ilimit">¬£50K max; UK residents</div></div><span class="irate">4.4%</span><span class="ibadge ib-w">‚ö† Resident</span></div>
    </div>
    <div class="ipanel p-usa"><div class="ihdr">üá∫üá∏ USA Instruments</div>
      <div class="irow"><div><div>401(k) Traditional</div><div class="ilimit">$23,500/yr 2025 ‚Äî pre-tax</div></div><span class="irate">Pre-tax</span><span class="ibadge ib-ok">‚úì Max first</span></div>
      <div class="irow"><div><div>Roth IRA</div><div class="ilimit">$7,000/yr ‚Äî tax-free growth</div></div><span class="irate">Tax-free</span><span class="ibadge ib-ok">‚úì Great</span></div>
      <div class="irow"><div><div>HSA (HDHP required)</div><div class="ilimit">$4,300 self; triple tax</div></div><span class="irate">Triple tax</span><span class="ibadge ib-ok">‚úì Max it</span></div>
      <div class="irow"><div><div>Taxable Brokerage</div><div class="ilimit">No limit; LTCG 0‚Äì20%</div></div><span class="irate">Market</span><span class="ibadge ib-ok">‚úì OK</span></div>
      <div class="irow"><div><div>Indian ETFs (INDA, SMIN)</div><div class="ilimit">US-listed; no PFIC issue</div></div><span class="irate">Market</span><span class="ibadge ib-ok">‚úì Alt. to MF</span></div>
      <div class="irow"><div><div>Indian Mutual Funds</div><div class="ilimit">PFIC rules ‚Äî punitive tax + Form 8621</div></div><span class="irate">Complex</span><span class="ibadge ib-no">‚ö† Avoid</span></div>
    </div>
  </div>
  <div class="ig">
    <div class="ipanel p-nl"><div class="ihdr">üá≥üá± Netherlands Instruments</div>
      <div class="irow"><div><div>Pensioenrekening (3rd pillar)</div><div class="ilimit">Tax-deductible; reduces Box 1</div></div><span class="irate">Pre-tax</span><span class="ibadge ib-ok">‚úì Priority</span></div>
      <div class="irow"><div><div>Beleggingsrekening (ETFs)</div><div class="ilimit">Box 3 wealth tax above ‚Ç¨57K</div></div><span class="irate">Market</span><span class="ibadge ib-w">‚ö† Box 3</span></div>
      <div class="irow"><div><div>Spaarrekening (Savings)</div><div class="ilimit">Box 3 fictitious return 1.03%</div></div><span class="irate">3‚Äì4%</span><span class="ibadge ib-w">‚ö† Box 3</span></div>
      <div class="irow"><div><div>Eigen Woning (Mortgage)</div><div class="ilimit">Interest deductible ‚Äî Box 1</div></div><span class="irate">Deductible</span><span class="ibadge ib-ok">‚úì Efficient</span></div>
      <div class="irow"><div><div>Banksparen (annuity)</div><div class="ilimit">Pre-tax; pays at retirement</div></div><span class="irate">Pre-tax</span><span class="ibadge ib-ok">‚úì OK</span></div>
      <div class="irow"><div><div>Indian MFs (via NRI)</div><div class="ilimit">Check PFIC if dual US/NL holder</div></div><span class="irate">12‚Äì15%</span><span class="ibadge ib-w">‚ö† Check</span></div>
    </div>
    <div class="ipanel p-india"><div class="ihdr">üáÆüá≥ India NRI Instruments</div>
      <div class="irow"><div><div>NRE Fixed Deposit</div><div class="ilimit">Fully repatriable; India-tax-free</div></div><span class="irate">6.5‚Äì7.5%</span><span class="ibadge ib-ok">‚úì FEMA OK</span></div>
      <div class="irow"><div><div>FCNR(B) Deposit</div><div class="ilimit">Hold in GBP/USD ‚Äî no forex risk</div></div><span class="irate">5‚Äì6%</span><span class="ibadge ib-ok">‚úì Best FX</span></div>
      <div class="irow"><div><div>NRO Fixed Deposit</div><div class="ilimit">Repatriation ‚â§$1M/yr; TDS 30%</div></div><span class="irate">6.5‚Äì7.5%</span><span class="ibadge ib-w">‚ö† TDS 30%</span></div>
      <div class="irow"><div><div>NPS Tier 1</div><div class="ilimit">NRIs eligible; PFRDA regulated</div></div><span class="irate">9‚Äì12%</span><span class="ibadge ib-ok">‚úì OK</span></div>
      <div class="irow"><div><div>Equity Mutual Funds</div><div class="ilimit">NRI KYC + FATCA; US persons ‚ö†</div></div><span class="irate">12‚Äì15%</span><span class="ibadge ib-w">‚ö† AMC check</span></div>
      <div class="irow"><div><div>PPF (existing only)</div><div class="ilimit">NRIs can't open new; 7.1% EEE</div></div><span class="irate">7.1%</span><span class="ibadge ib-w">‚ö† Existing</span></div>
    </div>
  </div>
  <div class="ibox">
    <h3>‚ö†Ô∏è Country-Specific NRI Cautions</h3>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(210px,1fr));gap:10px;font-size:11px;line-height:1.65">
      <div style="padding:10px;background:rgba(26,58,107,.05);border-radius:7px;border-left:3px solid var(--uk)"><strong>üá¨üáß UK:</strong> Declare NRE FD interest on SA106. ISA + SIPP are most efficient wrappers. Claim DTAA credit on Self-Assessment.</div>
      <div style="padding:10px;background:rgba(178,34,52,.05);border-radius:7px;border-left:3px solid var(--usa)"><strong>üá∫üá∏ USA:</strong> Indian MFs = PFIC ‚Äî avoid. File FBAR if foreign accounts &gt;$10K. Form 8938 for FATCA. Use US-listed India ETFs instead of direct MFs.</div>
      <div style="padding:10px;background:rgba(230,112,0,.05);border-radius:7px;border-left:3px solid var(--nl)"><strong>üá≥üá± Netherlands:</strong> 30% ruling reduces effective tax significantly. Declare ALL India assets in Box 3 on Jan 1. NL‚ÄìIndia DTAA is active ‚Äî attach TRC to claim credit.</div>
      <div style="padding:10px;background:rgba(224,92,42,.05);border-radius:7px;border-left:3px solid var(--india)"><strong>üáÆüá≥ India:</strong> Form 10F + TRC halves NRO TDS (30%‚Üí15%). NRE always better than NRO for foreign earnings. FCNR(B) eliminates forex risk entirely.</div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê TAX & TREATIES ‚ïê‚ïê‚ïê -->
<div class="tpane" id="tab-tax">
  <div class="banner"><strong>üåê India DTAA Network:</strong> India has active DTAAs with UK, USA and Netherlands, preventing double taxation. As an NRI, you pay residence-country tax on worldwide income but can claim credit for Indian TDS paid. NRE FD interest is tax-free in India but <strong>taxable in your residence country</strong>.</div>
  <div class="tgrid">
    <div class="tcard"><h3>üá¨üáß UK Tax</h3>
      <div class="tr2"><span>Total Gross</span><span class="tv" id="t_ukG">¬£78,000</span></div>
      <div class="tr2"><span>Income Tax</span><span class="tv r" id="t_ukT">‚àí¬£24,432</span></div>
      <div class="tr2"><span>National Insurance</span><span class="tv r" id="t_ukNI">‚àí¬£4,284</span></div>
      <div class="tr2"><span>ISA (all growth)</span><span class="tv g">¬£0 tax</span></div>
      <div class="tr2"><span>SIPP Tax Relief</span><span class="tv g" id="t_sipp">+¬£2,880/yr</span></div>
      <div class="tr2"><span>NRE FD (UK taxable)</span><span class="tv r" id="t_nreTax">‚àí¬£648</span></div>
      <div class="tr2"><span>DTAA Credit</span><span class="tv g">Claim via SA106</span></div>
    </div>
    <div class="tcard"><h3>üá∫üá∏ USA Tax</h3>
      <div class="tr2"><span>Total Gross</span><span class="tv" id="t_usaG">$155,000</span></div>
      <div class="tr2"><span>Federal Income Tax</span><span class="tv r" id="t_usaT">‚àí$30,427</span></div>
      <div class="tr2"><span>FICA (SS + Medicare)</span><span class="tv r" id="t_fica">‚àí$11,362</span></div>
      <div class="tr2"><span>401(k) Tax Saving</span><span class="tv g" id="t_401ks">Saves ~$4,320/yr</span></div>
      <div class="tr2"><span>Indian MF (PFIC)</span><span class="tv r">Punitive ‚Äî avoid</span></div>
      <div class="tr2"><span>FBAR Required?</span><span class="tv r" id="t_fbar">Check annually</span></div>
      <div class="tr2"><span>DTAA Credit (Form 1116)</span><span class="tv g">For Indian TDS paid</span></div>
    </div>
    <div class="tcard"><h3>üá≥üá± Netherlands Tax</h3>
      <div class="tr2"><span>Total Gross</span><span class="tv" id="t_nlG">‚Ç¨98,000</span></div>
      <div class="tr2"><span>30% Ruling Exempt</span><span class="tv g" id="t_nl30">‚Ç¨29,400</span></div>
      <div class="tr2"><span>Box 1 Tax</span><span class="tv r" id="t_nlT">‚àí‚Ç¨25,030</span></div>
      <div class="tr2"><span>Box 3 (wealth tax)</span><span class="tv r">~1.03% above ‚Ç¨57K</span></div>
      <div class="tr2"><span>NRE FD in NL</span><span class="tv r">Box 3 ‚Äî declare Jan 1</span></div>
      <div class="tr2"><span>NL‚ÄìIndia DTAA</span><span class="tv g">Active ‚Äî claim TDS</span></div>
    </div>
    <div class="tcard"><h3>üáÆüá≥ India Tax (NRI)</h3>
      <div class="tr2"><span>India-Sourced Income</span><span class="tv" id="t_inG">‚Çπ5,00,000</span></div>
      <div class="tr2"><span>NRE FD Interest</span><span class="tv g">Tax-free in India</span></div>
      <div class="tr2"><span>NRO TDS (30%)</span><span class="tv r" id="t_nroTDS">‚àí‚Çπ36,000/yr</span></div>
      <div class="tr2"><span>Form 10F Saving</span><span class="tv g" id="t_10f">‚Çπ18,000/yr</span></div>
      <div class="tr2"><span>LTCG Equity</span><span class="tv">12.5% above ‚Çπ1.25L</span></div>
      <div class="tr2"><span>Dividend TDS (NRI)</span><span class="tv">20%</span></div>
    </div>
  </div>
  <div class="ibox" style="margin-top:14px;overflow-x:auto">
    <h3>üìã India DTAA ‚Äî UK ¬∑ USA ¬∑ Netherlands Comparison</h3>
    <table class="treaty-tbl">
      <thead><tr><th>Item</th><th>üá¨üáß UK</th><th>üá∫üá∏ USA</th><th>üá≥üá± Netherlands</th></tr></thead>
      <tbody>
        <tr><td>India DTAA active?</td><td style="color:var(--green)">‚úì Yes</td><td style="color:var(--green)">‚úì Yes</td><td style="color:var(--green)">‚úì Yes</td></tr>
        <tr><td>NRO TDS with TRC (Form 10F)</td><td>~15%</td><td>~15%</td><td>~10%</td></tr>
        <tr><td>NRE FD taxable abroad?</td><td style="color:var(--red)">Yes ‚Äî income tax</td><td style="color:var(--red)">Yes ‚Äî federal tax</td><td style="color:var(--red)">Yes ‚Äî Box 3</td></tr>
        <tr><td>Indian Mutual Funds</td><td style="color:var(--green)">‚úì OK with NRI KYC</td><td style="color:var(--red)">‚ö† PFIC ‚Äî avoid</td><td style="color:var(--green)">‚úì OK (verify PFIC)</td></tr>
        <tr><td>Foreign account reporting</td><td>SA106 (HMRC)</td><td style="color:var(--red)">FBAR + Form 8938</td><td>Box 3 declaration</td></tr>
        <tr><td>India equity capital gains</td><td>UK CGT rules</td><td>LTCG 15‚Äì20%</td><td>Box 3 flat</td></tr>
        <tr><td>Unique expat benefit</td><td>‚Äî</td><td>Foreign Tax Credit (1116)</td><td style="color:var(--nl)">30% Ruling (Kennismigranten)</td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê COMPLIANCE ‚ïê‚ïê‚ïê -->
<div class="tpane" id="tab-compliance">
  <div class="banner"><strong>‚öñÔ∏è Multi-Country NRI Compliance:</strong> USA has the most onerous reporting obligations (FBAR + FATCA + PFIC forms). Netherlands requires Box 3 worldwide asset declaration. UK requires SA106. All require India TDS/ITR coordination via DTAA.</div>
  <div class="cgrid">
    <div class="ccard"><h3>üá¨üáß UK Obligations</h3>
      <div class="ci"><div><div style="font-weight:500">Self Assessment SA100</div><div class="ci-d">Mandatory if India income &gt;¬£1K or total gross &gt;¬£100K</div></div><span class="chip alert">Required</span></div>
      <div class="ci"><div><div style="font-weight:500">SA106 (Foreign Income)</div><div class="ci-d">India income + DTAA credit claims ‚Äî file every year</div></div><span class="chip alert">Required</span></div>
      <div class="ci"><div><div style="font-weight:500">NRE FD Interest</div><div class="ci-d">Tax-free in India but taxable in UK ‚Äî report as foreign interest</div></div><span class="chip alert">Declare</span></div>
      <div class="ci"><div><div style="font-weight:500">CGT on India Equity</div><div class="ci-d">SA108 if gains above ¬£3,000 annual exempt amount (2024‚Äì25)</div></div><span class="chip rev">If gains</span></div>
    </div>
    <div class="ccard"><h3>üá∫üá∏ USA Obligations</h3>
      <div class="ci"><div><div style="font-weight:500">FBAR (FinCEN 114)</div><div class="ci-d">If any foreign account &gt;$10K at any point. Penalty: $10K+ per violation</div></div><span class="chip alert">Critical</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 8938 (FATCA)</div><div class="ci-d">Foreign assets &gt;$50K (single) / $100K (MFJ) ‚Äî filed with Form 1040</div></div><span class="chip alert">Required</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 8621 (PFIC)</div><div class="ci-d">Required for each Indian mutual fund held ‚Äî best avoided entirely</div></div><span class="chip alert">Avoid MFs</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 1116 (Tax Credit)</div><div class="ci-d">Claim foreign tax credit for Indian TDS ‚Äî avoids double taxation</div></div><span class="chip ok">Claim it</span></div>
    </div>
    <div class="ccard"><h3>üá≥üá± Netherlands Obligations</h3>
      <div class="ci"><div><div style="font-weight:500">Aangifte inkomstenbelasting</div><div class="ci-d">Annual return ‚Äî includes Box 3 worldwide asset declaration on Jan 1</div></div><span class="chip alert">Annual</span></div>
      <div class="ci"><div><div style="font-weight:500">Box 3 Foreign Assets</div><div class="ci-d">All NRE/NRO/FD balances on Jan 1 subject to 1.03‚Äì5.53% fictitious return tax</div></div><span class="chip alert">Declare all</span></div>
      <div class="ci"><div><div style="font-weight:500">30% Ruling Application</div><div class="ci-d">Apply within 4 months of starting work; valid up to 5 years; saves ~15% effective tax</div></div><span class="chip ok">Apply early</span></div>
      <div class="ci"><div><div style="font-weight:500">NL‚ÄìIndia DTAA</div><div class="ci-d">Attach TRC from Belastingdienst to claim Indian TDS credit in Dutch return</div></div><span class="chip ok">Claim TDS</span></div>
    </div>
    <div class="ccard"><h3>üáÆüá≥ India Obligations (NRI)</h3>
      <div class="ci"><div><div style="font-weight:500">ITR-2 Filing</div><div class="ci-d">File if India income &gt;‚Çπ2.5L or to claim TDS refunds. Deadline: July 31</div></div><span class="chip rev">If applicable</span></div>
      <div class="ci"><div><div style="font-weight:500">Convert A/c to NRO</div><div class="ci-d">Within 3 months of becoming NRI ‚Äî mandatory under FEMA 1999</div></div><span class="chip alert">Mandatory</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 10F + TRC</div><div class="ci-d">Get Tax Residency Certificate from HMRC/IRS/Belastingdienst + submit Form 10F to reduce NRO TDS 30%‚Üí15%</div></div><span class="chip ok">Recommended</span></div>
      <div class="ci"><div><div style="font-weight:500">PIS for Indian Equities</div><div class="ci-d">Portfolio Investment Scheme ‚Äî mandatory for NRI trading on NSE/BSE</div></div><span class="chip rev">If investing</span></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê REMITTANCE ‚ïê‚ïê‚ïê -->
<div class="tpane" id="tab-remittance">
  <div style="font-family:'Playfair Display',serif;font-size:18px;margin-bottom:5px">üí± Multi-Currency Remittance to India</div>
  <p style="font-size:11.5px;color:rgba(15,14,13,.58);margin-bottom:13px">Sending from UK, USA or Netherlands ‚Äî compare providers and maximise ‚Çπ received.</p>
  <div style="background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;margin-bottom:13px">
    <div style="font-size:12px;font-weight:600;margin-bottom:8px">Transfer Calculator</div>
    <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
      <input type="number" id="txAmt" value="2000" style="padding:7px 10px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:13px;width:110px;outline:none" oninput="updTx()">
      <select id="txCurr" onchange="updTx()" style="padding:7px 10px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px;font-family:'DM Sans',sans-serif;outline:none"><option value="gbp">GBP (¬£)</option><option value="usd">USD ($)</option><option value="eur">EUR (‚Ç¨)</option></select>
      <span style="font-size:13px;font-weight:600">‚Üí</span>
      <span id="txResult" style="font-family:'Playfair Display',serif;font-size:20px;color:var(--india)">‚Çπ2,14,000</span>
      <span style="font-size:10px;color:rgba(15,14,13,.45)">via Wise (est.)</span>
    </div>
    <div style="font-size:9.5px;color:rgba(15,14,13,.38);margin-top:5px">*Indicative rates only. Always verify live rates before transferring.</div>
  </div>
  <div class="rgrid">
    <div class="rcard best"><div class="rp">Wise</div><div class="rrate">‚Çπ106.40/¬£</div><div class="rfee">~0.5‚Äì0.7% ¬∑ GBP/USD/EUR</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Best all-round. NRE/NRO credit. Supports all 3 currencies.</div></div>
    <div class="rcard"><div class="rp">Revolut</div><div class="rrate">‚Çπ105.80/¬£</div><div class="rfee">0.5‚Äì1% ¬∑ Weekend limits</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Good for smaller amounts. INR can be held in-app.</div></div>
    <div class="rcard"><div class="rp">ICICI Money2India</div><div class="rrate">‚Çπ105.50/¬£</div><div class="rfee">Free for ICICI NRE accounts</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Best with ICICI. Auto purpose codes. UK + US + NL.</div></div>
    <div class="rcard"><div class="rp">HDFC QuickRemit</div><div class="rrate">‚Çπ105.30/¬£</div><div class="rfee">¬£0 for NRE credit</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Best with HDFC India. Fast NRE/NRO. UK + US.</div></div>
    <div class="rcard"><div class="rp">Remitly</div><div class="rrate">‚Çπ105.90/¬£</div><div class="rfee">~1% ¬∑ Express option</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Good for USD from USA. Express next-day delivery.</div></div>
    <div class="rcard"><div class="rp">Western Union</div><div class="rrate">‚Çπ104.20/¬£</div><div class="rfee">¬£3‚Äì5 flat ¬∑ GBP/USD/EUR</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Reliable. Lower rate. Good for large one-off transfers.</div></div>
  </div>
  <div class="ibox">
    <h3>üìã Compliance Checklist by Country of Origin</h3>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;font-size:11.5px;line-height:1.65">
      <div><strong style="color:var(--uk)">üá¨üáß UK</strong><br>‚úÖ Purpose code (P1301 / P0003)<br>‚úÖ No limit for NRE from UK earnings<br>‚ö† &gt;¬£10K may trigger AML checks<br>‚úÖ Keep receipts for SA106</div>
      <div><strong style="color:var(--usa)">üá∫üá∏ USA</strong><br>‚úÖ Purpose code required<br>‚ö† FBAR if India accts &gt;$10K total<br>‚úÖ No limit for NRE from US income<br>‚ö† Report on Form 8938 if &gt;$50K</div>
      <div><strong style="color:var(--nl)">üá≥üá± Netherlands</strong><br>‚úÖ Wise / ICICI support EUR‚ÜíINR<br>‚úÖ Purpose code required<br>‚ö† Declare India assets in Box 3<br>‚úÖ NRO repatriation max $1M/yr</div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê QUESTIONNAIRE / PROFILE ‚ïê‚ïê‚ïê -->
<div class="tpane" id="tab-questionnaire">
  <div style="font-family:'Playfair Display',serif;font-size:18px;margin-bottom:4px">üìã Financial Profile Questionnaire</div>
  <p style="font-size:11.5px;color:rgba(15,14,13,.58);margin-bottom:14px">Fill in as much as you can ‚Äî even rough figures help. All data stays in your browser and is used to personalise the AI Advisor's guidance. Nothing is stored or sent anywhere.</p>

  <!-- S1: Personal -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q1')"><span>Section 1 ‚Äî Personal & Family Details</span><span class="arr o" id="qarr-q1">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q1">
      <div class="qgrid">
        <div class="fg"><label>Full Name (optional)</label><input type="text" id="q_name" placeholder="e.g. J. Smith"></div>
        <div class="fg"><label>Age</label><input type="number" id="q_age" placeholder="e.g. 35" oninput="syncAge(this.value)"></div>
      </div>
      <div class="fg"><label>Relationship Status</label>
        <select id="q_relstatus">
          <option value="">‚Äî select ‚Äî</option>
          <option>Single</option><option>Married</option><option>Cohabiting</option><option>Separated</option><option>Divorced</option><option>Widowed</option>
        </select>
      </div>
      <div class="fg"><label>Number of children / dependants and ages</label><input type="text" id="q_children" placeholder="e.g. 2 ‚Äî ages 3 and 7"></div>
      <div class="fg"><label>UK tax resident and UK-domiciled?</label>
        <select id="q_ukdom"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Unsure</option></select>
      </div>
      <div class="fg"><label>Any health issues affecting work / retirement / insurance? <span style="font-size:10px;font-style:italic;font-weight:400">(optional, brief)</span></label>
        <input type="text" id="q_health" placeholder="e.g. none / managed condition"></div>
    </div>
  </div>

  <!-- S2: Employment -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q2')"><span>Section 2 ‚Äî Employment, Income & Tax</span><span class="arr o" id="qarr-q2">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q2">
      <div class="fg"><label>Employment Status</label>
        <select id="q_empstatus"><option value="">‚Äî select ‚Äî</option><option>Employee</option><option>Limited Company Contractor</option><option>Umbrella</option><option>Self-employed</option><option>Mixed</option></select>
      </div>
      <div class="fg"><label>Job Title & Sector</label><input type="text" id="q_jobtitle" placeholder="e.g. Senior Data Engineer, financial services"></div>
      <div class="qgrid">
        <div class="fg"><label>Gross Basic Salary (¬£/yr)</label><input type="number" id="q_grosssal" placeholder="e.g. 100000" oninput="syncQSalary(this.value)"></div>
        <div class="fg"><label>Typical Bonus (¬£/yr)</label><input type="number" id="q_bonus" placeholder="e.g. 15000"></div>
      </div>
      <div class="fg"><label>RSUs / Equity (¬£/yr approx)</label><input type="number" id="q_rsu" placeholder="e.g. 20000"></div>
      <div class="fg"><label>Pay Frequency</label>
        <select id="q_payfreq"><option value="">‚Äî select ‚Äî</option><option>Monthly</option><option>Weekly</option><option>4-weekly</option><option>Other</option></select>
      </div>
      <div class="fg"><label>Do you use salary sacrifice for pension?</label>
        <select id="q_pensac"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Unsure</option></select>
      </div>
      <div class="fg" id="q_pensac_amt_row"><label>If yes ‚Äî what % or ¬£ per month?</label><input type="text" id="q_pensac_amt" placeholder="e.g. 5% or ¬£400/mo"></div>
      <div class="fg"><label>Other salary sacrifice benefits</label><input type="text" id="q_othersac" placeholder="e.g. EV scheme, cycle to work, childcare"></div>
      <div class="fg"><label>Do you complete a Self-Assessment tax return?</label>
        <select id="q_selfass"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option></select>
      </div>
      <div class="fg"><label>Other income (type and approx ¬£/yr)</label><input type="text" id="q_otherinc" placeholder="e.g. rental ¬£12,000 ¬∑ dividends ¬£5,000 ¬∑ freelance"></div>
    </div>
  </div>

  <!-- S3: Spending -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q3')"><span>Section 3 ‚Äî Spending & Cash-Flow</span><span class="arr o" id="qarr-q3">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q3">
      <div class="qgrid">
        <div class="fg"><label>Monthly take-home (approx ¬£)</label><input type="number" id="q_takehome" placeholder="e.g. 4500"></div>
        <div class="fg"><label>Monthly essential spending (¬£)</label><input type="number" id="q_essential" placeholder="e.g. 2800"></div>
      </div>
      <div class="fg"><label>Monthly discretionary spending (¬£)</label><input type="number" id="q_discretionary" placeholder="e.g. 800"></div>
      <p style="font-size:11px;font-weight:600;margin:8px 0 4px">Regular fixed commitments (amounts optional):</p>
      <div class="qgrid">
        <div class="fg"><label>Rent / Mortgage (¬£/mo)</label><input type="number" id="q_mortgage" placeholder="e.g. 1500"></div>
        <div class="fg"><label>Childcare / School fees (¬£/mo)</label><input type="number" id="q_childcarecost" placeholder="e.g. 1200"></div>
      </div>
      <div class="qgrid">
        <div class="fg"><label>Loans / HP / Finance (¬£/mo)</label><input type="number" id="q_loanpmt" placeholder="e.g. 350"></div>
        <div class="fg"><label>Subscriptions (¬£/mo)</label><input type="number" id="q_subs" placeholder="e.g. 80"></div>
      </div>
      <div class="fg"><label>Monthly savings / investments and where</label><input type="text" id="q_monthsav" placeholder="e.g. ¬£500 ISA, ¬£300 pension, ¬£200 cash"></div>
      <div class="fg"><label>Known big changes in next 1‚Äì3 years</label><input type="text" id="q_bigchanges" placeholder="e.g. house move, career break, school fees starting"></div>
    </div>
  </div>

  <!-- S4a: Cash -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q4a')"><span>Section 4a ‚Äî Assets: Cash</span><span class="arr o" id="qarr-q4a">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q4a">
      <div class="qgrid">
        <div class="fg"><label>Current account(s) ‚Äî total ¬£</label><input type="number" id="q_current" placeholder="e.g. 3000"></div>
        <div class="fg"><label>Easy-access savings ‚Äî total ¬£</label><input type="number" id="q_easyaccess" placeholder="e.g. 15000"></div>
      </div>
      <div class="qgrid">
        <div class="fg"><label>Fixed-term savings ‚Äî total ¬£</label><input type="number" id="q_fixedterm" placeholder="e.g. 10000"></div>
        <div class="fg"><label>Premium Bonds or similar ‚Äî total ¬£</label><input type="number" id="q_premiumbonds" placeholder="e.g. 5000"></div>
      </div>
      <div class="fg"><label>Emergency fund ‚Äî how many months of expenses?</label>
        <select id="q_emfund"><option value="">‚Äî select ‚Äî</option><option>Less than 1</option><option>1‚Äì2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>9</option><option>12+</option></select>
      </div>
    </div>
  </div>

  <!-- S4b: Investments -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q4b')"><span>Section 4b ‚Äî Assets: Investments (outside pensions)</span><span class="arr o" id="qarr-q4b">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q4b">
      <div class="qgrid">
        <div class="fg"><label>Stocks & Shares ISA ‚Äî current value ¬£</label><input type="number" id="q_ssisa_val" placeholder="e.g. 30000"></div>
        <div class="fg"><label>S&S ISA ‚Äî monthly contribution ¬£</label><input type="number" id="q_ssisa_mo" placeholder="e.g. 500"></div>
      </div>
      <div class="qgrid">
        <div class="fg"><label>Cash ISA ‚Äî current value ¬£</label><input type="number" id="q_cashisa_val" placeholder="e.g. 10000"></div>
        <div class="fg"><label>Cash ISA ‚Äî monthly contribution ¬£</label><input type="number" id="q_cashisa_mo" placeholder="e.g. 200"></div>
      </div>
      <div class="fg"><label>General investment / taxable brokerage ‚Äî value ¬£</label><input type="number" id="q_brokerage" placeholder="e.g. 20000"></div>
      <div class="fg"><label>Company shares / RSUs / options (type & approx value)</label><input type="text" id="q_rsu_val" placeholder="e.g. Snowflake RSUs, ~¬£15,000 unvested"></div>
      <div class="fg"><label>Crypto or other investments (type & approx value)</label><input type="text" id="q_crypto" placeholder="e.g. Bitcoin ¬£5,000"></div>
    </div>
  </div>

  <!-- S4c: Pensions -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q4c')"><span>Section 4c ‚Äî Assets: Pensions</span><span class="arr o" id="qarr-q4c">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q4c">
      <p style="font-size:11px;font-weight:600;margin-bottom:6px">Current workplace pension:</p>
      <div class="qgrid">
        <div class="fg"><label>Provider</label><input type="text" id="q_pen_provider" placeholder="e.g. Scottish Widows"></div>
        <div class="fg"><label>Approx pot value ¬£</label><input type="number" id="q_pen_val" placeholder="e.g. 50000"></div>
      </div>
      <div class="qgrid">
        <div class="fg"><label>Your contribution (% salary)</label><input type="number" id="q_pen_ee" placeholder="e.g. 5" min="0" max="100"></div>
        <div class="fg"><label>Employer contribution (% salary)</label><input type="number" id="q_pen_er" placeholder="e.g. 8" min="0" max="100"></div>
      </div>
      <div class="fg"><label>Is it salary sacrifice?</label>
        <select id="q_pen_salsac"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Unsure</option></select>
      </div>
      <div class="fg"><label>Previous workplace pensions (provider and approx value)</label><input type="text" id="q_prev_pens" placeholder="e.g. Aviva ¬£18,000 ¬∑ Nest ¬£7,000"></div>
      <div class="fg"><label>Personal pension / SIPP (provider and approx value)</label><input type="text" id="q_sipp_val" placeholder="e.g. Vanguard SIPP ¬£25,000"></div>
    </div>
  </div>

  <!-- S4d: Property -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q4d')"><span>Section 4d ‚Äî Assets: Property</span><span class="arr o" id="qarr-q4d">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q4d">
      <p style="font-size:11px;font-weight:600;margin-bottom:6px">Main residence:</p>
      <div class="qgrid">
        <div class="fg"><label>Estimated value ¬£</label><input type="number" id="q_propval" placeholder="e.g. 450000"></div>
        <div class="fg"><label>Outstanding mortgage ¬£</label><input type="number" id="q_mortgagebal" placeholder="e.g. 250000"></div>
      </div>
      <div class="fg"><label>Interest rate, type and fix end date</label><input type="text" id="q_mortgagerate" placeholder="e.g. 4.2% fixed, ends Mar 2027"></div>
      <div class="fg"><label>Years remaining on mortgage</label><input type="number" id="q_mortgageyrs" placeholder="e.g. 22"></div>
      <div class="fg"><label>Buy-to-let / other properties (value, mortgage, rent received)</label><input type="text" id="q_btl" placeholder="e.g. flat worth ¬£220,000 ¬∑ mortgage ¬£90,000 ¬∑ rent ¬£1,100/mo"></div>
    </div>
  </div>

  <!-- S4e: Other assets -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q4e')"><span>Section 4e ‚Äî Other Assets</span><span class="arr o" id="qarr-q4e">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q4e">
      <div class="fg"><label>Business interests (e.g. limited company ownership)</label><input type="text" id="q_bizint" placeholder="e.g. sole director of Ltd Co, retained profit ¬£40,000"></div>
      <div class="fg"><label>VCT / EIS investments</label><input type="text" id="q_vct" placeholder="e.g. EIS ¬£10,000 in 2024/25"></div>
      <div class="fg"><label>Any other notable assets</label><input type="text" id="q_otherassets" placeholder="e.g. inheritance expected, art, collectibles"></div>
    </div>
  </div>

  <!-- S5: Liabilities -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q5')"><span>Section 5 ‚Äî Liabilities</span><span class="arr o" id="qarr-q5">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q5">
      <div class="fg"><label>Personal loans (outstanding amount & interest rate)</label><input type="text" id="q_persloan" placeholder="e.g. ¬£5,000 at 6.9% ‚Äî car loan"></div>
      <div class="fg"><label>Car finance / HP / PCP (outstanding & monthly payment)</label><input type="text" id="q_carfin" placeholder="e.g. ¬£8,000 outstanding, ¬£280/mo"></div>
      <div class="fg"><label>Student loan (plan type & approx balance)</label><input type="text" id="q_studloan" placeholder="e.g. Plan 2 ‚Äî ~¬£28,000"></div>
      <div class="qgrid">
        <div class="fg"><label>Credit card total balance ¬£</label><input type="number" id="q_ccbal" placeholder="e.g. 2000"></div>
        <div class="fg"><label>Clear in full each month?</label>
          <select id="q_ccfull"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option></select>
        </div>
      </div>
      <div class="fg"><label>Other significant debts or obligations</label><input type="text" id="q_otherdebts" placeholder="e.g. HMRC payment plan ¬£3,000"></div>
    </div>
  </div>

  <!-- S6: Goals -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q6')"><span>Section 6 ‚Äî Goals & Time Horizons</span><span class="arr o" id="qarr-q6">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q6">
      <div class="fg"><label>Short-term goals (0‚Äì3 years)</label><input type="text" id="q_stgoals" placeholder="e.g. 6-month emergency fund, remortgage, save for wedding"></div>
      <div class="fg"><label>Medium-term goals (3‚Äì10 years)</label><input type="text" id="q_mtgoals" placeholder="e.g. upgrade house, school fees, pay off car loan"></div>
      <div class="fg"><label>Long-term goals (10+ years, incl. desired retirement age & lifestyle)</label><input type="text" id="q_ltgoals" placeholder="e.g. retire at 57, mortgage-free, travel 3mo/year"></div>
      <div class="fg"><label>Maximising monthly take-home (importance)</label>
        <select id="q_imp_takehome"><option value="">‚Äî select ‚Äî</option><option>Low</option><option>Medium</option><option>High</option></select>
      </div>
      <div class="fg"><label>Maximising long-term wealth / financial independence (importance)</label>
        <select id="q_imp_wealth"><option value="">‚Äî select ‚Äî</option><option>Low</option><option>Medium</option><option>High</option></select>
      </div>
      <div class="fg"><label>Which best describes your priority right now?</label>
        <select id="q_priority">
          <option value="">‚Äî select ‚Äî</option>
          <option value="A">A) Today's take-home matters more</option>
          <option value="B">B) Long-term wealth matters more</option>
          <option value="C">C) Balanced between A and B</option>
        </select>
      </div>
    </div>
  </div>

  <!-- S7: Risk -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q7')"><span>Section 7 ‚Äî Risk Tolerance & Investment Preferences</span><span class="arr o" id="qarr-q7">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q7">
      <div class="fg"><label>Investment risk attitude</label>
        <select id="q_risk"><option value="">‚Äî select ‚Äî</option><option>Very cautious</option><option>Cautious</option><option>Balanced</option><option>Growth-oriented</option><option>Aggressive</option></select>
      </div>
      <div class="fg"><label>How did you react during big market falls (e.g. 2020 COVID crash)?</label>
        <select id="q_mktreact"><option value="">‚Äî select ‚Äî</option><option>Sold</option><option>Held</option><option>Bought more</option><option>Not sure / wasn't invested</option></select>
      </div>
      <div class="fg"><label>Investment style preferences (select all that apply)</label>
        <div style="display:flex;flex-direction:column;gap:5px;margin-top:4px">
          <label style="font-size:12px;display:flex;align-items:center;gap:7px;cursor:pointer"><input type="checkbox" id="q_passive"> Passive index funds</label>
          <label style="font-size:12px;display:flex;align-items:center;gap:7px;cursor:pointer"><input type="checkbox" id="q_active"> Active funds</label>
          <label style="font-size:12px;display:flex;align-items:center;gap:7px;cursor:pointer"><input type="checkbox" id="q_esg"> ESG / sustainable focus</label>
        </div>
      </div>
      <div class="fg"><label>Sectors or types you want to avoid</label><input type="text" id="q_avoid" placeholder="e.g. tobacco, arms, fossil fuels"></div>
      <div class="fg"><label>Liquidity preference</label>
        <select id="q_liquidity"><option value="">‚Äî select ‚Äî</option><option>More accessible (cash/ISA)</option><option>Comfortable locking into pensions</option><option>Balanced</option></select>
      </div>
    </div>
  </div>

  <!-- S8: Protections -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q8')"><span>Section 8 ‚Äî Protections & Benefits</span><span class="arr o" id="qarr-q8">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q8">
      <p style="font-size:11px;font-weight:600;margin-bottom:6px">Employer benefits you currently have:</p>
      <div class="qgrid">
        <div class="fg"><label>Death in service (life cover)</label><input type="text" id="q_dis" placeholder="e.g. 4√ó salary"></div>
        <div class="fg"><label>Income protection</label><input type="text" id="q_ip_emp" placeholder="e.g. 75% salary to 65"></div>
      </div>
      <div class="qgrid">
        <div class="fg"><label>Critical illness cover</label><input type="text" id="q_ci_emp" placeholder="e.g. 2√ó salary"></div>
        <div class="fg"><label>Private medical insurance</label><input type="text" id="q_pmi_emp" placeholder="e.g. AXA family cover"></div>
      </div>
      <div class="fg"><label>Other employer benefits</label><input type="text" id="q_otherbens" placeholder="e.g. share schemes, discounts, EV"></div>
      <p style="font-size:11px;font-weight:600;margin:8px 0 6px">Personal policies:</p>
      <div class="qgrid">
        <div class="fg"><label>Life insurance</label><input type="text" id="q_li_pers" placeholder="e.g. level term ¬£500K to 2045"></div>
        <div class="fg"><label>Income protection</label><input type="text" id="q_ip_pers" placeholder="e.g. ¬£2,500/mo to 60"></div>
      </div>
      <div class="qgrid">
        <div class="fg"><label>Critical illness (personal)</label><input type="text" id="q_ci_pers" placeholder="e.g. ¬£150,000 lump sum"></div>
        <div class="fg"><label>Private medical (personal)</label><input type="text" id="q_pmi_pers" placeholder="e.g. Bupa self-pay"></div>
      </div>
      <p style="font-size:11px;font-weight:600;margin:8px 0 6px">Legal / estate planning:</p>
      <div class="qgrid">
        <div class="fg"><label>Do you have a will?</label><select id="q_will"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option></select></div>
        <div class="fg"><label>Lasting Power of Attorney?</label><select id="q_lpa"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option></select></div>
      </div>
      <div class="fg"><label>Pension nomination / expression of wish forms up to date?</label>
        <select id="q_nominat"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Unsure</option></select>
      </div>
    </div>
  </div>

  <!-- S9: Tax allowances -->
  <div class="qsec">
    <div class="qsec-hdr" onclick="toggleQ('q9')"><span>Section 9 ‚Äî Tax Allowances & Current Usage</span><span class="arr o" id="qarr-q9">‚ñº</span></div>
    <div class="qsec-body" id="qbody-q9">
      <div class="fg"><label>Do you usually use your full ISA allowance (¬£20,000)?</label>
        <select id="q_fullisa"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Varies</option></select>
      </div>
      <div class="fg"><label>Approx annual ISA contributions ¬£</label><input type="number" id="q_isaamt" placeholder="e.g. 12000"></div>
      <div class="fg"><label>Approx total annual pension contributions (you + employer + personal/SIPP) ¬£</label><input type="number" id="q_totalpen" placeholder="e.g. 20000"></div>
      <div class="fg"><label>Large one-off pension contributions or "carry forward" recently?</label>
        <select id="q_carryforward"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Unsure</option></select>
      </div>
      <div class="fg"><label>Affected by High Income Child Benefit Charge?</label>
        <select id="q_hicbc"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Unsure</option></select>
      </div>
      <div class="fg"><label>Affected by Tapered Annual Allowance?</label>
        <select id="q_taa"><option value="">‚Äî select ‚Äî</option><option>Yes</option><option>No</option><option>Unsure</option></select>
      </div>
      <div class="fg"><label>VCT, EIS, SEIS or other tax-advantaged investments?</label><input type="text" id="q_taxadv" placeholder="e.g. EIS ¬£5,000 in 2024/25"></div>
    </div>
  </div>

  <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
    <button onclick="sendProfileToAdvisor()" style="padding:11px 22px;background:var(--ink);color:var(--cream);border:none;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;transition:background .18s" onmouseover="this.style.background='var(--india)'" onmouseout="this.style.background='var(--ink)'">üì§ Send Profile to AI Advisor ‚Üí</button>
    <button onclick="clearProfile()" style="padding:11px 18px;background:transparent;border:1.5px solid var(--bd);border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;cursor:pointer;color:rgba(15,14,13,.55)">üóë Clear All</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê AI ADVISOR ‚ïê‚ïê‚ïê -->
<div class="tpane" id="tab-advisor">
  <div class="ai-wrap">
    <div class="ai-hdr">
      <div class="ai-av">ü§ñ</div>
      <div><h2>Global NRI Finance Advisor</h2><p>Powered by Claude ¬∑ India ¬∑ UK ¬∑ USA ¬∑ Netherlands ¬∑ FEMA ¬∑ DTAA ¬∑ Tax ¬∑ Strategy</p></div>
    </div>
    <div class="qq-wrap">
      <button class="qq" onclick="askQ('How should I prioritise ISA, 401k, NL pension and NRE FD across countries?')">Multi-country priority?</button>
      <button class="qq" onclick="askQ('What are PFIC rules for US-based NRIs holding Indian mutual funds?')">US PFIC rules?</button>
      <button class="qq" onclick="askQ('How does the 30% ruling in Netherlands affect my Indian NRE FD and investments?')">NL 30% ruling + India?</button>
      <button class="qq" onclick="askQ('What FBAR and FATCA forms do I need as a US-based NRI with Indian accounts?')">FBAR & FATCA?</button>
      <button class="qq" onclick="askQ('How do I claim DTAA credit for Indian TDS paid in UK, USA and Netherlands?')">DTAA credit all countries?</button>
      <button class="qq" onclick="askQ('What is the most tax-efficient way to invest my bonus across UK, USA and India?')">Invest bonus wisely?</button>
    </div>
    <div style="background:rgba(201,168,76,.12);border:1px solid rgba(201,168,76,.28);border-radius:7px;padding:8px 11px;margin-bottom:9px;font-size:11px;color:rgba(247,243,238,.72);line-height:1.5">
      üîí <strong style="color:rgba(247,243,238,.9)">Privacy:</strong> Approximate figures only ‚Äî no names, PAN/NI/SSN or account numbers. &nbsp;¬∑&nbsp; ‚ö†Ô∏è <strong style="color:rgba(247,243,238,.9)">Educational only</strong> ‚Äî consult a qualified CA, IFA, CPA or SEBI advisor before acting.
    </div>
    <div class="chat-win" id="chatWin">
      <div class="msg ai"><div class="mb">üëã Hello! I'm your multi-country NRI finance assistant covering <strong>India, UK, USA and Netherlands</strong>. I can help with FEMA, DTAA treaties, PFIC rules, 30% ruling, FBAR/FATCA, cross-border tax, and wealth strategy.<br><br>Your sidebar inputs inform my guidance ‚Äî try a quick question above or type anything below!</div><div class="mtime">Just now</div></div>
    </div>
    <div class="chat-row">
      <input type="text" class="chat-in" id="chatIn" placeholder="Ask about FEMA, PFIC, 30% ruling, FBAR, DTAA, strategy‚Ä¶" onkeydown="if(event.key==='Enter')sendMsg()">
      <button class="send-btn" id="sendBtn" onclick="sendMsg()">Send ‚Üí</button>
    </div>
  </div>
</div>

</div></main></div>

<div class="disclaimer">‚ö†Ô∏è <strong>Educational Tool Only.</strong> This calculator provides general financial awareness and does <strong>not</strong> constitute financial, tax or legal advice. It does not replace a qualified IFA, Chartered Accountant, CPA or SEBI-registered advisor. Tax rules and FEMA regulations change frequently ‚Äî always verify with a professional before acting. All figures are estimates.</div>

<!-- EMAIL MODAL -->
<div class="modal-bg" id="emailModal">
  <div class="modal">
    <button class="modal-x" onclick="closeMail()">‚úï</button>
    <h2>üìß Email Your Summary</h2>
    <p>Opens your email client with a pre-filled financial summary. Everything runs locally ‚Äî nothing is stored or transmitted.</p>
    <div class="modal-priv">üîí Only approximate financial figures included. No personal identification data.</div>
    <div class="fg"><label>Recipient Email</label><input type="email" id="emailTo" placeholder="yourname@email.com" style="font-family:'DM Sans',sans-serif"></div>
    <div class="fg"><label>Note (optional)</label><textarea id="emailNote" style="width:100%;padding:8px 10px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Sans',sans-serif;font-size:12px;color:var(--ink);outline:none;min-height:58px;resize:vertical"></textarea></div>
    <div class="modal-btns"><button class="btn-sec" onclick="closeMail()">Cancel</button><button class="btn-pri" onclick="doEmail()">Open Email Client ‚Üí</button></div>
  </div>
</div>
<script>
// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const on={india:true,uk:true,usa:true,nl:true};
const sOpen={india:true,uk:true,usa:true,nl:true};
const pers={uk:'annual',usa:'annual',nl:'annual',india:'annual'};
let myChart=null;

// ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const el=id=>document.getElementById(id);
const nv=id=>+(el(id)?.value||0);
const sv=id=>el(id)?.value||'';
const set=(id,v)=>{const e=el(id);if(e)e.textContent=v;};
const fmt=(n,sym,d=1)=>sym+(n/d>=1000?Math.round(n/d).toLocaleString():Math.round(n/d));
function fmtPer(n,sym,p){const d={annual:1,monthly:12,weekly:52,biweekly:26}[p]||1;return sym+Math.round(Math.abs(n)/d).toLocaleString();}

// ‚îÄ‚îÄ SIDEBAR MOBILE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleSB(){el('sb').classList.toggle('open');el('bd').classList.toggle('show');}
function closeSB(){el('sb').classList.remove('open');el('bd').classList.remove('show');}

// ‚îÄ‚îÄ COUNTRY TOGGLE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleC(c){
  on[c]=!on[c];
  const btn=el('cb-'+c);
  btn.className=on[c]?'cbtn on-'+c:'cbtn';
  el('csec-'+c).style.opacity=on[c]?'1':'0.4';
  calc();
}

// ‚îÄ‚îÄ SECTION COLLAPSE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleSec(c){
  sOpen[c]=!sOpen[c];
  el('body-'+c).classList.toggle('closed',!sOpen[c]);
  el('arr-'+c).classList.toggle('o',sOpen[c]);
}

// ‚îÄ‚îÄ TABS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function switchTab(name,e){
  document.querySelectorAll('.tbtn').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.tpane').forEach(p=>p.classList.remove('active'));
  e.classList.add('active');
  el('tab-'+name).classList.add('active');
  closeSB();
}
function switchSal(c,e){
  document.querySelectorAll('.stab').forEach(t=>t.className='stab');
  document.querySelectorAll('.spane').forEach(p=>p.classList.remove('active'));
  e.classList.add('a-'+c);
  el('sal-'+c).classList.add('active');
}
function setPer(c,p,e){
  pers[c]=p;
  e.closest('.ptabs').querySelectorAll('.ptab').forEach(b=>b.classList.remove('active'));
  e.classList.add('active');
  ({uk:calcUK,usa:calcUSA,nl:calcNL,india:calcIndia})[c]();
}

// ‚îÄ‚îÄ INCOME TOTALS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updTotals(){
  set('ukTot','¬£'+(nv('ukBase')+nv('ukBonus')+nv('ukStock')).toLocaleString());
  set('usaTot','$'+(nv('usaBase')+nv('usaBonus')+nv('usaStock')).toLocaleString());
  set('nlTot','‚Ç¨'+(nv('nlBase')+nv('nlBonus')+nv('nlStock')).toLocaleString());
  set('inTot','‚Çπ'+(nv('inRent')+nv('inDiv')+nv('inFD')+nv('inCG')).toLocaleString());
}

// ‚îÄ‚îÄ UK TAB & PERIOD HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function switchUKTab(id,btn){
  document.querySelectorAll('.uk-tab-pane').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.uk-tab').forEach(b=>b.classList.remove('active'));
  const pane=document.getElementById('ukt-'+id);
  if(pane)pane.classList.add('active');
  if(btn)btn.classList.add('active');
}
function switchPenMode(mode){
  const isPct=mode==='pct';
  el('penPctDiv').style.display=isPct?'block':'none';
  el('penAmtDiv').style.display=isPct?'none':'block';
  el('penPctBtn').classList.toggle('active',isPct);
  el('penAmtBtn').classList.toggle('active',!isPct);
  calcUK();
}
function setUKPeriods(){calcUK();}
function toggleQ(id){
  const body=el('qbody-'+id),arr=el('qarr-'+id);
  if(!body)return;
  const open=body.style.display!=='none';
  body.style.display=open?'none':'block';
  if(arr)arr.classList.toggle('o',!open);
}
function syncAge(v){const a=parseInt(v);if(!isNaN(a)){const ag=el('age');if(ag)ag.value=a;}}
function syncQSalary(v){const n=parseFloat(v);if(!isNaN(n)){const f=el('su_base');if(f)f.value=n;calcUK();}}

// ‚îÄ‚îÄ UK SALARY CALCULATOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function calcUK(){
  const base=nv('su_base');
  const bonus=nv('su_bonus');
  const su_stock=nv('su_stock')||0;
  const isPct=el('penPctDiv')&&el('penPctDiv').style.display!=='none';
  const eePct=isPct?nv('su_eep'):0;
  const eePctAmt=isPct?0:nv('su_eep_amt');
  const empPct=nv('su_emp');
  const scot=el('su_scot')&&el('su_scot').checked;
  // Salary sacrifice
  const sacTaxExempt=(nv('su_sac')*(sv('su_sac_per')==='year'?1:12));
  const sacNIOnly=(nv('su_sac_ni')*(sv('su_sac_ni_per')==='year'?1:12));
  // Bonus
  const bonusAnn=bonus;
  // Overtime
  const daysWk=parseInt(sv('su_daysperweek')||'5');
  const weeksYr=parseInt(sv('su_weeksyr')||'52');
  const wkHrs=nv('su_wkhrs')||37.5;
  const hourlyRate=wkHrs>0?base/(wkHrs*weeksYr):0;
  const ot1h=nv('su_ot1h'),ot1r=nv('su_ot1r')||1.5;
  const ot2h=nv('su_ot2h'),ot2r=nv('su_ot2r')||2;
  const otCash=nv('su_otcash')*(sv('su_otperiod')==='week'?weeksYr:12);
  const overtimeAnn=otCash>0?otCash:(ot1h*ot1r*hourlyRate+ot2h*ot2r*hourlyRate)*12;
  // Taxable benefits
  const taxBensAnn=nv('su_taxbens')*(sv('su_taxbens_per')==='year'?1:12);
  const cashAlwAnn=nv('su_cashalw')*(sv('su_cashalw_per')==='year'?1:12);
  const gayeAnn=nv('su_gayet')*12;
  // Childcare vouchers (up to ¬£243/mo basic rate, ¬£124/mo higher rate)
  const childcareAnn=nv('su_childcare')*12;
  // Student loan
  const sl1=el('su_sl1')&&el('su_sl1').checked;
  const sl2=el('su_sl2')&&el('su_sl2').checked;
  const sl4=el('su_sl4')&&el('su_sl4').checked;
  const sl5=el('su_sl5')&&el('su_sl5').checked;
  const slpg=el('su_slpg')&&el('su_slpg').checked;
  // Tax code personal allowance override
  const taxCodeRaw=(el('su_taxcode')?.value||'').toUpperCase().trim();
  let taxCodePA=12570;
  const tcMatch=taxCodeRaw.match(/^(\d+)[LMNTWY]?$/);
  if(tcMatch)taxCodePA=parseInt(tcMatch[1])*10;
  else if(taxCodeRaw==='NT')taxCodePA=99999;
  else if(taxCodeRaw==='0T')taxCodePA=0;
  // Blind persons
  const blind=el('su_blind')&&el('su_blind').checked;
  if(blind)taxCodePA+=2870;
  // Married allowance (1935 born)
  const married=el('su_married')&&el('su_married').checked;
  if(married)taxCodePA+=4010;
  // Gross income
  const gross=base+bonusAnn+su_stock+overtimeAnn+taxBensAnn+cashAlwAnn;
  // Pension
  let eePenAnn=isPct?base*eePct/100:eePctAmt*12;
  const penType=document.querySelector('input[name="pentype"]:checked')?.value||'autoenrol';
  const isSalSac=penType==='salsac';
  const empPenAnn=base*empPct/100;
  // Net of sacrifice for tax purposes
  const totalSac=sacTaxExempt+(isSalSac?eePenAnn:0);
  const totalSacNIOnly=sacNIOnly;
  const netForTax=Math.max(0,gross-totalSac-gayeAnn);
  // Personal allowance (taper above 100K)
  let pa=taxCodePA;
  if(netForTax>100000)pa=Math.max(0,taxCodePA-Math.floor((netForTax-100000)/2));
  const taxable=Math.max(0,netForTax-pa);
  // Income tax
  let tax=0;
  if(scot){
    const bands=[[2306,.19],[13991,.20],[31092,.21],[62430,.42],[1e9,.48]];
    let r=taxable;for(const[w,rt]of bands){const a=Math.min(r,w);tax+=a*rt;r-=a;if(r<=0)break;}
  } else {
    tax=Math.min(taxable,37700)*.20+Math.min(Math.max(0,taxable-37700),125140-37700)*.40+Math.max(0,taxable-125140)*.45;
  }
  // NI
  const noNI=el('su_noni')&&el('su_noni').checked;
  const niBase=Math.max(0,gross-totalSac-totalSacNIOnly);
  let ni=0;
  if(!noNI&&niBase>12570){ni=Math.min(niBase-12570,50270-12570)*.08+Math.max(0,niBase-50270)*.02;}
  // Employer NI
  let empNI=0;
  if(niBase>9100){empNI=Math.min(niBase-9100,50270-9100)*.138+Math.max(0,niBase-50270)*.138;}
  // Student loan
  const slT={sl1:24990,sl2:27295,sl4:27660,sl5:25000};
  let slAmt=0;
  if(sl1&&netForTax>slT.sl1)slAmt+=Math.max(0,netForTax-slT.sl1)*.09;
  if(sl2&&netForTax>slT.sl2)slAmt+=Math.max(0,netForTax-slT.sl2)*.09;
  if(sl4&&netForTax>slT.sl4)slAmt+=Math.max(0,netForTax-slT.sl4)*.09;
  if(sl5&&netForTax>slT.sl5)slAmt+=Math.max(0,netForTax-slT.sl5)*.09;
  if(slpg&&netForTax>21000)slAmt+=Math.max(0,netForTax-21000)*.06;
  // Pension (non salsac) from take-home
  const eePenPost=isSalSac?0:eePenAnn;
  const th=gross-tax-ni-eePenPost-slAmt-totalSac;
  // Adjusted net income
  const adjNetInc=netForTax-eePenAnn;

  // Period divisors
  const getPer=()=>pers.uk;
  const divs={annual:1,monthly:12,weekly:52,daily:daysWk*weeksYr,'4weekly':13,'2weekly':26};
  const d=divs[getPer()]||1;
  const f=(x)=>'¬£'+Math.round(Math.abs(x)/d).toLocaleString();

  set('uk_base',f(base));set('uk_bonus',f(bonusAnn));set('uk_stock',f(su_stock));
  set('uk_overtime',f(overtimeAnn));set('uk_taxbens',f(taxBensAnn+cashAlwAnn));
  set('uk_gross',f(gross));
  set('uk_tax','‚àí'+f(tax));set('uk_ni','‚àí'+f(ni));
  set('uk_eep','‚àí'+f(eePenPost||eePenAnn));
  set('uk_sl',slAmt>0?'‚àí'+f(slAmt):'‚àí¬£0');
  set('uk_sac',totalSac>0?'‚àí'+f(totalSac):'‚àí¬£0');
  set('uk_th',f(th));set('uk_empp','+'+f(empPenAnn));
  set('uk_eff',gross>0?Math.round((tax+ni)/gross*100)+'%':'0%');
  set('uk_marg',taxable>125140?'45%':taxable>37700?'40%':taxable>0?'20%':'0%');
  // Employer NI row
  const showNI=el('su_showni')&&el('su_showni').checked;
  if(el('uk_ni_emp_row'))el('uk_ni_emp_row').style.display=showNI?'flex':'none';
  set('uk_ni_emp','‚àí'+f(empNI));
  // Adjusted net income row
  const showAdj=el('su_adjnet')&&el('su_adjnet').checked;
  if(el('uk_adjnet_row'))el('uk_adjnet_row').style.display=showAdj?'flex':'none';
  set('uk_adjnet',f(adjNetInc));
  const isaUsed=Math.min(20000,nv('isa')*12);
  set('uk_isa_l','¬£'+(20000-isaUsed).toLocaleString()+'/yr');
  set('uk_sipp_l','¬£'+Math.min(60000,Math.max(0,gross-nv('sipp')*12)).toLocaleString()+'/yr');

  // Multi-period breakdown
  const periods=[
    {label:'Yearly',key:'annual',id:'per_yearly',div:1},
    {label:'Monthly',key:'monthly',id:'per_monthly',div:12},
    {label:'4-Weekly',key:'4weekly',id:'per_4weekly',div:13},
    {label:'2-Weekly',key:'2weekly',id:'per_2weekly',div:26},
    {label:'Weekly',key:'weekly',id:'per_weekly',div:52},
    {label:'Daily',key:'daily',id:'per_daily',div:daysWk*weeksYr},
  ].filter(p=>el(p.id)&&el(p.id).checked);
  const fP=(x,dv)=>'¬£'+Math.round(Math.abs(x)/dv).toLocaleString();
  let ptbl='<table style="width:100%;border-collapse:collapse;font-size:10px"><thead><tr style="background:rgba(15,14,13,.06)">';
  ptbl+='<th style="padding:4px 6px;text-align:left;border-bottom:1px solid var(--bd)">Period</th>';
  ptbl+='<th style="padding:4px 6px;text-align:right;border-bottom:1px solid var(--bd)">Gross</th>';
  ptbl+='<th style="padding:4px 6px;text-align:right;border-bottom:1px solid var(--bd)">Tax</th>';
  ptbl+='<th style="padding:4px 6px;text-align:right;border-bottom:1px solid var(--bd)">NI</th>';
  ptbl+='<th style="padding:4px 6px;text-align:right;border-bottom:1px solid var(--bd);color:#7fd4a8">Take-Home</th>';
  ptbl+='</tr></thead><tbody>';
  periods.forEach(p=>{
    ptbl+=`<tr style="border-bottom:1px solid var(--bd)">
      <td style="padding:4px 6px">${p.label}</td>
      <td style="padding:4px 6px;text-align:right;font-family:'DM Mono',monospace">${fP(gross,p.div)}</td>
      <td style="padding:4px 6px;text-align:right;font-family:'DM Mono',monospace;color:#f4a07a">${fP(tax,p.div)}</td>
      <td style="padding:4px 6px;text-align:right;font-family:'DM Mono',monospace;color:#f4a07a">${fP(ni,p.div)}</td>
      <td style="padding:4px 6px;text-align:right;font-family:'DM Mono',monospace;color:#7fd4a8;font-weight:700">${fP(th,p.div)}</td>
    </tr>`;
  });
  ptbl+='</tbody></table>';
  if(el('uk_periods_tbl'))el('uk_periods_tbl').innerHTML=ptbl;

  return{gross,th,tax,ni,eePenAnn,empPenAnn};
}

// ‚îÄ‚îÄ QUESTIONNAIRE HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function sendProfileToAdvisor(){
  const g=id=>el(id)?.value||'';
  const lines=[];
  const add=(label,val)=>{if(val&&val.trim()&&val!=='‚Äî select ‚Äî')lines.push(`${label}: ${val}`);};
  add('Name',g('q_name'));add('Age',g('q_age'));add('Relationship',g('q_relstatus'));
  add('Dependants',g('q_children'));add('UK resident/domiciled',g('q_ukdom'));
  add('Health notes',g('q_health'));add('Employment',g('q_empstatus'));
  add('Job title',g('q_jobtitle'));add('Gross salary',g('q_grosssal')?' ¬£'+parseInt(g('q_grosssal')).toLocaleString():'');
  add('Bonus',g('q_bonus')?'¬£'+parseInt(g('q_bonus')).toLocaleString():'');
  add('RSU/Equity',g('q_rsu')?'¬£'+parseInt(g('q_rsu')).toLocaleString():'');
  add('Pay frequency',g('q_payfreq'));add('Pension salary sacrifice',g('q_pensac'));
  add('Pension sac amount',g('q_pensac_amt'));add('Other sacrifice',g('q_othersac'));
  add('Self-assessment',g('q_selfass'));add('Other income',g('q_otherinc'));
  add('Take-home',g('q_takehome')?'~¬£'+parseInt(g('q_takehome')).toLocaleString()+'/mo':'');
  add('Essential spend',g('q_essential')?'¬£'+parseInt(g('q_essential')).toLocaleString()+'/mo':'');
  add('Discretionary spend',g('q_discretionary')?'¬£'+parseInt(g('q_discretionary')).toLocaleString()+'/mo':'');
  add('Mortgage/rent',g('q_mortgage')?'¬£'+g('q_mortgage')+'/mo':'');
  add('Childcare cost',g('q_childcarecost')?'¬£'+g('q_childcarecost')+'/mo':'');
  add('Monthly savings',g('q_monthsav'));add('Big changes expected',g('q_bigchanges'));
  add('Cash savings',g('q_easyaccess')?'¬£'+parseInt(g('q_easyaccess')).toLocaleString():'');
  add('Emergency fund',g('q_emfund')+' months');
  add('S&S ISA value',g('q_ssisa_val')?'¬£'+parseInt(g('q_ssisa_val')).toLocaleString():'');
  add('Cash ISA value',g('q_cashisa_val')?'¬£'+parseInt(g('q_cashisa_val')).toLocaleString():'');
  add('Brokerage',g('q_brokerage')?'¬£'+parseInt(g('q_brokerage')).toLocaleString():'');
  add('RSU unvested',g('q_rsu_val'));
  add('Pension provider',g('q_pen_provider'));add('Pension value',g('q_pen_val')?'¬£'+parseInt(g('q_pen_val')).toLocaleString():'');
  add('Pension contribution',g('q_pen_ee')?g('q_pen_ee')+'% employee, '+g('q_pen_er')+'% employer':'');
  add('Prev. pensions',g('q_prev_pens'));add('SIPP',g('q_sipp_val'));
  add('Property value',g('q_propval')?'¬£'+parseInt(g('q_propval')).toLocaleString():'');
  add('Mortgage balance',g('q_mortgagebal')?'¬£'+parseInt(g('q_mortgagebal')).toLocaleString():'');
  add('Mortgage rate/type',g('q_mortgagerate'));
  add('Student loan',g('q_studloan'));add('Credit card balance',g('q_ccbal')?'¬£'+g('q_ccbal'):'');
  add('CC cleared monthly',g('q_ccfull'));
  add('Short-term goals',g('q_stgoals'));add('Medium-term goals',g('q_mtgoals'));
  add('Long-term goals',g('q_ltgoals'));
  add('Priority',g('q_priority'));add('Risk attitude',g('q_risk'));
  add('Market reaction',g('q_mktreact'));add('Liquidity preference',g('q_liquidity'));
  const prefs=[];
  if(el('q_passive')?.checked)prefs.push('passive index');
  if(el('q_active')?.checked)prefs.push('active funds');
  if(el('q_esg')?.checked)prefs.push('ESG');
  if(prefs.length)lines.push('Investment style: '+prefs.join(', '));
  add('Sectors to avoid',g('q_avoid'));
  add('Death in service',g('q_dis'));add('Income protection',g('q_ip_emp'));
  add('Will',g('q_will'));add('LPA',g('q_lpa'));add('Pension nominations',g('q_nominat'));
  add('Full ISA used',g('q_fullisa'));add('ISA contributions',g('q_isaamt')?'¬£'+parseInt(g('q_isaamt')).toLocaleString():'');
  add('Total pension contributions',g('q_totalpen')?'¬£'+parseInt(g('q_totalpen')).toLocaleString():'');
  add('HICBC',g('q_hicbc'));add('Tapered allowance',g('q_taa'));
  add('VCT/EIS',g('q_taxadv'));

  if(lines.length===0){alert('Please fill in some profile details first.');return;}

  const msg='Here is my full financial profile. Based on this, please provide a personalised plan to maximise my take-home pay and build long-term wealth through pensions, ISAs and other suitable instruments under current UK rules.\n\n--- PROFILE ---\n'+lines.join('\n');
  if(el('chatIn'))el('chatIn').value=msg;
  switchTab('advisor',document.querySelector('.tbtn[onclick*="advisor"]'));
  setTimeout(()=>{sendMsg();},100);
}
function clearProfile(){
  document.querySelectorAll('#tab-questionnaire input, #tab-questionnaire select, #tab-questionnaire textarea').forEach(f=>{
    if(f.type==='checkbox'||f.type==='radio')f.checked=false;
    else f.value='';
  });
}


// ‚îÄ‚îÄ USA SALARY CALCULATOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function calcUSA(){
  const base=nv('uu_base'),bonus=nv('uu_bonus'),stock=nv('uu_stock');
  const filing=sv('uu_filing'),stRate=nv('uu_state')/100;
  const k401=Math.min(nv('uu_401k')*12,23500),hsaA=Math.min(nv('uu_hsa')*12,4300),pre=nv('uu_pre')*12;
  const gross=base+bonus+stock;
  const preTax=k401+hsaA+pre;
  const agi=Math.max(0,gross-preTax);
  const stdDed=filing==='mfj'?30000:15000;
  const taxInc=Math.max(0,agi-stdDed);
  const fedB=filing==='mfj'?[[23850,.10],[73100,.12],[109750,.22],[206700,.24],[194100,.32],[62900,.35],[1e9,.37]]:[[11925,.10],[36550,.12],[54875,.22],[103350,.24],[97050,.32],[31450,.35],[1e9,.37]];
  let fedTax=0,r=taxInc;for(const[w,rt]of fedB){const a=Math.min(r,w);fedTax+=a*rt;r-=a;if(r<=0)break;}
  const ss=Math.min(gross,176100)*.062;
  const mc=gross*.0145+(gross>200000?(gross-200000)*.009:0);
  const stateTax=agi*stRate;
  const th=gross-fedTax-ss-mc-stateTax-preTax;
  const p=pers.usa;
  const f=(x,sym='$')=>sym+Math.round(Math.abs(x)/({annual:1,monthly:12,biweekly:26}[p]||1)).toLocaleString();
  const fedMarg=taxInc>523601?37:taxInc>209426?35:taxInc>164926?32:taxInc>86376?24:taxInc>40526?22:taxInc>9951?12:10;
  set('ua_base',f(base));set('ua_bonus',f(bonus));set('ua_stock',f(stock));set('ua_gross',f(gross));
  set('ua_fed','‚àí'+f(fedTax));set('ua_ss','‚àí'+f(ss));set('ua_mc','‚àí'+f(mc));
  set('ua_state',stateTax>0?'‚àí'+f(stateTax):'‚àí$0');
  set('ua_401k','‚àí'+f(k401));set('ua_hsa','‚àí'+f(hsaA));
  set('ua_th',f(th));
  set('ua_eff',gross>0?Math.round((fedTax+ss+mc+stateTax)/gross*100)+'%':'0%');
  set('ua_marg',fedMarg+'%');
  set('ua_fbar','If India accounts >$10K at any point');
  set('ua_401l','$'+Math.max(0,23500-k401).toLocaleString()+'/yr');
  return{gross,th,fedTax,ss,mc,stateTax};
}

// ‚îÄ‚îÄ NL SALARY CALCULATOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function calcNL(){
  const base=nv('un_base'),bonus=nv('un_bonus'),stock=nv('un_stock');
  const rule30=sv('un_30')==='yes',healthMo=nv('un_health'),penPct=nv('un_pen');
  const gross=base+bonus+stock;
  const health=healthMo*12,pension=base*penPct/100;
  const exempt30=rule30?gross*.30:0;
  const taxable=Math.max(0,gross-exempt30-pension);
  let tax=taxable<=38441?taxable*.3697:38441*.3697+(taxable-38441)*.495;
  // Arbeidskorting approximation + Algemene heffingskorting
  const ahk=Math.max(0,3362-(Math.max(0,taxable-22660)*.06095));
  const ak=taxable<=11491?taxable*.08231:taxable<=24820?945+(taxable-11491)*.02913:taxable<=39957?1334:Math.max(0,1334-(taxable-39957)*.006);
  tax=Math.max(0,tax-ahk-ak);
  const th=gross-tax-pension-health;
  const p=pers.nl;
  const f=(x,sym='‚Ç¨')=>sym+Math.round(Math.abs(x)/({annual:1,monthly:12}[p]||1)).toLocaleString();
  set('un_base_r',f(base));set('un_bonus_r',f(bonus));set('un_stock_r',f(stock));set('un_gross',f(gross));
  set('un_30r',rule30?f(exempt30):'‚Ç¨0');set('un_taxable',f(taxable));
  set('un_tax','‚àí'+f(tax));set('un_pen_r','‚àí'+f(pension));set('un_health_r','‚àí'+f(health));
  set('un_th',f(th));
  set('un_eff',gross>0?Math.round(tax/gross*100)+'%':'0%');
  const nlSavingsAnn=(nv('nlBrok')+nv('nlCash'))*12;
  set('un_box3',nlSavingsAnn>57000?'~‚Ç¨'+Math.round((nlSavingsAnn-57000)*.0103).toLocaleString()+'/yr':'‚Ç¨0 (below threshold)');
  return{gross,th,tax};
}

// ‚îÄ‚îÄ INDIA NRI TAX ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function calcIndia(){
  const rent=nv('si_rent'),div=nv('si_div'),fd=nv('si_fd'),ltcg=nv('si_ltcg'),stcg=nv('si_stcg');
  const dtaaRate=+(sv('si_dtaa')||0.15);
  const fxI=nv('fxI')||107;
  const rentNet=rent*.70,totalGross=rentNet+div+fd+ltcg+stcg;
  const fdTds=fd*.30,divTds=div*.20,ltcgTax=Math.max(0,ltcg-125000)*.125,stcgTax=stcg*.20;
  const totalTax=fdTds+divTds+ltcgTax+stcgTax;
  const net=totalGross-totalTax;
  const form10FSave=fd*(0.30-dtaaRate);
  const dtaaCredit=totalTax/fxI;
  const p=pers.india;
  const fi=(x)=>'‚Çπ'+Math.round(Math.abs(x)/({annual:1,monthly:12}[p]||1)).toLocaleString();
  const fg=(x)=>'¬£'+Math.round(Math.abs(x)/({annual:1,monthly:12}[p]||1)).toLocaleString();
  set('si_rent_r',fi(rentNet));set('si_div_r',fi(div));set('si_fd_r',fi(fd));
  set('si_cg_r',fi(ltcg+stcg));set('si_gross',fi(totalGross));
  set('si_fdtds','‚àí'+fi(fdTds));set('si_divtds','‚àí'+fi(divTds));
  set('si_ltcgt','‚àí'+fi(ltcgTax));set('si_totaltax','‚àí'+fi(totalTax));
  set('si_net',fi(net));set('si_dtaa_r','+'+fg(dtaaCredit));
  set('si_10f','‚Çπ'+Math.round(form10FSave).toLocaleString()+'/yr');
  return{totalGross,totalTax,net,form10FSave,dtaaCredit};
}

// ‚îÄ‚îÄ MAIN CALCULATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function calc(){
  const age=nv('age'),goalAmt=nv('goalAmt'),goalAge=nv('goalAge');
  const risk=sv('risk'),horizon=Math.max(1,goalAge-age);
  const fxI=nv('fxI')||107,fxU=nv('fxU')||0.79,fxE=nv('fxE')||0.85;

  // UK savings in ¬£
  const isaA=nv('isa'),sippA=nv('sipp'),ukCashA=nv('ukCash');
  const ukSav=on.uk?(isaA+sippA+ukCashA)*12:0;

  // UK take-home approx
  const ukGross=nv('ukBase')+nv('ukBonus')+nv('ukStock');
  let ukTH=0;
  if(on.uk){
    const pa=ukGross>100000?Math.max(0,12570-Math.floor((ukGross-100000)/2)):12570;
    const t=Math.max(0,ukGross-nv('ukBase')*(nv('ukPen')/100)-pa);
    const tax=Math.min(t,37700)*.20+Math.max(0,t-37700)*.40;
    const ni=ukGross>12570?Math.min(ukGross-12570,50270-12570)*.08+Math.max(0,ukGross-50270)*.02:0;
    ukTH=ukGross-tax-ni-nv('ukBase')*(nv('ukPen')/100);
  }

  // USA savings in ¬£
  const k401A=nv('k401'),rothA=nv('roth'),hsaA=nv('hsa'),usaBrokA=nv('usaBrok');
  const usaSav=on.usa?(k401A+rothA+hsaA+usaBrokA)*12*fxU:0;
  const usaGross=nv('usaBase')+nv('usaBonus')+nv('usaStock');
  let usaTH=0;
  if(on.usa){
    const k=Math.min(k401A*12,23500),h=Math.min(hsaA*12,4300);
    const agi=Math.max(0,usaGross-k-h);
    const tI=Math.max(0,agi-15000);
    const fb=[[11925,.10],[36550,.12],[54875,.22],[103350,.24],[97050,.32],[31450,.35],[1e9,.37]];
    let fedT=0,r=tI;for(const[w,rt]of fb){const a=Math.min(r,w);fedT+=a*rt;r-=a;if(r<=0)break;}
    const ss=Math.min(usaGross,176100)*.062,mc=usaGross*.0145;
    usaTH=usaGross-fedT-ss-mc-k-h;
  }

  // NL savings in ¬£
  const nlPenA=nv('nlPen'),nlBrokA=nv('nlBrok'),nlCashA=nv('nlCash');
  const nlSav=on.nl?(nlPenA+nlBrokA+nlCashA)*12*fxE:0;
  const nlGross=nv('nlBase')+nv('nlBonus')+nv('nlStock');
  let nlTH=0;
  if(on.nl){
    const r30=sv('nl30')==='yes',tG=Math.max(0,nlGross*(r30?.70:1));
    const tax=tG<=38441?tG*.3697:38441*.3697+(tG-38441)*.495;
    nlTH=nlGross-Math.max(0,tax-3362)-(nv('nlBase')*(nv('nlPen')/100||5/100))-140*12;
  }

  // India savings in ¬£
  const nreFDA=nv('nreFD'),nroFDA=nv('nroFD'),mfA=nv('mf');
  const indiaSav=on.india?(nreFDA+nroFDA+mfA)*12/fxI:0;

  const totalSav=ukSav+usaSav+nlSav+indiaSav;
  const pct=goalAmt>0?Math.min(99,Math.round(totalSav/goalAmt*100)):0;

  // Update summary cards visibility
  ['uk','usa','nl','india'].forEach(c=>el('sc-'+c)?.style.setProperty('display',on[c]?'':'none'));

  set('cv-uk','¬£'+Math.round(ukTH/1000)+'K');
  set('cs-uk','Base ¬£'+Math.round(nv('ukBase')/1000)+'K + Bonus ¬£'+Math.round(nv('ukBonus')/1000)+'K + Stock ¬£'+Math.round(nv('ukStock')/1000)+'K');
  set('cv-usa','$'+Math.round(usaTH/1000)+'K');
  set('cs-usa','Federal + FICA + state deducted');
  set('cv-nl','‚Ç¨'+Math.round(nlTH/1000)+'K');
  set('cs-nl',sv('nl30')==='yes'?'Incl. 30% ruling benefit':'Box 1 tax applied');
  set('cv-india','‚Çπ'+((nreFDA+nroFDA+mfA)*12/100000).toFixed(1)+'L');
  set('cv-total','¬£'+Math.round(totalSav/1000)+'K');
  set('cs-total','Combined all active countries annually');
  set('cv-goal',pct+'%');
  set('cs-goal','Saving ¬£'+Math.round(totalSav/1000)+'K/yr toward ¬£'+Math.round(goalAmt/1000)+'K');
  set('cv-yrs',horizon+'');
  set('cs-yrs','Age '+age+' ‚Üí '+goalAge);
  el('gbarFill').style.width=pct+'%';
  set('gmetaL','¬£'+Math.round(totalSav/1000)+'K/yr saving toward ¬£'+Math.round(goalAmt/1000)+'K target');
  set('gmetaR',horizon+' years to goal age '+goalAge);

  // Tax tab
  set('t_ukG','¬£'+ukGross.toLocaleString());
  const ukTaxEst=Math.min(Math.max(0,ukGross-12570),37700)*.20+Math.max(0,Math.max(0,ukGross-12570)-37700)*.40;
  const ukNIEst=ukGross>12570?Math.min(ukGross-12570,50270-12570)*.08+Math.max(0,ukGross-50270)*.02:0;
  set('t_ukT','‚àí¬£'+Math.round(ukTaxEst).toLocaleString());
  set('t_ukNI','‚àí¬£'+Math.round(ukNIEst).toLocaleString());
  set('t_sipp','+¬£'+Math.round(sippA*12*0.40).toLocaleString()+'/yr');
  set('t_nreTax','‚àí¬£'+Math.round(nreFDA*12*.075/fxI*.40).toLocaleString());
  set('t_usaG','$'+usaGross.toLocaleString());
  const usaFedEst=Math.min(Math.max(0,usaGross-15000),36550)*.12+Math.min(Math.max(0,usaGross-48475),54875)*.22+Math.max(0,Math.min(usaGross-103350,0))*.24;
  set('t_usaT','‚àí$'+Math.round(usaFedEst).toLocaleString());
  set('t_fica','‚àí$'+Math.round(Math.min(usaGross,176100)*.062+usaGross*.0145).toLocaleString());
  set('t_401ks','Saves ~$'+Math.round(Math.min(k401A*12,23500)*.22).toLocaleString()+'/yr');
  const fbarCheck=(nreFDA+nroFDA)*12/fxI*fxU;
  set('t_fbar',fbarCheck>10000?'‚ö† Required ‚Äî file by Apr 15':'Not required (check annually)');
  set('t_nlG','‚Ç¨'+nlGross.toLocaleString());
  set('t_nl30',sv('nl30')==='yes'?'‚Ç¨'+Math.round(nlGross*.30).toLocaleString():'N/A');
  const nlTaxEst=nlGross*.70<=38441?nlGross*.70*.3697:38441*.3697+(nlGross*.70-38441)*.495;
  set('t_nlT','‚àí‚Ç¨'+Math.round(Math.max(0,nlTaxEst-3362)).toLocaleString());
  const inT=nv('inRent')*.70+nv('inDiv')+nv('inFD')+nv('inCG');
  set('t_inG','‚Çπ'+Math.round(inT).toLocaleString());
  set('t_nroTDS','‚àí‚Çπ'+Math.round(nroFDA*12*.30).toLocaleString()+'/yr');
  set('t_10f','‚Çπ'+Math.round(nroFDA*12*.15).toLocaleString()+'/yr');

  buildStrategy({ukSav,usaSav,nlSav,indiaSav,totalSav,ukGross,usaGross,nlGross,horizon,goalAmt,risk,isaA,sippA,k401A,nreFDA,nroFDA,fxI,fxU,fxE});
  updateChart({isaA,sippA,ukCashA,nreFDA,nroFDA,mfA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nlCashA,fxI,fxU,fxE,horizon,goalAmt,risk});
  updateAlloc({ukSav,usaSav,nlSav,indiaSav,isaA,sippA,ukCashA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nreFDA,nroFDA,mfA,fxU,fxE,fxI});
  calcUK();calcUSA();calcNL();calcIndia();
  updTx();
}

// ‚îÄ‚îÄ STRATEGY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function buildStrategy({ukSav,usaSav,nlSav,indiaSav,totalSav,ukGross,usaGross,nlGross,horizon,goalAmt,risk,isaA,sippA,k401A,nreFDA,nroFDA,fxI}){
  const R={conservative:{uk:.055,usa:.055,nl:.045,india:.075},moderate:{uk:.08,usa:.085,nl:.07,india:.095},aggressive:{uk:.10,usa:.11,nl:.09,india:.12}};
  const r=R[risk]||R.moderate;
  const fv=(ann,rate,yr)=>ann&&yr?ann*((Math.pow(1+rate,yr)-1)/rate):0;
  const ukFV=fv(ukSav,r.uk,horizon),usaFV=fv(usaSav,r.usa,horizon),nlFV=fv(nlSav,r.nl,horizon),indFV=fv(indiaSav,r.india,horizon);
  const totFV=ukFV+usaFV+nlFV+indFV;
  const onTrack=totFV>=goalAmt*.95,gap=Math.max(0,goalAmt-totFV);
  const extra=gap>0?gap/((Math.pow(1.08,horizon)-1)/.08)/12:0;
  const cards=[];
  if(on.uk)cards.push(`<div class="scard"><h3>üá¨üáß UK</h3>
    <div class="si">${20000-Math.min(20000,isaA*12)>0?'<strong>ISA headroom: ¬£'+Math.round((20000-Math.min(20000,isaA*12))/12)+'/mo</strong> unused ‚Äî tax-free growth potential':'‚úÖ ISA fully utilised'}</div>
    <div class="si"><strong>SIPP: +¬£${Math.round(sippA*12*.40).toLocaleString()}/yr</strong> tax relief ‚Äî effective 40% subsidy</div>
    <div class="si">${ukGross>50270?'‚ö† <strong>40% taxpayer</strong> ‚Äî max SIPP to reduce taxable income below ¬£50K':'‚úÖ Basic rate band ‚Äî prioritise ISA first'}</div>
    <div class="si">Projected at ${(r.uk*100).toFixed(0)}%/yr: <strong>¬£${Math.round(ukFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  if(on.usa)cards.push(`<div class="scard"><h3>üá∫üá∏ USA</h3>
    <div class="si"><strong>Max 401(k) first</strong> ‚Äî ${Math.max(0,23500-k401A*12)>0?'$'+Math.round(Math.max(0,23500-k401A*12)/12)+'/mo headroom left':'‚úÖ Maxed'} ‚Äî pre-tax reduces federal AGI</div>
    <div class="si"><strong>HSA triple tax</strong> ‚Äî pre-tax in, tax-free growth, tax-free for medical. Max it ($4,300/yr self)</div>
    <div class="si">‚ö† <strong>Avoid Indian MFs</strong> ‚Äî PFIC rules = punitive tax + Form 8621. Use INDA/SMIN ETFs instead</div>
    <div class="si">‚ö† <strong>File FBAR</strong> if NRE+NRO total >$10K. Penalty: $10K+ per violation</div>
    <div class="si">Projected at ${(r.usa*100).toFixed(0)}%/yr: <strong>¬£${Math.round(usaFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  if(on.nl)cards.push(`<div class="scard"><h3>üá≥üá± Netherlands</h3>
    <div class="si">${sv('nl30')==='yes'?'‚úÖ <strong>30% ruling active</strong> ‚Äî 30% of salary tax-exempt. Valid max 5 years ‚Äî use fully':'‚ö† Check 30% ruling eligibility ‚Äî worth ~15% net pay increase'}</div>
    <div class="si"><strong>Prioritise pensioenrekening</strong> over beleggingsrekening ‚Äî pension reduces Box 1; savings above ‚Ç¨57K face Box 3 wealth tax</div>
    <div class="si">NRE FD: declare balance on Jan 1 in <strong>Box 3</strong> (not income tax)</div>
    <div class="si">Projected at ${(r.nl*100).toFixed(0)}%/yr: <strong>¬£${Math.round(nlFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  if(on.india)cards.push(`<div class="scard"><h3>üáÆüá≥ India (NRI)</h3>
    <div class="si"><strong>NRE over NRO</strong> ‚Äî NRE interest tax-free in India. NRO suffers 30% TDS (‚Üí15% with Form 10F + TRC)</div>
    <div class="si"><strong>FCNR(B)</strong> over NRE FD ‚Äî hold in GBP/USD to eliminate forex risk entirely</div>
    <div class="si">Form 10F saves: <strong>‚Çπ${Math.round(nroFDA*12*.15).toLocaleString()}/yr</strong> ‚Äî get TRC from HMRC/IRS/Belastingdienst</div>
    <div class="si">Projected at ${(r.india*100).toFixed(0)}%/yr: <strong>¬£${Math.round(indFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  cards.push(`<div class="scard"><h3>üéØ Goal Status</h3>
    <div class="si">${onTrack?`<strong style="color:#7fd4a8">‚úÖ On track!</strong> Projected ¬£${Math.round(totFV/1000)}K vs goal ¬£${Math.round(goalAmt/1000)}K`:`<strong style="color:#f4a07a">‚ö† Gap: ¬£${Math.round(gap/1000)}K</strong><br>Proj. ¬£${Math.round(totFV/1000)}K vs target ¬£${Math.round(goalAmt/1000)}K`}</div>
    ${gap>0?`<div class="si">Need <strong>+¬£${Math.round(extra).toLocaleString()}/mo</strong> extra to close gap by age ${nv('goalAge')}</div>`:''}
    <div class="si">UK ¬£${Math.round(ukFV/1000)}K ¬∑ USA ¬£${Math.round(usaFV/1000)}K ¬∑ NL ¬£${Math.round(nlFV/1000)}K ¬∑ India ¬£${Math.round(indFV/1000)}K</div>
    <div class="si">Top priority: ${ukGross>50270?'Max UK SIPP (40% band)':usaGross>0?'Max 401(k) + HSA (USA)':'Optimise NRE FD + pension'}</div></div>`);
  el('stratGrid').innerHTML=cards.join('');
}

// ‚îÄ‚îÄ CHART ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateChart({isaA,sippA,ukCashA,nreFDA,nroFDA,mfA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nlCashA,fxI,fxU,fxE,horizon,goalAmt,risk}){
  const R={conservative:{uk:.055,usa:.055,nl:.045,india:.075},moderate:{uk:.08,usa:.085,nl:.07,india:.095},aggressive:{uk:.10,usa:.11,nl:.09,india:.12}};
  const r=R[risk]||R.moderate;
  const yrs=Array.from({length:horizon+1},(_,i)=>i);
  const fv=(m,rate,y)=>m&&y?m*12*((Math.pow(1+rate,y)-1)/rate):0;
  const ukD=yrs.map(y=>Math.round(fv(isaA,r.uk,y)+fv(sippA,r.uk,y)+fv(ukCashA,r.uk*.6,y)));
  const usaD=yrs.map(y=>Math.round((fv(k401A,r.usa,y)+fv(rothA,r.usa,y)+fv(hsaA,r.usa,y)+fv(usaBrokA,r.usa*.8,y))*fxU));
  const nlD=yrs.map(y=>Math.round((fv(nlPenA,r.nl,y)+fv(nlBrokA,r.nl*.85,y)+fv(nlCashA,r.nl*.55,y))*fxE));
  const indD=yrs.map(y=>Math.round((fv(nreFDA,r.india,y)+fv(nroFDA,r.india*.7,y)+fv(mfA,r.india*1.2,y))/fxI));
  const totD=yrs.map((_,i)=>ukD[i]+usaD[i]+nlD[i]+indD[i]);
  const goalLine=yrs.map(()=>goalAmt);
  const sets=[];
  if(on.uk)sets.push({label:'üá¨üáß UK',data:ukD,borderColor:'#1a3a6b',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  if(on.usa)sets.push({label:'üá∫üá∏ USA',data:usaD,borderColor:'#b22234',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  if(on.nl)sets.push({label:'üá≥üá± Netherlands',data:nlD,borderColor:'#e67000',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  if(on.india)sets.push({label:'üáÆüá≥ India',data:indD,borderColor:'#e05c2a',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  sets.push({label:'Total (¬£)',data:totD,borderColor:'#c9a84c',backgroundColor:'rgba(201,168,76,.07)',fill:true,borderWidth:2.5,tension:.4,pointRadius:0});
  sets.push({label:'Goal ¬£'+Math.round(goalAmt/1000)+'K',data:goalLine,borderColor:'rgba(45,122,79,.5)',borderWidth:1.5,borderDash:[5,4],fill:false,pointRadius:0});
  const ctx=el('growthChart').getContext('2d');
  if(myChart)myChart.destroy();
  myChart=new Chart(ctx,{type:'line',data:{labels:yrs.map(y=>y+'yr'),datasets:sets},options:{responsive:true,interaction:{mode:'index',intersect:false},plugins:{legend:{labels:{font:{family:'DM Sans',size:10},color:'#0f0e0d'}}},scales:{x:{grid:{display:false},ticks:{font:{family:'DM Mono',size:9},maxTicksLimit:8}},y:{ticks:{font:{family:'DM Mono',size:9},callback:v=>'¬£'+(v>=1e6?(v/1e6).toFixed(1)+'M':v>=1000?Math.round(v/1000)+'K':v)}}}}});
}

// ‚îÄ‚îÄ ALLOC BAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateAlloc({ukSav,usaSav,nlSav,indiaSav,isaA,sippA,ukCashA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nreFDA,nroFDA,mfA,fxU,fxE,fxI}){
  const segs=[];
  if(on.uk){if(isaA)segs.push({l:'ISA',v:isaA*12,c:'#1a3a6b'});if(sippA)segs.push({l:'SIPP',v:sippA*12,c:'#3a5a9b'});if(ukCashA)segs.push({l:'Cash',v:ukCashA*12,c:'#6a8fcb'});}
  if(on.usa){if(k401A)segs.push({l:'401k',v:k401A*12*fxU,c:'#8b1a1a'});if(rothA)segs.push({l:'Roth',v:rothA*12*fxU,c:'#b22234'});if(hsaA)segs.push({l:'HSA',v:hsaA*12*fxU,c:'#d04060'});if(usaBrokA)segs.push({l:'Brok.',v:usaBrokA*12*fxU,c:'#e06080'});}
  if(on.nl){if(nlPenA)segs.push({l:'NL Pen',v:nlPenA*12*fxE,c:'#994d00'});if(nlBrokA)segs.push({l:'NL Inv',v:nlBrokA*12*fxE,c:'#e67000'});}
  if(on.india){if(nreFDA)segs.push({l:'NRE',v:nreFDA*12/fxI,c:'#e05c2a'});if(nroFDA)segs.push({l:'NRO',v:nroFDA*12/fxI,c:'#e88a63'});if(mfA)segs.push({l:'MF',v:mfA*12/fxI,c:'#c9a84c'});}
  const tot=segs.reduce((s,x)=>s+x.v,0)||1;
  el('allocBar').innerHTML=segs.map(s=>`<div class="aseg" style="flex:${Math.round(s.v/tot*1000)};background:${s.c}">${s.l}</div>`).join('');
  el('allocLeg').innerHTML=segs.map(s=>`<div class="aleg-item"><div class="adot" style="background:${s.c}"></div>${s.l} (¬£${Math.round(s.v/1000)}K/yr)</div>`).join('');
}

// ‚îÄ‚îÄ TRANSFER CALC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updTx(){
  const amt=nv('txAmt'),curr=sv('txCurr');
  const fxI=nv('fxI')||107,fxU=nv('fxU')||0.79,fxE=nv('fxE')||0.85;
  let inr=0;
  if(curr==='gbp')inr=amt*fxI*.994;
  else if(curr==='usd')inr=amt*(fxI/fxU)*.994;
  else if(curr==='eur')inr=amt*(fxI/fxE)*.994;
  el('txResult').textContent='‚Çπ'+Math.round(inr).toLocaleString();
}

// ‚îÄ‚îÄ EMAIL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openMail(){el('emailModal').classList.add('open');}
function closeMail(){el('emailModal').classList.remove('open');}
function doEmail(){
  const to=el('emailTo').value.trim();
  if(!to||!to.includes('@')){alert('Please enter a valid email address.');return;}
  const note=el('emailNote').value;
  const ctry=Object.keys(on).filter(k=>on[k]).join('+').toUpperCase();
  const sub=`Global NRI Savings Summary ‚Äî ${new Date().toLocaleDateString('en-GB')} (${ctry})`;
  const body=`Global NRI Savings Optimizer ‚Äî Financial Summary
Generated: ${new Date().toLocaleString('en-GB')}
Active Countries: ${ctry} | Risk: ${sv('risk')}

WEALTH GOAL
Target: ¬£${nv('goalAmt').toLocaleString()} by age ${nv('goalAge')} (current age ${nv('age')})

UK
Base: ¬£${nv('ukBase').toLocaleString()} | Bonus: ¬£${nv('ukBonus').toLocaleString()} | RSU: ¬£${nv('ukStock').toLocaleString()}
ISA: ¬£${nv('isa')}/mo | SIPP: ¬£${nv('sipp')}/mo | Cash: ¬£${nv('ukCash')}/mo
Student Loan: ${sv('ukSL')} | Scotland: ${sv('ukScot')}

USA
Base: $${nv('usaBase').toLocaleString()} | Bonus: $${nv('usaBonus').toLocaleString()} | RSU: $${nv('usaStock').toLocaleString()}
401(k): $${nv('k401')}/mo | Roth IRA: $${nv('roth')}/mo | HSA: $${nv('hsa')}/mo | Brokerage: $${nv('usaBrok')}/mo
State: ${sv('usaState')}% | Filing: ${sv('usaFiling')}

NETHERLANDS
Base: ‚Ç¨${nv('nlBase').toLocaleString()} | Bonus: ‚Ç¨${nv('nlBonus').toLocaleString()} | RSU: ‚Ç¨${nv('nlStock').toLocaleString()}
Pensioenrekening: ‚Ç¨${nv('nlPen')}/mo | Beleggingsrekening: ‚Ç¨${nv('nlBrok')}/mo | Cash: ‚Ç¨${nv('nlCash')}/mo
30% Ruling: ${sv('nl30')}

INDIA (NRI)
NRE FD: ‚Çπ${nv('nreFD')}/mo | NRO FD: ‚Çπ${nv('nroFD')}/mo | Mutual Funds: ‚Çπ${nv('mf')}/mo
Rental: ‚Çπ${nv('inRent').toLocaleString()}/yr | FD Interest: ‚Çπ${nv('inFD').toLocaleString()}/yr

KEY REMINDERS
UK: Declare NRE FD interest on SA106; ISA max ¬£20K/yr
USA: File FBAR if India accounts >$10K; avoid Indian MFs (PFIC); Form 8938 (FATCA)
Netherlands: Declare India assets in Box 3 on Jan 1; check 30% ruling eligibility
India: Form 10F + TRC to reduce NRO TDS 30%‚Üí15%; PIS for equity trading

DISCLAIMER: Educational only. Not financial/tax/legal advice. Consult CA/IFA/CPA/SEBI advisor.
${note?'\nNOTE:\n'+note:''}
‚Äî Global NRI Savings Optimizer`;
  window.location.href=`mailto:${encodeURIComponent(to)}?subject=${encodeURIComponent(sub)}&body=${encodeURIComponent(body)}`;
  closeMail();
}
el('emailModal').addEventListener('click',e=>{if(e.target===el('emailModal'))closeMail();});

// ‚îÄ‚îÄ AI CHAT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SYS=`You are an expert multi-country NRI finance education assistant specialising in India, UK, USA and Netherlands. Cover FEMA, NRE/NRO accounts, DTAA treaties, ISA/SIPP (UK), 401k/Roth IRA/HSA/PFIC/FBAR/FATCA (USA), 30% ruling/Box 1/Box 2/Box 3 taxes (Netherlands), and cross-border wealth planning. Always clarify this is educational information, not regulated financial advice. Recommend a qualified CA/IFA/CPA/SEBI advisor for specific decisions. Use **bold** for key terms. Be practical and accurate.`;
function getCtx(){return `User profile: Age=${nv('age')}, Goal=¬£${nv('goalAmt')} by age ${nv('goalAge')}, Risk=${sv('risk')}, Countries active=${Object.keys(on).filter(k=>on[k]).join('+')}. UK gross=¬£${nv('ukBase')+nv('ukBonus')+nv('ukStock')}, USA gross=$${nv('usaBase')+nv('usaBonus')+nv('usaStock')}, NL gross=‚Ç¨${nv('nlBase')+nv('nlBonus')+nv('nlStock')}, NRE FD=‚Çπ${nv('nreFD')}/mo, NRO FD=‚Çπ${nv('nroFD')}/mo, 30% ruling=${sv('nl30')}.`;}
async function askQ(q){el('chatIn').value=q;sendMsg();}
async function sendMsg(){
  const input=el('chatIn'),msg=input.value.trim();if(!msg)return;
  const cw=el('chatWin'),sb=el('sendBtn');
  cw.innerHTML+=`<div class="msg user"><div class="mb">${msg}</div><div class="mtime">${new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</div></div>`;
  input.value='';sb.disabled=true;
  const tid='t'+Date.now();
  cw.innerHTML+=`<div class="msg ai" id="${tid}"><div class="mb"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div></div>`;
  cw.scrollTop=cw.scrollHeight;
  try{
    const res=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:1000,system:SYS,messages:[{role:'user',content:`${getCtx()}\n\nQuestion: ${msg}`}]})});
    const data=await res.json();
    const reply=data.content?.map(c=>c.text||'').join('')||'Unable to get a response. Please try again.';
    el(tid)?.remove();
    cw.innerHTML+=`<div class="msg ai"><div class="mb">${reply.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/\n/g,'<br>')}</div><div class="mtime">${new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</div></div>`;
  }catch(e){
    el(tid)?.remove();
    cw.innerHTML+=`<div class="msg ai"><div class="mb">‚ö†Ô∏è Connection error. Please check your network and try again.</div></div>`;
  }
  sb.disabled=false;cw.scrollTop=cw.scrollHeight;
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window.onload=()=>{updTotals();calc();};
</script>
</body>
</html>
