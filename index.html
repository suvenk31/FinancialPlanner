<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Global NRI Savings Optimizer Â· India Â· UK Â· USA Â· Netherlands</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root{
  --ink:#0f0e0d;--cream:#f7f3ee;--parch:#ede8e0;
  --india:#e05c2a;--uk:#1a3a6b;--usa:#b22234;--nl:#e67000;
  --gold:#c9a84c;--green:#2d7a4f;--red:#c0392b;
  --bd:rgba(15,14,13,0.14);--sh:0 4px 20px rgba(15,14,13,0.10);
  --r:10px;--sw:310px;
}
*{box-sizing:border-box;margin:0;padding:0;}
html{-webkit-text-size-adjust:100%;}
body{font-family:'DM Sans',sans-serif;background:var(--cream);color:var(--ink);min-height:100vh;}
.hdr{background:var(--ink);color:var(--cream);padding:12px 18px;display:flex;align-items:center;justify-content:space-between;border-bottom:3px solid var(--gold);gap:8px;flex-wrap:wrap;position:sticky;top:0;z-index:50;}
.hdr-l{display:flex;align-items:center;gap:10px;}
.flags{font-size:18px;letter-spacing:-3px;line-height:1;}
.htitle{font-family:'Playfair Display',serif;font-size:16px;font-weight:700;line-height:1.2;}
.hsub{font-size:9.5px;color:rgba(247,243,238,0.5);margin-top:2px;}
.hdr-r{display:flex;align-items:center;gap:6px;flex-wrap:wrap;}
.hbadge{font-size:9px;font-weight:600;letter-spacing:0.6px;text-transform:uppercase;padding:2px 7px;border-radius:20px;border:1px solid rgba(247,243,238,0.2);color:rgba(247,243,238,0.5);}
.email-btn{padding:7px 13px;background:var(--gold);color:var(--ink);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap;}
.menu-btn{display:none;background:none;border:none;color:var(--cream);font-size:22px;cursor:pointer;padding:2px 6px;line-height:1;}
.app{display:flex;min-height:calc(100vh - 52px);}
.sidebar{width:var(--sw);flex-shrink:0;background:var(--parch);border-right:1px solid var(--bd);overflow-y:auto;height:calc(100vh - 52px);position:sticky;top:52px;}
.sb-inner{padding:14px 13px 24px;}
.backdrop{display:none;position:fixed;inset:0;top:52px;background:rgba(15,14,13,0.45);z-index:39;}
.backdrop.show{display:block;}
.main{flex:1;overflow-x:hidden;min-width:0;}
.main-inner{padding:18px 20px;}
.priv{background:#fff8e6;border:1px solid #f0c040;border-left:4px solid var(--gold);border-radius:6px;padding:8px 10px;margin-bottom:12px;font-size:9.5px;line-height:1.5;color:#5a4a0a;display:flex;gap:6px;}
.c-grid{display:grid;grid-template-columns:1fr 1fr;gap:5px;margin-bottom:12px;}
.cbtn{padding:7px 4px;border:1.5px solid var(--bd);border-radius:7px;font-size:11px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;background:#fff;color:rgba(15,14,13,0.55);text-align:center;transition:all .18s;}
.cbtn.on-india{border-color:var(--india);background:rgba(224,92,42,.07);color:var(--india);}
.cbtn.on-uk{border-color:var(--uk);background:rgba(26,58,107,.07);color:var(--uk);}
.cbtn.on-usa{border-color:var(--usa);background:rgba(178,34,52,.07);color:var(--usa);}
.cbtn.on-nl{border-color:var(--nl);background:rgba(230,112,0,.07);color:var(--nl);}
.stitle{font-family:'Playfair Display',serif;font-size:11px;font-weight:700;letter-spacing:.9px;text-transform:uppercase;margin-bottom:9px;padding-bottom:5px;border-bottom:2px solid var(--ink);display:flex;align-items:center;justify-content:space-between;}
.stitle.uk{color:var(--uk);border-color:var(--uk);}
.stitle.india{color:var(--india);border-color:var(--india);}
.stitle.usa{color:var(--usa);border-color:var(--usa);}
.stitle.nl{color:var(--nl);border-color:var(--nl);}
.stitle.gold{color:#7a5a0a;border-color:var(--gold);}
.csec{margin-bottom:7px;border-radius:8px;overflow:hidden;border:1px solid var(--bd);}
.cshdr{display:flex;align-items:center;justify-content:space-between;padding:9px 12px;background:#fff;cursor:pointer;user-select:none;}
.cshdr-l{display:flex;align-items:center;gap:7px;font-size:12px;font-weight:600;}
.arr{font-size:10px;color:rgba(15,14,13,0.4);transition:transform .2s;}
.arr.o{transform:rotate(180deg);}
.csbody{padding:11px;background:#fff;border-top:1px solid var(--bd);}
.csbody.closed{display:none;}
.fg{margin-bottom:10px;}
.fg label{display:block;font-size:9.5px;font-weight:600;letter-spacing:.5px;text-transform:uppercase;color:rgba(15,14,13,.48);margin-bottom:4px;}
.fg input,.fg select{width:100%;padding:7px 10px;border:1.5px solid var(--bd);border-radius:7px;background:var(--cream);font-family:'DM Mono',monospace;font-size:12px;color:var(--ink);outline:none;transition:border-color .18s;-webkit-appearance:none;appearance:none;}
.fg input:focus,.fg select:focus{border-color:var(--gold);background:#fff;}
.fg-hint{font-size:9px;color:rgba(15,14,13,.38);margin-top:3px;font-style:italic;}
.fgrow{display:grid;grid-template-columns:1fr 1fr;gap:7px;}
.sdiv{border:none;border-top:1px dashed var(--bd);margin:11px 0;}
.goal-box{background:linear-gradient(135deg,rgba(201,168,76,.09),rgba(15,14,13,.03));border:1px solid rgba(201,168,76,.35);border-radius:8px;padding:11px;margin-bottom:12px;}
.goal-box-t{font-size:9.5px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:#7a5a0a;margin-bottom:8px;}
.itotal{font-family:'DM Mono',monospace;font-size:11px;font-weight:600;float:right;}
.calc-btn{width:100%;padding:11px;background:var(--ink);color:var(--cream);border:none;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;margin-top:8px;transition:background .18s;}
.calc-btn:hover{background:var(--india);}
.tabs-row{display:flex;border-bottom:1px solid var(--bd);overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;}
.tabs-row::-webkit-scrollbar{display:none;}
.tbtn{padding:9px 13px;font-size:11px;font-weight:600;color:rgba(15,14,13,.5);cursor:pointer;border-bottom:2.5px solid transparent;white-space:nowrap;background:none;border-top:none;border-left:none;border-right:none;font-family:'DM Sans',sans-serif;transition:all .18s;flex-shrink:0;}
.tbtn.active{color:var(--ink);border-bottom-color:var(--gold);}
.tpane{display:none;padding-top:16px;}
.tpane.active{display:block;}
.cg4{display:grid;grid-template-columns:repeat(4,1fr);gap:11px;margin-bottom:14px;}
.cg3{display:grid;grid-template-columns:repeat(3,1fr);gap:11px;margin-bottom:16px;}
.sc{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;position:relative;overflow:hidden;}
.sc::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;}
.sc.uk::before{background:var(--uk);}
.sc.usa::before{background:var(--usa);}
.sc.nl::before{background:var(--nl);}
.sc.india::before{background:var(--india);}
.sc.goal::before{background:var(--green);}
.sc.total::before{background:var(--gold);}
.sc-lbl{font-size:9px;font-weight:600;letter-spacing:.7px;text-transform:uppercase;color:rgba(15,14,13,.42);margin-bottom:5px;}
.sc-val{font-family:'Playfair Display',serif;font-size:21px;font-weight:700;line-height:1;}
.sc.uk .sc-val{color:var(--uk);}
.sc.usa .sc-val{color:var(--usa);}
.sc.nl .sc-val{color:var(--nl);}
.sc.india .sc-val{color:var(--india);}
.sc.goal .sc-val{color:var(--green);}
.sc-sub{font-size:10px;color:rgba(15,14,13,.48);margin-top:4px;line-height:1.4;}
.stpanel{background:var(--ink);border-radius:var(--r);padding:18px;margin-bottom:15px;color:var(--cream);}
.stpanel h2{font-family:'Playfair Display',serif;font-size:15px;margin-bottom:11px;}
.gbar{height:7px;background:rgba(247,243,238,.1);border-radius:4px;margin:8px 0 5px;overflow:hidden;}
.gbar-fill{height:100%;background:var(--gold);border-radius:4px;transition:width .8s ease;}
.gmeta{display:flex;justify-content:space-between;font-size:10px;color:rgba(247,243,238,.5);margin-bottom:13px;flex-wrap:wrap;gap:4px;}
.sgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:9px;}
.scard{background:rgba(247,243,238,.07);border:1px solid rgba(247,243,238,.1);border-radius:7px;padding:11px;}
.scard h3{font-size:9.5px;font-weight:700;letter-spacing:.6px;text-transform:uppercase;color:var(--gold);margin-bottom:7px;}
.si{font-size:11px;line-height:1.5;color:rgba(247,243,238,.82);padding:3.5px 0;border-bottom:1px solid rgba(247,243,238,.07);}
.si:last-child{border-bottom:none;}
.chart-box{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:16px;margin-bottom:15px;}
.chart-box-t{font-family:'Playfair Display',serif;font-size:14px;margin-bottom:12px;}
canvas{width:100%!important;max-height:250px;}
.alloc-box{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:15px;margin-bottom:15px;}
.abar{display:flex;gap:2px;height:24px;border-radius:5px;overflow:hidden;margin-bottom:9px;}
.aseg{height:100%;display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:700;color:#fff;overflow:hidden;white-space:nowrap;}
.aleg{display:flex;flex-wrap:wrap;gap:7px;}
.aleg-item{display:flex;align-items:center;gap:4px;font-size:10px;}
.adot{width:8px;height:8px;border-radius:2px;flex-shrink:0;}
.sal-tabs{display:flex;border:1px solid var(--bd);border-radius:7px;overflow:hidden;margin-bottom:14px;}
.stab{flex:1;padding:8px 6px;text-align:center;font-size:11px;font-weight:600;cursor:pointer;background:#fff;border:none;font-family:'DM Sans',sans-serif;color:rgba(15,14,13,.5);transition:all .18s;border-right:1px solid var(--bd);}
.stab:last-child{border-right:none;}
.stab.a-uk{background:var(--uk);color:#fff;}
.stab.a-usa{background:var(--usa);color:#fff;}
.stab.a-nl{background:var(--nl);color:#fff;}
.stab.a-india{background:var(--india);color:#fff;}
.spane{display:none;}
.spane.active{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.sal-in{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:16px;}
.sal-in h3{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:12px;}
.sal-res{background:var(--ink);border-radius:var(--r);padding:16px;color:var(--cream);}
.sal-res h3{font-family:'Playfair Display',serif;font-size:13px;color:var(--cream);margin-bottom:10px;}
.ptabs{display:flex;gap:4px;margin-bottom:10px;}
.ptab{padding:4px 8px;font-size:10px;font-weight:600;border:1px solid rgba(247,243,238,.2);border-radius:5px;cursor:pointer;background:transparent;color:rgba(247,243,238,.55);font-family:'DM Sans',sans-serif;}
.ptab.active{background:var(--gold);color:var(--ink);border-color:var(--gold);}
.rr{display:flex;justify-content:space-between;align-items:center;padding:5.5px 0;border-bottom:1px solid rgba(247,243,238,.08);font-size:10.5px;}
.rr:last-child{border-bottom:none;}
.rl{color:rgba(247,243,238,.65);}
.rv{font-family:'DM Mono',monospace;font-weight:600;color:var(--cream);}
.rv.hi{color:var(--gold);}
.rv.dn{color:#f4a07a;}
.rv.up{color:#7fd4a8;}
.rsec{font-size:9px;font-weight:700;letter-spacing:.8px;text-transform:uppercase;color:rgba(247,243,238,.35);padding:8px 0 2px;}
.ig{display:grid;grid-template-columns:1fr 1fr;gap:13px;margin-bottom:14px;}
.ipanel{background:#fff;border:1px solid var(--bd);border-radius:var(--r);overflow:hidden;}
.ihdr{padding:10px 14px;font-family:'Playfair Display',serif;font-size:12.5px;font-weight:700;display:flex;align-items:center;gap:7px;}
.ipanel.p-uk .ihdr{background:rgba(26,58,107,.06);color:var(--uk);}
.ipanel.p-usa .ihdr{background:rgba(178,34,52,.06);color:var(--usa);}
.ipanel.p-nl .ihdr{background:rgba(230,112,0,.06);color:var(--nl);}
.ipanel.p-india .ihdr{background:rgba(224,92,42,.06);color:var(--india);}
.irow{display:grid;grid-template-columns:1fr auto auto;gap:6px;padding:7px 14px;border-top:1px solid var(--bd);align-items:center;font-size:11px;}
.irow:hover{background:var(--parch);}
.ilimit{font-size:9px;color:rgba(15,14,13,.4);font-style:italic;}
.irate{font-family:'DM Mono',monospace;font-size:9.5px;padding:2px 5px;border-radius:20px;background:rgba(201,168,76,.13);color:#7a5a0a;font-weight:600;white-space:nowrap;}
.ibadge{font-size:9px;font-weight:600;padding:2px 5px;border-radius:20px;white-space:nowrap;}
.ib-ok{background:rgba(45,122,79,.11);color:var(--green);}
.ib-w{background:rgba(224,92,42,.11);color:var(--india);}
.ib-no{background:rgba(192,57,43,.11);color:var(--red);}
.tgrid{display:grid;grid-template-columns:1fr 1fr;gap:13px;}
.tcard{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:15px;}
.tcard h3{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:10px;}
.tr2{display:flex;justify-content:space-between;padding:6px 0;border-top:1px solid var(--bd);font-size:11px;}
.tr2:first-of-type{border-top:none;}
.tv{font-family:'DM Mono',monospace;font-size:10.5px;font-weight:500;}
.tv.r{color:var(--red);}
.tv.g{color:var(--green);}
.cgrid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px;}
.ccard{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;}
.ccard h3{font-family:'Playfair Display',serif;font-size:12.5px;margin-bottom:9px;}
.ci{display:flex;justify-content:space-between;align-items:flex-start;padding:6px 0;border-top:1px solid var(--bd);gap:8px;font-size:11px;}
.ci:first-of-type{border-top:none;}
.ci-d{font-size:9.5px;color:rgba(15,14,13,.45);margin-top:2px;}
.chip{font-size:9px;font-weight:700;padding:2px 5px;border-radius:20px;white-space:nowrap;flex-shrink:0;}
.chip.ok{background:rgba(45,122,79,.12);color:var(--green);}
.chip.rev{background:rgba(201,168,76,.18);color:#7a5a0a;}
.chip.alert{background:rgba(192,57,43,.12);color:var(--red);}
.rgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:13px;}
.rcard{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:12px;}
.rcard.best{border-color:var(--green);}
.rcard.best .rp::after{content:' â˜… Best';font-size:9px;color:var(--green);}
.rp{font-weight:700;font-size:12px;margin-bottom:3px;}
.rrate{font-family:'DM Mono',monospace;font-size:15px;color:var(--uk);font-weight:600;}
.rfee{font-size:10px;color:rgba(15,14,13,.45);margin-top:2px;}
.ai-wrap{background:var(--ink);border-radius:var(--r);padding:18px;color:var(--cream);}
.ai-hdr{display:flex;align-items:center;gap:9px;margin-bottom:12px;}
.ai-av{width:34px;height:34px;background:var(--gold);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;}
.ai-hdr h2{font-family:'Playfair Display',serif;font-size:15px;}
.ai-hdr p{font-size:10px;color:rgba(247,243,238,.45);margin-top:2px;}
.chat-win{background:rgba(247,243,238,.06);border-radius:8px;padding:11px;height:260px;overflow-y:auto;margin-bottom:9px;display:flex;flex-direction:column;gap:8px;}
.msg{max-width:88%;}
.msg.ai{align-self:flex-start;}
.msg.user{align-self:flex-end;}
.mb{padding:8px 11px;border-radius:9px;font-size:11.5px;line-height:1.55;}
.msg.ai .mb{background:rgba(247,243,238,.1);color:var(--cream);border-bottom-left-radius:3px;}
.msg.user .mb{background:var(--gold);color:var(--ink);font-weight:500;border-bottom-right-radius:3px;}
.mtime{font-size:9px;color:rgba(247,243,238,.28);margin-top:2px;padding:0 3px;}
.msg.user .mtime{text-align:right;}
.chat-row{display:flex;gap:7px;}
.chat-in{flex:1;padding:9px 12px;background:rgba(247,243,238,.1);border:1.5px solid rgba(247,243,238,.14);border-radius:8px;color:var(--cream);font-family:'DM Sans',sans-serif;font-size:11.5px;outline:none;}
.chat-in::placeholder{color:rgba(247,243,238,.28);}
.chat-in:focus{border-color:var(--gold);}
.send-btn{padding:9px 15px;background:var(--gold);color:var(--ink);border:none;border-radius:8px;font-weight:700;font-size:11.5px;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap;}
.send-btn:disabled{opacity:.5;}
.qq-wrap{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:9px;}
.qq{font-size:10px;padding:4px 9px;border-radius:20px;border:1px solid rgba(247,243,238,.18);color:rgba(247,243,238,.6);background:transparent;cursor:pointer;font-family:'DM Sans',sans-serif;}
.qq:hover{background:rgba(247,243,238,.1);border-color:var(--gold);}
.dot{width:6px;height:6px;background:var(--gold);border-radius:50%;animation:bop 1.2s infinite;display:inline-block;margin:0 2px;}
.dot:nth-child(2){animation-delay:.2s;}
.dot:nth-child(3){animation-delay:.4s;}
@keyframes bop{0%,80%,100%{transform:translateY(0);}40%{transform:translateY(-5px);}}
.banner{background:linear-gradient(135deg,rgba(224,92,42,.06),rgba(26,58,107,.06));border:1px solid var(--bd);border-left:4px solid var(--india);border-radius:7px;padding:11px 14px;margin-bottom:14px;font-size:11.5px;line-height:1.6;}
.ibox{background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;margin-bottom:14px;}
.ibox h3{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:9px;}
.treaty-tbl{width:100%;border-collapse:collapse;font-size:11px;}
.treaty-tbl th{padding:7px 10px;text-align:left;background:var(--parch);border-bottom:2px solid var(--bd);}
.treaty-tbl td{padding:6px 10px;border-bottom:1px solid var(--bd);}
.treaty-tbl tr:nth-child(even) td{background:rgba(15,14,13,.02);}
.modal-bg{display:none;position:fixed;inset:0;background:rgba(15,14,13,.55);z-index:200;align-items:center;justify-content:center;padding:16px;}
.modal-bg.open{display:flex;}
.modal{background:var(--cream);border-radius:12px;padding:22px;width:100%;max-width:460px;box-shadow:var(--sh);position:relative;}
.modal h2{font-family:'Playfair Display',serif;font-size:17px;margin-bottom:5px;}
.modal p{font-size:11px;color:rgba(15,14,13,.58);margin-bottom:13px;line-height:1.5;}
.modal-x{position:absolute;top:12px;right:12px;background:none;border:none;font-size:18px;cursor:pointer;color:rgba(15,14,13,.38);}
.modal-priv{font-size:9.5px;color:rgba(15,14,13,.42);margin-bottom:11px;font-style:italic;}
.modal-btns{display:flex;gap:7px;justify-content:flex-end;margin-top:12px;}
.btn-sec{padding:8px 15px;background:transparent;border:1.5px solid var(--bd);border-radius:7px;font-size:11.5px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;color:var(--ink);}
.btn-pri{padding:8px 17px;background:var(--ink);color:var(--cream);border:none;border-radius:7px;font-size:11.5px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;}
.btn-pri:hover{background:var(--india);}
.disclaimer{background:rgba(15,14,13,.04);border-top:1px solid var(--bd);padding:8px 18px;font-size:10px;color:rgba(15,14,13,.42);text-align:center;line-height:1.5;}
.hidden{display:none!important;}
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-thumb{background:rgba(15,14,13,.16);border-radius:3px;}

/* â”€â”€ RESPONSIVE â”€â”€ */
@media(max-width:1100px){
  :root{--sw:270px;}
  .cg4{grid-template-columns:1fr 1fr;}
  .sgrid{grid-template-columns:1fr 1fr;}
  .tgrid{grid-template-columns:1fr 1fr;}
  .spane.active{grid-template-columns:1fr;}
}
@media(max-width:820px){
  :root{--sw:260px;}
  .cg4{grid-template-columns:1fr 1fr;}
  .cg3{grid-template-columns:1fr 1fr;}
  .sgrid{grid-template-columns:1fr 1fr;}
  .ig{grid-template-columns:1fr;}
  .cgrid{grid-template-columns:1fr;}
  .spane.active{grid-template-columns:1fr;}
  .main-inner{padding:13px 13px;}
  .hbadge{display:none;}
}
@media(max-width:640px){
  .app{display:block;}
  .sidebar{
    position:fixed;top:52px;left:0;bottom:0;
    width:88vw;max-width:300px;z-index:40;
    transform:translateX(-100%);
    transition:transform .28s cubic-bezier(.4,0,.2,1);
    height:calc(100vh - 52px);
    box-shadow:4px 0 24px rgba(15,14,13,.2);
  }
  .sidebar.open{transform:translateX(0);}
  .menu-btn{display:flex;align-items:center;}
  .hsub{display:none;}
  .main{display:block;width:100%;}
  .main-inner{padding:11px 11px;}
  .cg4{grid-template-columns:1fr 1fr;}
  .cg3{grid-template-columns:1fr;}
  .sgrid{grid-template-columns:1fr;}
  .ig{grid-template-columns:1fr;}
  .tgrid{grid-template-columns:1fr;}
  .cgrid{grid-template-columns:1fr;}
  .rgrid{grid-template-columns:1fr 1fr;}
  .spane.active{grid-template-columns:1fr;}
  .sal-tabs{flex-wrap:wrap;}
  .stab{flex:1 0 40%;}
  .tbtn{font-size:10.5px;padding:8px 10px;}
  canvas{max-height:200px;}
  .fgrow{grid-template-columns:1fr;}
  .sc-val{font-size:18px;}
}
@media(max-width:380px){
  .cg4{grid-template-columns:1fr;}
  .rgrid{grid-template-columns:1fr;}
  .sal-tabs{flex-direction:column;}
}
</style>
</head>
<body>

<header class="hdr">
  <div class="hdr-l">
    <button class="menu-btn" id="menuBtn" onclick="toggleSB()" aria-label="Menu">â˜°</button>
    <div class="flags">ğŸ‡®ğŸ‡³ğŸ‡¬ğŸ‡§ğŸ‡ºğŸ‡¸ğŸ‡³ğŸ‡±</div>
    <div>
      <div class="htitle">Global NRI Savings Optimizer</div>
      <div class="hsub">India Â· UK Â· USA Â· Netherlands Â· Educational Tool</div>
    </div>
  </div>
  <div class="hdr-r">
    <span class="hbadge">FEMA 2000</span>
    <span class="hbadge">DTAA</span>
    <span class="hbadge">FY 2025â€“26</span>
    <button class="email-btn" onclick="openMail()">ğŸ“§ Email Summary</button>
  </div>
</header>

<div class="backdrop" id="bd" onclick="closeSB()"></div>
<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar" id="sb">
<div class="sb-inner">
<div class="priv"><span style="font-size:13px;flex-shrink:0">ğŸ”’</span><div><strong>Privacy:</strong> No names, NI/PAN/SSN or bank details. Approximate figures only. All calculations run locally â€” nothing stored or sent.</div></div>

<div class="stitle" style="margin-bottom:8px">Active Countries</div>
<div class="c-grid">
  <button class="cbtn on-india" id="cb-india" onclick="toggleC('india')">ğŸ‡®ğŸ‡³ India</button>
  <button class="cbtn on-uk" id="cb-uk" onclick="toggleC('uk')">ğŸ‡¬ğŸ‡§ UK</button>
  <button class="cbtn on-usa" id="cb-usa" onclick="toggleC('usa')">ğŸ‡ºğŸ‡¸ USA</button>
  <button class="cbtn on-nl" id="cb-nl" onclick="toggleC('nl')">ğŸ‡³ğŸ‡± Netherlands</button>
</div>

<div class="stitle">ğŸ‘¤ Profile</div>
<div class="fg"><label>Current Age</label><input type="number" id="age" value="32" min="18" max="70"></div>
<div class="goal-box">
  <div class="goal-box-t">ğŸ¯ Wealth Goal</div>
  <div class="fg"><label>Target (Â£ equiv.)</label><input type="number" id="goalAmt" value="500000"><div class="fg-hint">Use Â£ as base currency for cross-country comparison</div></div>
  <div class="fgrow">
    <div class="fg"><label>By Age</label><input type="number" id="goalAge" value="55" min="20" max="80"></div>
    <div class="fg"><label>Risk</label><select id="risk"><option value="conservative">Conservative</option><option value="moderate" selected>Moderate</option><option value="aggressive">Aggressive</option></select></div>
  </div>
</div>

<div class="stitle gold">ğŸ’± Exchange Rates</div>
<div class="fgrow">
  <div class="fg"><label>â‚¹ INR/Â£</label><input type="number" id="fxI" value="107" min="1"></div>
  <div class="fg"><label>$ USD/Â£</label><input type="number" id="fxU" value="0.79" step="0.01"></div>
</div>
<div class="fg"><label>â‚¬ EUR/Â£</label><input type="number" id="fxE" value="0.85" step="0.01"></div>
<div class="sdiv"></div>

<!-- UK -->
<div class="csec" id="csec-uk">
  <div class="cshdr" onclick="toggleSec('uk')">
    <div class="cshdr-l">ğŸ‡¬ğŸ‡§ <span style="color:var(--uk)">UK</span></div>
    <span class="arr o" id="arr-uk">â–¼</span>
  </div>
  <div class="csbody" id="body-uk">
    <div class="fg"><label>Base Salary (Â£/yr) <span class="itotal" id="ukTot">Â£0</span></label><input type="number" id="ukBase" value="65000" oninput="updTotals()"></div>
    <div class="fgrow">
      <div class="fg"><label>Bonus (Â£/yr)</label><input type="number" id="ukBonus" value="8000" oninput="updTotals()"></div>
      <div class="fg"><label>RSU/Stock (Â£/yr)</label><input type="number" id="ukStock" value="5000" oninput="updTotals()"></div>
    </div>
    <div class="fg"><label>Employee Pension %</label><input type="number" id="ukPen" value="5" min="0" max="60"></div>
    <div class="fgrow">
      <div class="fg"><label>Student Loan</label><select id="ukSL"><option value="none">None</option><option value="plan1">Plan 1</option><option value="plan2" selected>Plan 2</option><option value="plan5">Plan 5</option></select></div>
      <div class="fg"><label>Scotland?</label><select id="ukScot"><option value="no">No</option><option value="yes">Yes</option></select></div>
    </div>
    <div class="sdiv"></div>
    <div class="stitle uk">Allocations (Â£/mo)</div>
    <div class="fg"><label>ISA</label><input type="number" id="isa" value="1000"><div class="fg-hint">Limit Â£20K/yr â€” all growth tax-free</div></div>
    <div class="fg"><label>SIPP Pension</label><input type="number" id="sipp" value="600"></div>
    <div class="fg"><label>Cash / HYSA</label><input type="number" id="ukCash" value="400"></div>
  </div>
</div>

<!-- USA -->
<div class="csec" id="csec-usa">
  <div class="cshdr" onclick="toggleSec('usa')">
    <div class="cshdr-l">ğŸ‡ºğŸ‡¸ <span style="color:var(--usa)">USA</span></div>
    <span class="arr o" id="arr-usa">â–¼</span>
  </div>
  <div class="csbody" id="body-usa">
    <div class="fg"><label>Base Salary ($/yr) <span class="itotal" id="usaTot">$0</span></label><input type="number" id="usaBase" value="120000" oninput="updTotals()"></div>
    <div class="fgrow">
      <div class="fg"><label>Bonus ($/yr)</label><input type="number" id="usaBonus" value="15000" oninput="updTotals()"></div>
      <div class="fg"><label>RSU/Stock ($/yr)</label><input type="number" id="usaStock" value="20000" oninput="updTotals()"></div>
    </div>
    <div class="fgrow">
      <div class="fg"><label>Filing Status</label><select id="usaFiling"><option value="single" selected>Single</option><option value="mfj">MFJ</option></select></div>
      <div class="fg"><label>State Tax</label><select id="usaState"><option value="0">TX/FL/WA 0%</option><option value="4.95">IL 4.95%</option><option value="5">Other ~5%</option><option value="6">VA/GA ~6%</option><option value="9.3">CA up to 13.3%</option><option value="9">NY ~10.9%</option><option value="10.75">NJ max 10.75%</option></select></div>
    </div>
    <div class="sdiv"></div>
    <div class="stitle usa">Allocations ($/mo)</div>
    <div class="fg"><label>401(k)</label><input type="number" id="k401" value="1500"><div class="fg-hint">2025 limit $23,500/yr â€” pre-tax</div></div>
    <div class="fg"><label>Roth IRA</label><input type="number" id="roth" value="583"><div class="fg-hint">2025 limit $7,000/yr â€” tax-free growth</div></div>
    <div class="fg"><label>HSA (HDHP)</label><input type="number" id="hsa" value="300"><div class="fg-hint">$4,300/yr self â€” triple tax advantage</div></div>
    <div class="fg"><label>Brokerage</label><input type="number" id="usaBrok" value="500"></div>
  </div>
</div>

<!-- Netherlands -->
<div class="csec" id="csec-nl">
  <div class="cshdr" onclick="toggleSec('nl')">
    <div class="cshdr-l">ğŸ‡³ğŸ‡± <span style="color:var(--nl)">Netherlands</span></div>
    <span class="arr o" id="arr-nl">â–¼</span>
  </div>
  <div class="csbody" id="body-nl">
    <div class="fg"><label>Base Salary (â‚¬/yr) <span class="itotal" id="nlTot">â‚¬0</span></label><input type="number" id="nlBase" value="80000" oninput="updTotals()"></div>
    <div class="fgrow">
      <div class="fg"><label>Bonus (â‚¬/yr)</label><input type="number" id="nlBonus" value="10000" oninput="updTotals()"></div>
      <div class="fg"><label>RSU/Stock (â‚¬/yr)</label><input type="number" id="nlStock" value="8000" oninput="updTotals()"></div>
    </div>
    <div class="fg"><label>30% Ruling?</label><select id="nl30"><option value="no">No</option><option value="yes" selected>Yes â€” up to 5 yrs</option></select><div class="fg-hint">30% of salary tax-free for eligible expats</div></div>
    <div class="sdiv"></div>
    <div class="stitle nl">Allocations (â‚¬/mo)</div>
    <div class="fg"><label>Pensioenrekening</label><input type="number" id="nlPen" value="400"><div class="fg-hint">Tax-deductible â€” reduces Box 1 tax</div></div>
    <div class="fg"><label>Beleggingsrekening</label><input type="number" id="nlBrok" value="600"><div class="fg-hint">Box 3 wealth tax applies above â‚¬57K</div></div>
    <div class="fg"><label>Spaarrekening</label><input type="number" id="nlCash" value="300"></div>
  </div>
</div>

<!-- India -->
<div class="csec" id="csec-india">
  <div class="cshdr" onclick="toggleSec('india')">
    <div class="cshdr-l">ğŸ‡®ğŸ‡³ <span style="color:var(--india)">India</span></div>
    <span class="arr o" id="arr-india">â–¼</span>
  </div>
  <div class="csbody" id="body-india">
    <div class="fg"><label>India Income <span class="itotal" id="inTot">â‚¹0</span></label></div>
    <div class="fgrow">
      <div class="fg"><label>Rental (â‚¹/yr)</label><input type="number" id="inRent" value="300000" oninput="updTotals()"></div>
      <div class="fg"><label>Dividends (â‚¹/yr)</label><input type="number" id="inDiv" value="50000" oninput="updTotals()"></div>
    </div>
    <div class="fgrow">
      <div class="fg"><label>FD Interest (â‚¹/yr)</label><input type="number" id="inFD" value="100000" oninput="updTotals()"></div>
      <div class="fg"><label>Cap Gains (â‚¹/yr)</label><input type="number" id="inCG" value="50000" oninput="updTotals()"></div>
    </div>
    <div class="sdiv"></div>
    <div class="stitle india">Allocations (â‚¹/mo)</div>
    <div class="fg"><label>NRE Fixed Deposit</label><input type="number" id="nreFD" value="20000"><div class="fg-hint">Tax-free in India; taxable in residence country</div></div>
    <div class="fg"><label>NRO Fixed Deposit</label><input type="number" id="nroFD" value="10000"><div class="fg-hint">TDS 30% â†’ ~15% via Form 10F + TRC</div></div>
    <div class="fg"><label>Mutual Funds</label><input type="number" id="mf" value="15000"><div class="fg-hint">NRI KYC + FATCA; âš  US persons â€” PFIC rules apply</div></div>
  </div>
</div>

<button class="calc-btn" onclick="calc()">âš¡ Calculate Strategy</button>
</div><!-- /sb-inner -->
</aside>

<!-- MAIN CONTENT -->
<main class="main">
<div class="main-inner">

<div class="tabs-row">
  <button class="tbtn active" onclick="switchTab('strategy',this)">ğŸ§­ Strategy</button>
  <button class="tbtn" onclick="switchTab('salary',this)">ğŸ’¶ Salary</button>
  <button class="tbtn" onclick="switchTab('instruments',this)">ğŸ¦ Instruments</button>
  <button class="tbtn" onclick="switchTab('tax',this)">ğŸ’¸ Tax & Treaties</button>
  <button class="tbtn" onclick="switchTab('compliance',this)">âš–ï¸ Compliance</button>
  <button class="tbtn" onclick="switchTab('remittance',this)">ğŸ’± Remittance</button>
  <button class="tbtn" onclick="switchTab('advisor',this)">ğŸ¤– AI Advisor</button>
</div>

<!-- â•â•â• STRATEGY â•â•â• -->
<div class="tpane active" id="tab-strategy">
  <div class="cg4">
    <div class="sc uk" id="sc-uk"><div class="sc-lbl">ğŸ‡¬ğŸ‡§ UK Take-Home</div><div class="sc-val" id="cv-uk">Â£52K</div><div class="sc-sub" id="cs-uk">After tax & NI</div></div>
    <div class="sc usa" id="sc-usa"><div class="sc-lbl">ğŸ‡ºğŸ‡¸ USA Take-Home</div><div class="sc-val" id="cv-usa">$92K</div><div class="sc-sub" id="cs-usa">After federal + state + FICA</div></div>
    <div class="sc nl" id="sc-nl"><div class="sc-lbl">ğŸ‡³ğŸ‡± NL Take-Home</div><div class="sc-val" id="cv-nl">â‚¬61K</div><div class="sc-sub" id="cs-nl">After Box 1 tax</div></div>
    <div class="sc india" id="sc-india"><div class="sc-lbl">ğŸ‡®ğŸ‡³ India Portfolio</div><div class="sc-val" id="cv-india">â‚¹5.4L</div><div class="sc-sub">NRE + NRO + MF annual</div></div>
  </div>
  <div class="cg3">
    <div class="sc total"><div class="sc-lbl">ğŸŒ Annual Savings (Â£ equiv.)</div><div class="sc-val" id="cv-total">Â£31K</div><div class="sc-sub" id="cs-total">All active countries</div></div>
    <div class="sc goal"><div class="sc-lbl">ğŸ¯ Goal Progress</div><div class="sc-val" id="cv-goal">6%</div><div class="sc-sub" id="cs-goal">Toward Â£500K target</div></div>
    <div class="sc" style="border-top:3px solid var(--green)"><div class="sc-lbl">â± Years to Goal</div><div class="sc-val" id="cv-yrs" style="color:var(--green)">23</div><div class="sc-sub" id="cs-yrs">Age 32 â†’ 55</div></div>
  </div>
  <div class="stpanel">
    <h2>ğŸ§­ Personalised Multi-Country Wealth Strategy</h2>
    <div class="gbar"><div class="gbar-fill" id="gbarFill" style="width:6%"></div></div>
    <div class="gmeta"><span id="gmetaL">Â£0/yr saving toward Â£500K</span><span id="gmetaR">23 years to goal age 55</span></div>
    <div class="sgrid" id="stratGrid"><div class="scard"><h3>Loadingâ€¦</h3><div class="si">Press Calculate to generate your personalised strategy</div></div></div>
  </div>
  <div class="chart-box">
    <div class="chart-box-t">ğŸ“ˆ Projected Wealth Growth by Country (Â£)</div>
    <canvas id="growthChart"></canvas>
  </div>
  <div class="alloc-box">
    <div style="font-family:'Playfair Display',serif;font-size:14px;margin-bottom:10px">ğŸ’¼ Annual Savings Allocation</div>
    <div class="abar" id="allocBar"></div>
    <div class="aleg" id="allocLeg"></div>
  </div>
</div>

<!-- â•â•â• SALARY â•â•â• -->
<div class="tpane" id="tab-salary">
  <div style="margin-bottom:13px">
    <div style="font-family:'Playfair Display',serif;font-size:18px;margin-bottom:4px">ğŸ’¶ Take-Home Salary Calculators</div>
    <p style="font-size:11.5px;color:rgba(15,14,13,.58)">Full net-pay breakdown for UK, USA and Netherlands, plus India NRI tax position. Estimates â€” consult a tax professional for exact figures.</p>
  </div>
  <div class="sal-tabs">
    <button class="stab a-uk" onclick="switchSal('uk',this)">ğŸ‡¬ğŸ‡§ UK</button>
    <button class="stab" onclick="switchSal('usa',this)">ğŸ‡ºğŸ‡¸ USA</button>
    <button class="stab" onclick="switchSal('nl',this)">ğŸ‡³ğŸ‡± Netherlands</button>
    <button class="stab" onclick="switchSal('india',this)">ğŸ‡®ğŸ‡³ India (NRI)</button>
  </div>

  <!-- UK Salary -->
  <div class="spane active" id="sal-uk">
    <div class="sal-in">
      <h3>ğŸ‡¬ğŸ‡§ UK Income Details</h3>
      <div class="fg"><label>Base Salary (Â£)</label><input type="number" id="su_base" value="65000" oninput="calcUK()"></div>
      <div class="fgrow"><div class="fg"><label>Bonus (Â£)</label><input type="number" id="su_bonus" value="8000" oninput="calcUK()"></div><div class="fg"><label>RSU/Stock (Â£)</label><input type="number" id="su_stock" value="5000" oninput="calcUK()"></div></div>
      <div class="fgrow"><div class="fg"><label>Employee Pension %</label><input type="number" id="su_eep" value="5" min="0" oninput="calcUK()"></div><div class="fg"><label>Employer Pension %</label><input type="number" id="su_emp" value="3" min="0" oninput="calcUK()"></div></div>
      <div class="fg"><label>Student Loan</label><select id="su_sl" onchange="calcUK()"><option value="none">None</option><option value="plan1">Plan 1 â€” Â£24,990</option><option value="plan2" selected>Plan 2 â€” Â£27,295</option><option value="plan5">Plan 5 â€” Â£25,000</option></select></div>
      <div class="fgrow"><div class="fg"><label>Scotland?</label><select id="su_scot" onchange="calcUK()"><option value="no">No</option><option value="yes">Yes</option></select></div><div class="fg"><label>Sacrifice (Â£/mo)</label><input type="number" id="su_sac" value="0" oninput="calcUK()"></div></div>
    </div>
    <div class="sal-res">
      <h3>UK Take-Home</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('uk','annual',this)">Annual</button><button class="ptab" onclick="setPer('uk','monthly',this)">Monthly</button><button class="ptab" onclick="setPer('uk','weekly',this)">Weekly</button></div>
      <div class="rsec">Income</div>
      <div class="rr"><span class="rl">Base Salary</span><span class="rv hi" id="uk_base">Â£65,000</span></div>
      <div class="rr"><span class="rl">Annual Bonus</span><span class="rv" id="uk_bonus">Â£8,000</span></div>
      <div class="rr"><span class="rl">RSU / Stock Awards</span><span class="rv" id="uk_stock">Â£5,000</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="uk_gross">Â£78,000</span></div>
      <div class="rsec">Deductions</div>
      <div class="rr"><span class="rl">Income Tax</span><span class="rv dn" id="uk_tax">âˆ’Â£24,432</span></div>
      <div class="rr"><span class="rl">National Insurance</span><span class="rv dn" id="uk_ni">âˆ’Â£4,284</span></div>
      <div class="rr"><span class="rl">Employee Pension</span><span class="rv dn" id="uk_eep">âˆ’Â£3,250</span></div>
      <div class="rr"><span class="rl">Student Loan</span><span class="rv dn" id="uk_sl">âˆ’Â£0</span></div>
      <div class="rr"><span class="rl">Salary Sacrifice</span><span class="rv dn" id="uk_sac">âˆ’Â£0</span></div>
      <div class="rsec">Summary</div>
      <div class="rr"><span class="rl">ğŸ’° Take-Home Pay</span><span class="rv hi" id="uk_th">Â£46,034</span></div>
      <div class="rr"><span class="rl">+ Employer Pension</span><span class="rv up" id="uk_empp">+Â£1,950</span></div>
      <div class="rr"><span class="rl">Effective Tax Rate</span><span class="rv" id="uk_eff">37%</span></div>
      <div class="rr"><span class="rl">Marginal Rate</span><span class="rv" id="uk_marg">40%</span></div>
      <div class="rsec">Tax-Free Headroom</div>
      <div class="rr"><span class="rl">ISA Remaining</span><span class="rv up" id="uk_isa_l">Â£20,000/yr</span></div>
      <div class="rr"><span class="rl">SIPP Headroom</span><span class="rv up" id="uk_sipp_l">Â£55,000/yr</span></div>
    </div>
  </div>

  <!-- USA Salary -->
  <div class="spane" id="sal-usa">
    <div class="sal-in">
      <h3>ğŸ‡ºğŸ‡¸ USA Income Details</h3>
      <div class="fg"><label>Base Salary ($)</label><input type="number" id="uu_base" value="120000" oninput="calcUSA()"></div>
      <div class="fgrow"><div class="fg"><label>Bonus ($)</label><input type="number" id="uu_bonus" value="15000" oninput="calcUSA()"></div><div class="fg"><label>RSU/Stock ($)</label><input type="number" id="uu_stock" value="20000" oninput="calcUSA()"></div></div>
      <div class="fg"><label>Filing Status</label><select id="uu_filing" onchange="calcUSA()"><option value="single" selected>Single</option><option value="mfj">Married Filing Jointly</option></select></div>
      <div class="fg"><label>State Tax Rate</label><select id="uu_state" onchange="calcUSA()"><option value="0">Texas / Florida / Washington (0%)</option><option value="4.95">Illinois (4.95%)</option><option value="5">Other states (~5%)</option><option value="6">Virginia / Georgia (~6%)</option><option value="9.3">California (up to 13.3%)</option><option value="9">New York (~10.9%)</option><option value="10.75">New Jersey (max 10.75%)</option></select></div>
      <div class="fg"><label>401(k) ($/mo)</label><input type="number" id="uu_401k" value="1500" oninput="calcUSA()"><div class="fg-hint">2025 limit $23,500/yr â€” pre-tax; reduces federal AGI</div></div>
      <div class="fg"><label>HSA ($/mo, HDHP)</label><input type="number" id="uu_hsa" value="300" oninput="calcUSA()"><div class="fg-hint">$4,300/yr self â€” triple tax advantage</div></div>
      <div class="fg"><label>Pre-tax Benefits ($/mo)</label><input type="number" id="uu_pre" value="200" oninput="calcUSA()"><div class="fg-hint">Medical, FSA, commuter, etc.</div></div>
    </div>
    <div class="sal-res">
      <h3>USA Take-Home</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('usa','annual',this)">Annual</button><button class="ptab" onclick="setPer('usa','monthly',this)">Monthly</button><button class="ptab" onclick="setPer('usa','biweekly',this)">Bi-weekly</button></div>
      <div class="rsec">Income</div>
      <div class="rr"><span class="rl">Base Salary</span><span class="rv hi" id="ua_base">$120,000</span></div>
      <div class="rr"><span class="rl">Annual Bonus</span><span class="rv" id="ua_bonus">$15,000</span></div>
      <div class="rr"><span class="rl">RSU / Stock</span><span class="rv" id="ua_stock">$20,000</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="ua_gross">$155,000</span></div>
      <div class="rsec">Deductions</div>
      <div class="rr"><span class="rl">Federal Income Tax</span><span class="rv dn" id="ua_fed">âˆ’$30,427</span></div>
      <div class="rr"><span class="rl">Social Security (6.2%)</span><span class="rv dn" id="ua_ss">âˆ’$9,114</span></div>
      <div class="rr"><span class="rl">Medicare (1.45%+)</span><span class="rv dn" id="ua_mc">âˆ’$2,248</span></div>
      <div class="rr"><span class="rl">State Income Tax</span><span class="rv dn" id="ua_state">âˆ’$0</span></div>
      <div class="rr"><span class="rl">401(k) Contribution</span><span class="rv dn" id="ua_401k">âˆ’$18,000</span></div>
      <div class="rr"><span class="rl">HSA Contribution</span><span class="rv dn" id="ua_hsa">âˆ’$3,600</span></div>
      <div class="rsec">Summary</div>
      <div class="rr"><span class="rl">ğŸ’° Take-Home Pay</span><span class="rv hi" id="ua_th">$91,611</span></div>
      <div class="rr"><span class="rl">Effective Tax Rate</span><span class="rv" id="ua_eff">25%</span></div>
      <div class="rr"><span class="rl">Marginal Federal Rate</span><span class="rv" id="ua_marg">24%</span></div>
      <div class="rsec">NRI-Specific</div>
      <div class="rr"><span class="rl">FBAR Required?</span><span class="rv dn" id="ua_fbar">If India accts &gt;$10K</span></div>
      <div class="rr"><span class="rl">Indian MF (PFIC)</span><span class="rv dn">Avoid â€” punitive tax</span></div>
      <div class="rr"><span class="rl">401(k) Headroom</span><span class="rv up" id="ua_401l">$5,500/yr</span></div>
    </div>
  </div>

  <!-- NL Salary -->
  <div class="spane" id="sal-nl">
    <div class="sal-in">
      <h3>ğŸ‡³ğŸ‡± Netherlands Income Details</h3>
      <div class="fg"><label>Base Salary (â‚¬)</label><input type="number" id="un_base" value="80000" oninput="calcNL()"></div>
      <div class="fgrow"><div class="fg"><label>Bonus (â‚¬)</label><input type="number" id="un_bonus" value="10000" oninput="calcNL()"></div><div class="fg"><label>RSU/Stock (â‚¬)</label><input type="number" id="un_stock" value="8000" oninput="calcNL()"></div></div>
      <div class="fg"><label>30% Ruling?</label><select id="un_30" onchange="calcNL()"><option value="no">No</option><option value="yes" selected>Yes â€” valid up to 5 years</option></select><div class="fg-hint">30% of salary exempt from income tax. Apply within 4 months of starting work.</div></div>
      <div class="fg"><label>Health Insurance (â‚¬/mo)</label><input type="number" id="un_health" value="140" oninput="calcNL()"><div class="fg-hint">~â‚¬130â€“160/mo typical; zorgtoeslag subsidy may reduce this</div></div>
      <div class="fg"><label>Employee Pension (%)</label><input type="number" id="un_pen" value="5" min="0" max="30" oninput="calcNL()"></div>
    </div>
    <div class="sal-res">
      <h3>Netherlands Take-Home</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('nl','annual',this)">Annual</button><button class="ptab" onclick="setPer('nl','monthly',this)">Monthly</button></div>
      <div class="rsec">Income</div>
      <div class="rr"><span class="rl">Base Salary</span><span class="rv hi" id="un_base_r">â‚¬80,000</span></div>
      <div class="rr"><span class="rl">Bonus</span><span class="rv" id="un_bonus_r">â‚¬10,000</span></div>
      <div class="rr"><span class="rl">RSU / Stock</span><span class="rv" id="un_stock_r">â‚¬8,000</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="un_gross">â‚¬98,000</span></div>
      <div class="rr"><span class="rl">30% Ruling Exempt</span><span class="rv up" id="un_30r">â‚¬29,400</span></div>
      <div class="rr"><span class="rl">Taxable Gross (Box 1)</span><span class="rv" id="un_taxable">â‚¬68,600</span></div>
      <div class="rsec">Deductions</div>
      <div class="rr"><span class="rl">Box 1 Income Tax</span><span class="rv dn" id="un_tax">âˆ’â‚¬25,030</span></div>
      <div class="rr"><span class="rl">Employee Pension</span><span class="rv dn" id="un_pen_r">âˆ’â‚¬4,000</span></div>
      <div class="rr"><span class="rl">Health Insurance</span><span class="rv dn" id="un_health_r">âˆ’â‚¬1,680</span></div>
      <div class="rsec">Summary</div>
      <div class="rr"><span class="rl">ğŸ’° Netto Take-Home</span><span class="rv hi" id="un_th">â‚¬67,290</span></div>
      <div class="rr"><span class="rl">Effective Tax Rate</span><span class="rv" id="un_eff">38%</span></div>
      <div class="rr"><span class="rl">Box 3 Wealth Tax Est.</span><span class="rv dn" id="un_box3">~â‚¬0</span></div>
      <div class="rsec">NRI-Specific</div>
      <div class="rr"><span class="rl">NLâ€“India DTAA</span><span class="rv up">Active â€” claim TDS credit</span></div>
      <div class="rr"><span class="rl">NRE FD declared in</span><span class="rv dn">Box 3 (wealth tax, Jan 1)</span></div>
    </div>
  </div>

  <!-- India NRI -->
  <div class="spane" id="sal-india">
    <div class="sal-in">
      <h3>ğŸ‡®ğŸ‡³ India Income (NRI)</h3>
      <div class="fg"><label>Rental Income (â‚¹/yr)</label><input type="number" id="si_rent" value="300000" oninput="calcIndia()"><div class="fg-hint">30% standard deduction applied automatically</div></div>
      <div class="fgrow"><div class="fg"><label>Dividends (â‚¹/yr)</label><input type="number" id="si_div" value="50000" oninput="calcIndia()"></div><div class="fg"><label>FD Interest (â‚¹/yr)</label><input type="number" id="si_fd" value="100000" oninput="calcIndia()"></div></div>
      <div class="fgrow"><div class="fg"><label>LTCG &gt;1yr (â‚¹)</label><input type="number" id="si_ltcg" value="50000" oninput="calcIndia()"><div class="fg-hint">12.5% above â‚¹1.25L</div></div><div class="fg"><label>STCG &lt;1yr (â‚¹)</label><input type="number" id="si_stcg" value="0" oninput="calcIndia()"><div class="fg-hint">20% flat</div></div></div>
      <div class="fg"><label>Residence Country (DTAA rate)</label><select id="si_dtaa" onchange="calcIndia()"><option value="0.15" selected>UK (~15%)</option><option value="0.15">USA (~15%)</option><option value="0.10">Netherlands (~10%)</option></select></div>
    </div>
    <div class="sal-res">
      <h3>India Tax Position (NRI)</h3>
      <div class="ptabs"><button class="ptab active" onclick="setPer('india','annual',this)">Annual</button><button class="ptab" onclick="setPer('india','monthly',this)">Monthly</button></div>
      <div class="rsec">India-Sourced Income</div>
      <div class="rr"><span class="rl">Rental (after 30% deduction)</span><span class="rv hi" id="si_rent_r">â‚¹2,10,000</span></div>
      <div class="rr"><span class="rl">Dividends</span><span class="rv" id="si_div_r">â‚¹50,000</span></div>
      <div class="rr"><span class="rl">FD / Interest</span><span class="rv" id="si_fd_r">â‚¹1,00,000</span></div>
      <div class="rr"><span class="rl">LTCG + STCG</span><span class="rv" id="si_cg_r">â‚¹50,000</span></div>
      <div class="rr"><span class="rl">Total Gross</span><span class="rv hi" id="si_gross">â‚¹4,10,000</span></div>
      <div class="rsec">Tax Deducted (TDS)</div>
      <div class="rr"><span class="rl">NRO FD TDS (30%)</span><span class="rv dn" id="si_fdtds">âˆ’â‚¹30,000</span></div>
      <div class="rr"><span class="rl">Dividend TDS (20%)</span><span class="rv dn" id="si_divtds">âˆ’â‚¹10,000</span></div>
      <div class="rr"><span class="rl">LTCG Tax (12.5% above â‚¹1.25L)</span><span class="rv dn" id="si_ltcgt">âˆ’â‚¹0</span></div>
      <div class="rr"><span class="rl">Total India Tax</span><span class="rv dn" id="si_totaltax">âˆ’â‚¹40,000</span></div>
      <div class="rsec">Net & DTAA Relief</div>
      <div class="rr"><span class="rl">ğŸ’° Net India Income</span><span class="rv hi" id="si_net">â‚¹3,70,000</span></div>
      <div class="rr"><span class="rl">DTAA Credit (claimable)</span><span class="rv up" id="si_dtaa_r">+Â£373</span></div>
      <div class="rr"><span class="rl">Form 10F Saving (est.)</span><span class="rv up" id="si_10f">â‚¹15,000/yr</span></div>
      <div class="rr"><span class="rl">File ITR-2?</span><span class="rv dn">Yes if income &gt;â‚¹2.5L (Jul 31)</span></div>
    </div>
  </div>
</div>

<!-- â•â•â• INSTRUMENTS â•â•â• -->
<div class="tpane" id="tab-instruments">
  <div class="ig">
    <div class="ipanel p-uk"><div class="ihdr">ğŸ‡¬ğŸ‡§ UK Instruments</div>
      <div class="irow"><div><div>Stocks &amp; Shares ISA</div><div class="ilimit">Â£20K/yr â€” all growth tax-free</div></div><span class="irate">7â€“9%</span><span class="ibadge ib-ok">âœ“ OK</span></div>
      <div class="irow"><div><div>SIPP Pension</div><div class="ilimit">Â£60K/yr; 25% tax-free at 57</div></div><span class="irate">Tax relief</span><span class="ibadge ib-ok">âœ“ Priority</span></div>
      <div class="irow"><div><div>Cash ISA</div><div class="ilimit">Within Â£20K allowance</div></div><span class="irate">4.5â€“5%</span><span class="ibadge ib-ok">âœ“ OK</span></div>
      <div class="irow"><div><div>Workplace Pension</div><div class="ilimit">Employer match 3â€“8%</div></div><span class="irate">Match!</span><span class="ibadge ib-ok">âœ“ Max</span></div>
      <div class="irow"><div><div>Lifetime ISA (LISA)</div><div class="ilimit">25% govt bonus; ages 18â€“39</div></div><span class="irate">+25%</span><span class="ibadge ib-ok">âœ“ OK</span></div>
      <div class="irow"><div><div>Premium Bonds</div><div class="ilimit">Â£50K max; UK residents</div></div><span class="irate">4.4%</span><span class="ibadge ib-w">âš  Resident</span></div>
    </div>
    <div class="ipanel p-usa"><div class="ihdr">ğŸ‡ºğŸ‡¸ USA Instruments</div>
      <div class="irow"><div><div>401(k) Traditional</div><div class="ilimit">$23,500/yr 2025 â€” pre-tax</div></div><span class="irate">Pre-tax</span><span class="ibadge ib-ok">âœ“ Max first</span></div>
      <div class="irow"><div><div>Roth IRA</div><div class="ilimit">$7,000/yr â€” tax-free growth</div></div><span class="irate">Tax-free</span><span class="ibadge ib-ok">âœ“ Great</span></div>
      <div class="irow"><div><div>HSA (HDHP required)</div><div class="ilimit">$4,300 self; triple tax</div></div><span class="irate">Triple tax</span><span class="ibadge ib-ok">âœ“ Max it</span></div>
      <div class="irow"><div><div>Taxable Brokerage</div><div class="ilimit">No limit; LTCG 0â€“20%</div></div><span class="irate">Market</span><span class="ibadge ib-ok">âœ“ OK</span></div>
      <div class="irow"><div><div>Indian ETFs (INDA, SMIN)</div><div class="ilimit">US-listed; no PFIC issue</div></div><span class="irate">Market</span><span class="ibadge ib-ok">âœ“ Alt. to MF</span></div>
      <div class="irow"><div><div>Indian Mutual Funds</div><div class="ilimit">PFIC rules â€” punitive tax + Form 8621</div></div><span class="irate">Complex</span><span class="ibadge ib-no">âš  Avoid</span></div>
    </div>
  </div>
  <div class="ig">
    <div class="ipanel p-nl"><div class="ihdr">ğŸ‡³ğŸ‡± Netherlands Instruments</div>
      <div class="irow"><div><div>Pensioenrekening (3rd pillar)</div><div class="ilimit">Tax-deductible; reduces Box 1</div></div><span class="irate">Pre-tax</span><span class="ibadge ib-ok">âœ“ Priority</span></div>
      <div class="irow"><div><div>Beleggingsrekening (ETFs)</div><div class="ilimit">Box 3 wealth tax above â‚¬57K</div></div><span class="irate">Market</span><span class="ibadge ib-w">âš  Box 3</span></div>
      <div class="irow"><div><div>Spaarrekening (Savings)</div><div class="ilimit">Box 3 fictitious return 1.03%</div></div><span class="irate">3â€“4%</span><span class="ibadge ib-w">âš  Box 3</span></div>
      <div class="irow"><div><div>Eigen Woning (Mortgage)</div><div class="ilimit">Interest deductible â€” Box 1</div></div><span class="irate">Deductible</span><span class="ibadge ib-ok">âœ“ Efficient</span></div>
      <div class="irow"><div><div>Banksparen (annuity)</div><div class="ilimit">Pre-tax; pays at retirement</div></div><span class="irate">Pre-tax</span><span class="ibadge ib-ok">âœ“ OK</span></div>
      <div class="irow"><div><div>Indian MFs (via NRI)</div><div class="ilimit">Check PFIC if dual US/NL holder</div></div><span class="irate">12â€“15%</span><span class="ibadge ib-w">âš  Check</span></div>
    </div>
    <div class="ipanel p-india"><div class="ihdr">ğŸ‡®ğŸ‡³ India NRI Instruments</div>
      <div class="irow"><div><div>NRE Fixed Deposit</div><div class="ilimit">Fully repatriable; India-tax-free</div></div><span class="irate">6.5â€“7.5%</span><span class="ibadge ib-ok">âœ“ FEMA OK</span></div>
      <div class="irow"><div><div>FCNR(B) Deposit</div><div class="ilimit">Hold in GBP/USD â€” no forex risk</div></div><span class="irate">5â€“6%</span><span class="ibadge ib-ok">âœ“ Best FX</span></div>
      <div class="irow"><div><div>NRO Fixed Deposit</div><div class="ilimit">Repatriation â‰¤$1M/yr; TDS 30%</div></div><span class="irate">6.5â€“7.5%</span><span class="ibadge ib-w">âš  TDS 30%</span></div>
      <div class="irow"><div><div>NPS Tier 1</div><div class="ilimit">NRIs eligible; PFRDA regulated</div></div><span class="irate">9â€“12%</span><span class="ibadge ib-ok">âœ“ OK</span></div>
      <div class="irow"><div><div>Equity Mutual Funds</div><div class="ilimit">NRI KYC + FATCA; US persons âš </div></div><span class="irate">12â€“15%</span><span class="ibadge ib-w">âš  AMC check</span></div>
      <div class="irow"><div><div>PPF (existing only)</div><div class="ilimit">NRIs can't open new; 7.1% EEE</div></div><span class="irate">7.1%</span><span class="ibadge ib-w">âš  Existing</span></div>
    </div>
  </div>
  <div class="ibox">
    <h3>âš ï¸ Country-Specific NRI Cautions</h3>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(210px,1fr));gap:10px;font-size:11px;line-height:1.65">
      <div style="padding:10px;background:rgba(26,58,107,.05);border-radius:7px;border-left:3px solid var(--uk)"><strong>ğŸ‡¬ğŸ‡§ UK:</strong> Declare NRE FD interest on SA106. ISA + SIPP are most efficient wrappers. Claim DTAA credit on Self-Assessment.</div>
      <div style="padding:10px;background:rgba(178,34,52,.05);border-radius:7px;border-left:3px solid var(--usa)"><strong>ğŸ‡ºğŸ‡¸ USA:</strong> Indian MFs = PFIC â€” avoid. File FBAR if foreign accounts &gt;$10K. Form 8938 for FATCA. Use US-listed India ETFs instead of direct MFs.</div>
      <div style="padding:10px;background:rgba(230,112,0,.05);border-radius:7px;border-left:3px solid var(--nl)"><strong>ğŸ‡³ğŸ‡± Netherlands:</strong> 30% ruling reduces effective tax significantly. Declare ALL India assets in Box 3 on Jan 1. NLâ€“India DTAA is active â€” attach TRC to claim credit.</div>
      <div style="padding:10px;background:rgba(224,92,42,.05);border-radius:7px;border-left:3px solid var(--india)"><strong>ğŸ‡®ğŸ‡³ India:</strong> Form 10F + TRC halves NRO TDS (30%â†’15%). NRE always better than NRO for foreign earnings. FCNR(B) eliminates forex risk entirely.</div>
    </div>
  </div>
</div>

<!-- â•â•â• TAX & TREATIES â•â•â• -->
<div class="tpane" id="tab-tax">
  <div class="banner"><strong>ğŸŒ India DTAA Network:</strong> India has active DTAAs with UK, USA and Netherlands, preventing double taxation. As an NRI, you pay residence-country tax on worldwide income but can claim credit for Indian TDS paid. NRE FD interest is tax-free in India but <strong>taxable in your residence country</strong>.</div>
  <div class="tgrid">
    <div class="tcard"><h3>ğŸ‡¬ğŸ‡§ UK Tax</h3>
      <div class="tr2"><span>Total Gross</span><span class="tv" id="t_ukG">Â£78,000</span></div>
      <div class="tr2"><span>Income Tax</span><span class="tv r" id="t_ukT">âˆ’Â£24,432</span></div>
      <div class="tr2"><span>National Insurance</span><span class="tv r" id="t_ukNI">âˆ’Â£4,284</span></div>
      <div class="tr2"><span>ISA (all growth)</span><span class="tv g">Â£0 tax</span></div>
      <div class="tr2"><span>SIPP Tax Relief</span><span class="tv g" id="t_sipp">+Â£2,880/yr</span></div>
      <div class="tr2"><span>NRE FD (UK taxable)</span><span class="tv r" id="t_nreTax">âˆ’Â£648</span></div>
      <div class="tr2"><span>DTAA Credit</span><span class="tv g">Claim via SA106</span></div>
    </div>
    <div class="tcard"><h3>ğŸ‡ºğŸ‡¸ USA Tax</h3>
      <div class="tr2"><span>Total Gross</span><span class="tv" id="t_usaG">$155,000</span></div>
      <div class="tr2"><span>Federal Income Tax</span><span class="tv r" id="t_usaT">âˆ’$30,427</span></div>
      <div class="tr2"><span>FICA (SS + Medicare)</span><span class="tv r" id="t_fica">âˆ’$11,362</span></div>
      <div class="tr2"><span>401(k) Tax Saving</span><span class="tv g" id="t_401ks">Saves ~$4,320/yr</span></div>
      <div class="tr2"><span>Indian MF (PFIC)</span><span class="tv r">Punitive â€” avoid</span></div>
      <div class="tr2"><span>FBAR Required?</span><span class="tv r" id="t_fbar">Check annually</span></div>
      <div class="tr2"><span>DTAA Credit (Form 1116)</span><span class="tv g">For Indian TDS paid</span></div>
    </div>
    <div class="tcard"><h3>ğŸ‡³ğŸ‡± Netherlands Tax</h3>
      <div class="tr2"><span>Total Gross</span><span class="tv" id="t_nlG">â‚¬98,000</span></div>
      <div class="tr2"><span>30% Ruling Exempt</span><span class="tv g" id="t_nl30">â‚¬29,400</span></div>
      <div class="tr2"><span>Box 1 Tax</span><span class="tv r" id="t_nlT">âˆ’â‚¬25,030</span></div>
      <div class="tr2"><span>Box 3 (wealth tax)</span><span class="tv r">~1.03% above â‚¬57K</span></div>
      <div class="tr2"><span>NRE FD in NL</span><span class="tv r">Box 3 â€” declare Jan 1</span></div>
      <div class="tr2"><span>NLâ€“India DTAA</span><span class="tv g">Active â€” claim TDS</span></div>
    </div>
    <div class="tcard"><h3>ğŸ‡®ğŸ‡³ India Tax (NRI)</h3>
      <div class="tr2"><span>India-Sourced Income</span><span class="tv" id="t_inG">â‚¹5,00,000</span></div>
      <div class="tr2"><span>NRE FD Interest</span><span class="tv g">Tax-free in India</span></div>
      <div class="tr2"><span>NRO TDS (30%)</span><span class="tv r" id="t_nroTDS">âˆ’â‚¹36,000/yr</span></div>
      <div class="tr2"><span>Form 10F Saving</span><span class="tv g" id="t_10f">â‚¹18,000/yr</span></div>
      <div class="tr2"><span>LTCG Equity</span><span class="tv">12.5% above â‚¹1.25L</span></div>
      <div class="tr2"><span>Dividend TDS (NRI)</span><span class="tv">20%</span></div>
    </div>
  </div>
  <div class="ibox" style="margin-top:14px;overflow-x:auto">
    <h3>ğŸ“‹ India DTAA â€” UK Â· USA Â· Netherlands Comparison</h3>
    <table class="treaty-tbl">
      <thead><tr><th>Item</th><th>ğŸ‡¬ğŸ‡§ UK</th><th>ğŸ‡ºğŸ‡¸ USA</th><th>ğŸ‡³ğŸ‡± Netherlands</th></tr></thead>
      <tbody>
        <tr><td>India DTAA active?</td><td style="color:var(--green)">âœ“ Yes</td><td style="color:var(--green)">âœ“ Yes</td><td style="color:var(--green)">âœ“ Yes</td></tr>
        <tr><td>NRO TDS with TRC (Form 10F)</td><td>~15%</td><td>~15%</td><td>~10%</td></tr>
        <tr><td>NRE FD taxable abroad?</td><td style="color:var(--red)">Yes â€” income tax</td><td style="color:var(--red)">Yes â€” federal tax</td><td style="color:var(--red)">Yes â€” Box 3</td></tr>
        <tr><td>Indian Mutual Funds</td><td style="color:var(--green)">âœ“ OK with NRI KYC</td><td style="color:var(--red)">âš  PFIC â€” avoid</td><td style="color:var(--green)">âœ“ OK (verify PFIC)</td></tr>
        <tr><td>Foreign account reporting</td><td>SA106 (HMRC)</td><td style="color:var(--red)">FBAR + Form 8938</td><td>Box 3 declaration</td></tr>
        <tr><td>India equity capital gains</td><td>UK CGT rules</td><td>LTCG 15â€“20%</td><td>Box 3 flat</td></tr>
        <tr><td>Unique expat benefit</td><td>â€”</td><td>Foreign Tax Credit (1116)</td><td style="color:var(--nl)">30% Ruling (Kennismigranten)</td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- â•â•â• COMPLIANCE â•â•â• -->
<div class="tpane" id="tab-compliance">
  <div class="banner"><strong>âš–ï¸ Multi-Country NRI Compliance:</strong> USA has the most onerous reporting obligations (FBAR + FATCA + PFIC forms). Netherlands requires Box 3 worldwide asset declaration. UK requires SA106. All require India TDS/ITR coordination via DTAA.</div>
  <div class="cgrid">
    <div class="ccard"><h3>ğŸ‡¬ğŸ‡§ UK Obligations</h3>
      <div class="ci"><div><div style="font-weight:500">Self Assessment SA100</div><div class="ci-d">Mandatory if India income &gt;Â£1K or total gross &gt;Â£100K</div></div><span class="chip alert">Required</span></div>
      <div class="ci"><div><div style="font-weight:500">SA106 (Foreign Income)</div><div class="ci-d">India income + DTAA credit claims â€” file every year</div></div><span class="chip alert">Required</span></div>
      <div class="ci"><div><div style="font-weight:500">NRE FD Interest</div><div class="ci-d">Tax-free in India but taxable in UK â€” report as foreign interest</div></div><span class="chip alert">Declare</span></div>
      <div class="ci"><div><div style="font-weight:500">CGT on India Equity</div><div class="ci-d">SA108 if gains above Â£3,000 annual exempt amount (2024â€“25)</div></div><span class="chip rev">If gains</span></div>
    </div>
    <div class="ccard"><h3>ğŸ‡ºğŸ‡¸ USA Obligations</h3>
      <div class="ci"><div><div style="font-weight:500">FBAR (FinCEN 114)</div><div class="ci-d">If any foreign account &gt;$10K at any point. Penalty: $10K+ per violation</div></div><span class="chip alert">Critical</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 8938 (FATCA)</div><div class="ci-d">Foreign assets &gt;$50K (single) / $100K (MFJ) â€” filed with Form 1040</div></div><span class="chip alert">Required</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 8621 (PFIC)</div><div class="ci-d">Required for each Indian mutual fund held â€” best avoided entirely</div></div><span class="chip alert">Avoid MFs</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 1116 (Tax Credit)</div><div class="ci-d">Claim foreign tax credit for Indian TDS â€” avoids double taxation</div></div><span class="chip ok">Claim it</span></div>
    </div>
    <div class="ccard"><h3>ğŸ‡³ğŸ‡± Netherlands Obligations</h3>
      <div class="ci"><div><div style="font-weight:500">Aangifte inkomstenbelasting</div><div class="ci-d">Annual return â€” includes Box 3 worldwide asset declaration on Jan 1</div></div><span class="chip alert">Annual</span></div>
      <div class="ci"><div><div style="font-weight:500">Box 3 Foreign Assets</div><div class="ci-d">All NRE/NRO/FD balances on Jan 1 subject to 1.03â€“5.53% fictitious return tax</div></div><span class="chip alert">Declare all</span></div>
      <div class="ci"><div><div style="font-weight:500">30% Ruling Application</div><div class="ci-d">Apply within 4 months of starting work; valid up to 5 years; saves ~15% effective tax</div></div><span class="chip ok">Apply early</span></div>
      <div class="ci"><div><div style="font-weight:500">NLâ€“India DTAA</div><div class="ci-d">Attach TRC from Belastingdienst to claim Indian TDS credit in Dutch return</div></div><span class="chip ok">Claim TDS</span></div>
    </div>
    <div class="ccard"><h3>ğŸ‡®ğŸ‡³ India Obligations (NRI)</h3>
      <div class="ci"><div><div style="font-weight:500">ITR-2 Filing</div><div class="ci-d">File if India income &gt;â‚¹2.5L or to claim TDS refunds. Deadline: July 31</div></div><span class="chip rev">If applicable</span></div>
      <div class="ci"><div><div style="font-weight:500">Convert A/c to NRO</div><div class="ci-d">Within 3 months of becoming NRI â€” mandatory under FEMA 1999</div></div><span class="chip alert">Mandatory</span></div>
      <div class="ci"><div><div style="font-weight:500">Form 10F + TRC</div><div class="ci-d">Get Tax Residency Certificate from HMRC/IRS/Belastingdienst + submit Form 10F to reduce NRO TDS 30%â†’15%</div></div><span class="chip ok">Recommended</span></div>
      <div class="ci"><div><div style="font-weight:500">PIS for Indian Equities</div><div class="ci-d">Portfolio Investment Scheme â€” mandatory for NRI trading on NSE/BSE</div></div><span class="chip rev">If investing</span></div>
    </div>
  </div>
</div>

<!-- â•â•â• REMITTANCE â•â•â• -->
<div class="tpane" id="tab-remittance">
  <div style="font-family:'Playfair Display',serif;font-size:18px;margin-bottom:5px">ğŸ’± Multi-Currency Remittance to India</div>
  <p style="font-size:11.5px;color:rgba(15,14,13,.58);margin-bottom:13px">Sending from UK, USA or Netherlands â€” compare providers and maximise â‚¹ received.</p>
  <div style="background:#fff;border:1px solid var(--bd);border-radius:var(--r);padding:14px;margin-bottom:13px">
    <div style="font-size:12px;font-weight:600;margin-bottom:8px">Transfer Calculator</div>
    <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
      <input type="number" id="txAmt" value="2000" style="padding:7px 10px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Mono',monospace;font-size:13px;width:110px;outline:none" oninput="updTx()">
      <select id="txCurr" onchange="updTx()" style="padding:7px 10px;border:1.5px solid var(--bd);border-radius:7px;font-size:12px;font-family:'DM Sans',sans-serif;outline:none"><option value="gbp">GBP (Â£)</option><option value="usd">USD ($)</option><option value="eur">EUR (â‚¬)</option></select>
      <span style="font-size:13px;font-weight:600">â†’</span>
      <span id="txResult" style="font-family:'Playfair Display',serif;font-size:20px;color:var(--india)">â‚¹2,14,000</span>
      <span style="font-size:10px;color:rgba(15,14,13,.45)">via Wise (est.)</span>
    </div>
    <div style="font-size:9.5px;color:rgba(15,14,13,.38);margin-top:5px">*Indicative rates only. Always verify live rates before transferring.</div>
  </div>
  <div class="rgrid">
    <div class="rcard best"><div class="rp">Wise</div><div class="rrate">â‚¹106.40/Â£</div><div class="rfee">~0.5â€“0.7% Â· GBP/USD/EUR</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Best all-round. NRE/NRO credit. Supports all 3 currencies.</div></div>
    <div class="rcard"><div class="rp">Revolut</div><div class="rrate">â‚¹105.80/Â£</div><div class="rfee">0.5â€“1% Â· Weekend limits</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Good for smaller amounts. INR can be held in-app.</div></div>
    <div class="rcard"><div class="rp">ICICI Money2India</div><div class="rrate">â‚¹105.50/Â£</div><div class="rfee">Free for ICICI NRE accounts</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Best with ICICI. Auto purpose codes. UK + US + NL.</div></div>
    <div class="rcard"><div class="rp">HDFC QuickRemit</div><div class="rrate">â‚¹105.30/Â£</div><div class="rfee">Â£0 for NRE credit</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Best with HDFC India. Fast NRE/NRO. UK + US.</div></div>
    <div class="rcard"><div class="rp">Remitly</div><div class="rrate">â‚¹105.90/Â£</div><div class="rfee">~1% Â· Express option</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Good for USD from USA. Express next-day delivery.</div></div>
    <div class="rcard"><div class="rp">Western Union</div><div class="rrate">â‚¹104.20/Â£</div><div class="rfee">Â£3â€“5 flat Â· GBP/USD/EUR</div><div style="font-size:10px;margin-top:5px;color:rgba(15,14,13,.55)">Reliable. Lower rate. Good for large one-off transfers.</div></div>
  </div>
  <div class="ibox">
    <h3>ğŸ“‹ Compliance Checklist by Country of Origin</h3>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;font-size:11.5px;line-height:1.65">
      <div><strong style="color:var(--uk)">ğŸ‡¬ğŸ‡§ UK</strong><br>âœ… Purpose code (P1301 / P0003)<br>âœ… No limit for NRE from UK earnings<br>âš  &gt;Â£10K may trigger AML checks<br>âœ… Keep receipts for SA106</div>
      <div><strong style="color:var(--usa)">ğŸ‡ºğŸ‡¸ USA</strong><br>âœ… Purpose code required<br>âš  FBAR if India accts &gt;$10K total<br>âœ… No limit for NRE from US income<br>âš  Report on Form 8938 if &gt;$50K</div>
      <div><strong style="color:var(--nl)">ğŸ‡³ğŸ‡± Netherlands</strong><br>âœ… Wise / ICICI support EURâ†’INR<br>âœ… Purpose code required<br>âš  Declare India assets in Box 3<br>âœ… NRO repatriation max $1M/yr</div>
    </div>
  </div>
</div>

<!-- â•â•â• AI ADVISOR â•â•â• -->
<div class="tpane" id="tab-advisor">
  <div class="ai-wrap">
    <div class="ai-hdr">
      <div class="ai-av">ğŸ¤–</div>
      <div><h2>Global NRI Finance Advisor</h2><p>Powered by Claude Â· India Â· UK Â· USA Â· Netherlands Â· FEMA Â· DTAA Â· Tax Â· Strategy</p></div>
    </div>
    <div class="qq-wrap">
      <button class="qq" onclick="askQ('How should I prioritise ISA, 401k, NL pension and NRE FD across countries?')">Multi-country priority?</button>
      <button class="qq" onclick="askQ('What are PFIC rules for US-based NRIs holding Indian mutual funds?')">US PFIC rules?</button>
      <button class="qq" onclick="askQ('How does the 30% ruling in Netherlands affect my Indian NRE FD and investments?')">NL 30% ruling + India?</button>
      <button class="qq" onclick="askQ('What FBAR and FATCA forms do I need as a US-based NRI with Indian accounts?')">FBAR & FATCA?</button>
      <button class="qq" onclick="askQ('How do I claim DTAA credit for Indian TDS paid in UK, USA and Netherlands?')">DTAA credit all countries?</button>
      <button class="qq" onclick="askQ('What is the most tax-efficient way to invest my bonus across UK, USA and India?')">Invest bonus wisely?</button>
    </div>
    <div style="background:rgba(201,168,76,.12);border:1px solid rgba(201,168,76,.28);border-radius:7px;padding:8px 11px;margin-bottom:9px;font-size:11px;color:rgba(247,243,238,.72);line-height:1.5">
      ğŸ”’ <strong style="color:rgba(247,243,238,.9)">Privacy:</strong> Approximate figures only â€” no names, PAN/NI/SSN or account numbers. &nbsp;Â·&nbsp; âš ï¸ <strong style="color:rgba(247,243,238,.9)">Educational only</strong> â€” consult a qualified CA, IFA, CPA or SEBI advisor before acting.
    </div>
    <div class="chat-win" id="chatWin">
      <div class="msg ai"><div class="mb">ğŸ‘‹ Hello! I'm your multi-country NRI finance assistant covering <strong>India, UK, USA and Netherlands</strong>. I can help with FEMA, DTAA treaties, PFIC rules, 30% ruling, FBAR/FATCA, cross-border tax, and wealth strategy.<br><br>Your sidebar inputs inform my guidance â€” try a quick question above or type anything below!</div><div class="mtime">Just now</div></div>
    </div>
    <div class="chat-row">
      <input type="text" class="chat-in" id="chatIn" placeholder="Ask about FEMA, PFIC, 30% ruling, FBAR, DTAA, strategyâ€¦" onkeydown="if(event.key==='Enter')sendMsg()">
      <button class="send-btn" id="sendBtn" onclick="sendMsg()">Send â†’</button>
    </div>
  </div>
</div>

</div></main></div>

<div class="disclaimer">âš ï¸ <strong>Educational Tool Only.</strong> This calculator provides general financial awareness and does <strong>not</strong> constitute financial, tax or legal advice. It does not replace a qualified IFA, Chartered Accountant, CPA or SEBI-registered advisor. Tax rules and FEMA regulations change frequently â€” always verify with a professional before acting. All figures are estimates.</div>

<!-- EMAIL MODAL -->
<div class="modal-bg" id="emailModal">
  <div class="modal">
    <button class="modal-x" onclick="closeMail()">âœ•</button>
    <h2>ğŸ“§ Email Your Summary</h2>
    <p>Opens your email client with a pre-filled financial summary. Everything runs locally â€” nothing is stored or transmitted.</p>
    <div class="modal-priv">ğŸ”’ Only approximate financial figures included. No personal identification data.</div>
    <div class="fg"><label>Recipient Email</label><input type="email" id="emailTo" placeholder="yourname@email.com" style="font-family:'DM Sans',sans-serif"></div>
    <div class="fg"><label>Note (optional)</label><textarea id="emailNote" style="width:100%;padding:8px 10px;border:1.5px solid var(--bd);border-radius:7px;font-family:'DM Sans',sans-serif;font-size:12px;color:var(--ink);outline:none;min-height:58px;resize:vertical"></textarea></div>
    <div class="modal-btns"><button class="btn-sec" onclick="closeMail()">Cancel</button><button class="btn-pri" onclick="doEmail()">Open Email Client â†’</button></div>
  </div>
</div>
<script>
// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const on={india:true,uk:true,usa:true,nl:true};
const sOpen={india:true,uk:true,usa:true,nl:true};
const pers={uk:'annual',usa:'annual',nl:'annual',india:'annual'};
let myChart=null;

// â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const el=id=>document.getElementById(id);
const nv=id=>+(el(id)?.value||0);
const sv=id=>el(id)?.value||'';
const set=(id,v)=>{const e=el(id);if(e)e.textContent=v;};
const fmt=(n,sym,d=1)=>sym+(n/d>=1000?Math.round(n/d).toLocaleString():Math.round(n/d));
function fmtPer(n,sym,p){const d={annual:1,monthly:12,weekly:52,biweekly:26}[p]||1;return sym+Math.round(Math.abs(n)/d).toLocaleString();}

// â”€â”€ SIDEBAR MOBILE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleSB(){el('sb').classList.toggle('open');el('bd').classList.toggle('show');}
function closeSB(){el('sb').classList.remove('open');el('bd').classList.remove('show');}

// â”€â”€ COUNTRY TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleC(c){
  on[c]=!on[c];
  const btn=el('cb-'+c);
  btn.className=on[c]?'cbtn on-'+c:'cbtn';
  el('csec-'+c).style.opacity=on[c]?'1':'0.4';
  calc();
}

// â”€â”€ SECTION COLLAPSE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleSec(c){
  sOpen[c]=!sOpen[c];
  el('body-'+c).classList.toggle('closed',!sOpen[c]);
  el('arr-'+c).classList.toggle('o',sOpen[c]);
}

// â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchTab(name,e){
  document.querySelectorAll('.tbtn').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.tpane').forEach(p=>p.classList.remove('active'));
  e.classList.add('active');
  el('tab-'+name).classList.add('active');
  closeSB();
}
function switchSal(c,e){
  document.querySelectorAll('.stab').forEach(t=>t.className='stab');
  document.querySelectorAll('.spane').forEach(p=>p.classList.remove('active'));
  e.classList.add('a-'+c);
  el('sal-'+c).classList.add('active');
}
function setPer(c,p,e){
  pers[c]=p;
  e.closest('.ptabs').querySelectorAll('.ptab').forEach(b=>b.classList.remove('active'));
  e.classList.add('active');
  ({uk:calcUK,usa:calcUSA,nl:calcNL,india:calcIndia})[c]();
}

// â”€â”€ INCOME TOTALS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updTotals(){
  set('ukTot','Â£'+(nv('ukBase')+nv('ukBonus')+nv('ukStock')).toLocaleString());
  set('usaTot','$'+(nv('usaBase')+nv('usaBonus')+nv('usaStock')).toLocaleString());
  set('nlTot','â‚¬'+(nv('nlBase')+nv('nlBonus')+nv('nlStock')).toLocaleString());
  set('inTot','â‚¹'+(nv('inRent')+nv('inDiv')+nv('inFD')+nv('inCG')).toLocaleString());
}

// â”€â”€ UK SALARY CALCULATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcUK(){
  const base=nv('su_base'),bonus=nv('su_bonus'),stock=nv('su_stock');
  const eePct=nv('su_eep'),empPct=nv('su_emp');
  const slPlan=sv('su_sl'),scot=sv('su_scot')==='yes',sac=nv('su_sac')*12;
  const gross=base+bonus+stock;
  const eePen=base*eePct/100,empPen=base*empPct/100;
  const netPen=gross-eePen-sac;
  let pa=12570;
  if(netPen>100000)pa=Math.max(0,12570-Math.floor((netPen-100000)/2));
  const taxable=Math.max(0,netPen-pa);
  let tax=0;
  if(scot){
    const bands=[[2306,.19],[13991,.20],[31092,.21],[62430,.42],[1e9,.48]];
    let r=taxable;for(const[w,rt]of bands){const a=Math.min(r,w);tax+=a*rt;r-=a;if(r<=0)break;}
  } else {
    tax=Math.min(taxable,37700)*.20+Math.min(Math.max(0,taxable-37700),112570-37700)*.40+Math.max(0,taxable-112570)*.45;
  }
  let ni=0;
  if(netPen>12570){ni=Math.min(netPen-12570,50270-12570)*.08+Math.max(0,netPen-50270)*.02;}
  const slT={plan1:24990,plan2:27295,plan5:25000};
  const slAmt=slPlan!=='none'&&slT[slPlan]?Math.max(0,netPen-slT[slPlan])*.09:0;
  const th=netPen-tax-ni-slAmt;
  const p=pers.uk;
  const f=(x,sym='Â£')=>sym+Math.round(Math.abs(x)/({annual:1,monthly:12,weekly:52}[p]||1)).toLocaleString();
  set('uk_base',f(base));set('uk_bonus',f(bonus));set('uk_stock',f(stock));set('uk_gross',f(gross));
  set('uk_tax','âˆ’'+f(tax));set('uk_ni','âˆ’'+f(ni));set('uk_eep','âˆ’'+f(eePen));
  set('uk_sl',slAmt>0?'âˆ’'+f(slAmt):'âˆ’Â£0');set('uk_sac',sac>0?'âˆ’'+f(sac):'âˆ’Â£0');
  set('uk_th',f(th));set('uk_empp','+'+f(empPen));
  set('uk_eff',netPen>0?Math.round((tax+ni)/netPen*100)+'%':'0%');
  set('uk_marg',netPen>125140?'45%':netPen>50270?'40%':'20%');
  const isaUsed=Math.min(20000,nv('isa')*12);
  set('uk_isa_l','Â£'+(20000-isaUsed).toLocaleString()+'/yr');
  set('uk_sipp_l','Â£'+Math.min(60000,Math.max(0,gross-nv('sipp')*12)).toLocaleString()+'/yr');
  return{gross,th,tax,ni,eePen,empPen};
}

// â”€â”€ USA SALARY CALCULATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcUSA(){
  const base=nv('uu_base'),bonus=nv('uu_bonus'),stock=nv('uu_stock');
  const filing=sv('uu_filing'),stRate=nv('uu_state')/100;
  const k401=Math.min(nv('uu_401k')*12,23500),hsaA=Math.min(nv('uu_hsa')*12,4300),pre=nv('uu_pre')*12;
  const gross=base+bonus+stock;
  const preTax=k401+hsaA+pre;
  const agi=Math.max(0,gross-preTax);
  const stdDed=filing==='mfj'?30000:15000;
  const taxInc=Math.max(0,agi-stdDed);
  const fedB=filing==='mfj'?[[23850,.10],[73100,.12],[109750,.22],[206700,.24],[194100,.32],[62900,.35],[1e9,.37]]:[[11925,.10],[36550,.12],[54875,.22],[103350,.24],[97050,.32],[31450,.35],[1e9,.37]];
  let fedTax=0,r=taxInc;for(const[w,rt]of fedB){const a=Math.min(r,w);fedTax+=a*rt;r-=a;if(r<=0)break;}
  const ss=Math.min(gross,176100)*.062;
  const mc=gross*.0145+(gross>200000?(gross-200000)*.009:0);
  const stateTax=agi*stRate;
  const th=gross-fedTax-ss-mc-stateTax-preTax;
  const p=pers.usa;
  const f=(x,sym='$')=>sym+Math.round(Math.abs(x)/({annual:1,monthly:12,biweekly:26}[p]||1)).toLocaleString();
  const fedMarg=taxInc>523601?37:taxInc>209426?35:taxInc>164926?32:taxInc>86376?24:taxInc>40526?22:taxInc>9951?12:10;
  set('ua_base',f(base));set('ua_bonus',f(bonus));set('ua_stock',f(stock));set('ua_gross',f(gross));
  set('ua_fed','âˆ’'+f(fedTax));set('ua_ss','âˆ’'+f(ss));set('ua_mc','âˆ’'+f(mc));
  set('ua_state',stateTax>0?'âˆ’'+f(stateTax):'âˆ’$0');
  set('ua_401k','âˆ’'+f(k401));set('ua_hsa','âˆ’'+f(hsaA));
  set('ua_th',f(th));
  set('ua_eff',gross>0?Math.round((fedTax+ss+mc+stateTax)/gross*100)+'%':'0%');
  set('ua_marg',fedMarg+'%');
  set('ua_fbar','If India accounts >$10K at any point');
  set('ua_401l','$'+Math.max(0,23500-k401).toLocaleString()+'/yr');
  return{gross,th,fedTax,ss,mc,stateTax};
}

// â”€â”€ NL SALARY CALCULATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcNL(){
  const base=nv('un_base'),bonus=nv('un_bonus'),stock=nv('un_stock');
  const rule30=sv('un_30')==='yes',healthMo=nv('un_health'),penPct=nv('un_pen');
  const gross=base+bonus+stock;
  const health=healthMo*12,pension=base*penPct/100;
  const exempt30=rule30?gross*.30:0;
  const taxable=Math.max(0,gross-exempt30-pension);
  let tax=taxable<=38441?taxable*.3697:38441*.3697+(taxable-38441)*.495;
  // Arbeidskorting approximation + Algemene heffingskorting
  const ahk=Math.max(0,3362-(Math.max(0,taxable-22660)*.06095));
  const ak=taxable<=11491?taxable*.08231:taxable<=24820?945+(taxable-11491)*.02913:taxable<=39957?1334:Math.max(0,1334-(taxable-39957)*.006);
  tax=Math.max(0,tax-ahk-ak);
  const th=gross-tax-pension-health;
  const p=pers.nl;
  const f=(x,sym='â‚¬')=>sym+Math.round(Math.abs(x)/({annual:1,monthly:12}[p]||1)).toLocaleString();
  set('un_base_r',f(base));set('un_bonus_r',f(bonus));set('un_stock_r',f(stock));set('un_gross',f(gross));
  set('un_30r',rule30?f(exempt30):'â‚¬0');set('un_taxable',f(taxable));
  set('un_tax','âˆ’'+f(tax));set('un_pen_r','âˆ’'+f(pension));set('un_health_r','âˆ’'+f(health));
  set('un_th',f(th));
  set('un_eff',gross>0?Math.round(tax/gross*100)+'%':'0%');
  const nlSavingsAnn=(nv('nlBrok')+nv('nlCash'))*12;
  set('un_box3',nlSavingsAnn>57000?'~â‚¬'+Math.round((nlSavingsAnn-57000)*.0103).toLocaleString()+'/yr':'â‚¬0 (below threshold)');
  return{gross,th,tax};
}

// â”€â”€ INDIA NRI TAX â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcIndia(){
  const rent=nv('si_rent'),div=nv('si_div'),fd=nv('si_fd'),ltcg=nv('si_ltcg'),stcg=nv('si_stcg');
  const dtaaRate=+(sv('si_dtaa')||0.15);
  const fxI=nv('fxI')||107;
  const rentNet=rent*.70,totalGross=rentNet+div+fd+ltcg+stcg;
  const fdTds=fd*.30,divTds=div*.20,ltcgTax=Math.max(0,ltcg-125000)*.125,stcgTax=stcg*.20;
  const totalTax=fdTds+divTds+ltcgTax+stcgTax;
  const net=totalGross-totalTax;
  const form10FSave=fd*(0.30-dtaaRate);
  const dtaaCredit=totalTax/fxI;
  const p=pers.india;
  const fi=(x)=>'â‚¹'+Math.round(Math.abs(x)/({annual:1,monthly:12}[p]||1)).toLocaleString();
  const fg=(x)=>'Â£'+Math.round(Math.abs(x)/({annual:1,monthly:12}[p]||1)).toLocaleString();
  set('si_rent_r',fi(rentNet));set('si_div_r',fi(div));set('si_fd_r',fi(fd));
  set('si_cg_r',fi(ltcg+stcg));set('si_gross',fi(totalGross));
  set('si_fdtds','âˆ’'+fi(fdTds));set('si_divtds','âˆ’'+fi(divTds));
  set('si_ltcgt','âˆ’'+fi(ltcgTax));set('si_totaltax','âˆ’'+fi(totalTax));
  set('si_net',fi(net));set('si_dtaa_r','+'+fg(dtaaCredit));
  set('si_10f','â‚¹'+Math.round(form10FSave).toLocaleString()+'/yr');
  return{totalGross,totalTax,net,form10FSave,dtaaCredit};
}

// â”€â”€ MAIN CALCULATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calc(){
  const age=nv('age'),goalAmt=nv('goalAmt'),goalAge=nv('goalAge');
  const risk=sv('risk'),horizon=Math.max(1,goalAge-age);
  const fxI=nv('fxI')||107,fxU=nv('fxU')||0.79,fxE=nv('fxE')||0.85;

  // UK savings in Â£
  const isaA=nv('isa'),sippA=nv('sipp'),ukCashA=nv('ukCash');
  const ukSav=on.uk?(isaA+sippA+ukCashA)*12:0;

  // UK take-home approx
  const ukGross=nv('ukBase')+nv('ukBonus')+nv('ukStock');
  let ukTH=0;
  if(on.uk){
    const pa=ukGross>100000?Math.max(0,12570-Math.floor((ukGross-100000)/2)):12570;
    const t=Math.max(0,ukGross-nv('ukBase')*(nv('ukPen')/100)-pa);
    const tax=Math.min(t,37700)*.20+Math.max(0,t-37700)*.40;
    const ni=ukGross>12570?Math.min(ukGross-12570,50270-12570)*.08+Math.max(0,ukGross-50270)*.02:0;
    ukTH=ukGross-tax-ni-nv('ukBase')*(nv('ukPen')/100);
  }

  // USA savings in Â£
  const k401A=nv('k401'),rothA=nv('roth'),hsaA=nv('hsa'),usaBrokA=nv('usaBrok');
  const usaSav=on.usa?(k401A+rothA+hsaA+usaBrokA)*12*fxU:0;
  const usaGross=nv('usaBase')+nv('usaBonus')+nv('usaStock');
  let usaTH=0;
  if(on.usa){
    const k=Math.min(k401A*12,23500),h=Math.min(hsaA*12,4300);
    const agi=Math.max(0,usaGross-k-h);
    const tI=Math.max(0,agi-15000);
    const fb=[[11925,.10],[36550,.12],[54875,.22],[103350,.24],[97050,.32],[31450,.35],[1e9,.37]];
    let fedT=0,r=tI;for(const[w,rt]of fb){const a=Math.min(r,w);fedT+=a*rt;r-=a;if(r<=0)break;}
    const ss=Math.min(usaGross,176100)*.062,mc=usaGross*.0145;
    usaTH=usaGross-fedT-ss-mc-k-h;
  }

  // NL savings in Â£
  const nlPenA=nv('nlPen'),nlBrokA=nv('nlBrok'),nlCashA=nv('nlCash');
  const nlSav=on.nl?(nlPenA+nlBrokA+nlCashA)*12*fxE:0;
  const nlGross=nv('nlBase')+nv('nlBonus')+nv('nlStock');
  let nlTH=0;
  if(on.nl){
    const r30=sv('nl30')==='yes',tG=Math.max(0,nlGross*(r30?.70:1));
    const tax=tG<=38441?tG*.3697:38441*.3697+(tG-38441)*.495;
    nlTH=nlGross-Math.max(0,tax-3362)-(nv('nlBase')*(nv('nlPen')/100||5/100))-140*12;
  }

  // India savings in Â£
  const nreFDA=nv('nreFD'),nroFDA=nv('nroFD'),mfA=nv('mf');
  const indiaSav=on.india?(nreFDA+nroFDA+mfA)*12/fxI:0;

  const totalSav=ukSav+usaSav+nlSav+indiaSav;
  const pct=goalAmt>0?Math.min(99,Math.round(totalSav/goalAmt*100)):0;

  // Update summary cards visibility
  ['uk','usa','nl','india'].forEach(c=>el('sc-'+c)?.style.setProperty('display',on[c]?'':'none'));

  set('cv-uk','Â£'+Math.round(ukTH/1000)+'K');
  set('cs-uk','Base Â£'+Math.round(nv('ukBase')/1000)+'K + Bonus Â£'+Math.round(nv('ukBonus')/1000)+'K + Stock Â£'+Math.round(nv('ukStock')/1000)+'K');
  set('cv-usa','$'+Math.round(usaTH/1000)+'K');
  set('cs-usa','Federal + FICA + state deducted');
  set('cv-nl','â‚¬'+Math.round(nlTH/1000)+'K');
  set('cs-nl',sv('nl30')==='yes'?'Incl. 30% ruling benefit':'Box 1 tax applied');
  set('cv-india','â‚¹'+((nreFDA+nroFDA+mfA)*12/100000).toFixed(1)+'L');
  set('cv-total','Â£'+Math.round(totalSav/1000)+'K');
  set('cs-total','Combined all active countries annually');
  set('cv-goal',pct+'%');
  set('cs-goal','Saving Â£'+Math.round(totalSav/1000)+'K/yr toward Â£'+Math.round(goalAmt/1000)+'K');
  set('cv-yrs',horizon+'');
  set('cs-yrs','Age '+age+' â†’ '+goalAge);
  el('gbarFill').style.width=pct+'%';
  set('gmetaL','Â£'+Math.round(totalSav/1000)+'K/yr saving toward Â£'+Math.round(goalAmt/1000)+'K target');
  set('gmetaR',horizon+' years to goal age '+goalAge);

  // Tax tab
  set('t_ukG','Â£'+ukGross.toLocaleString());
  const ukTaxEst=Math.min(Math.max(0,ukGross-12570),37700)*.20+Math.max(0,Math.max(0,ukGross-12570)-37700)*.40;
  const ukNIEst=ukGross>12570?Math.min(ukGross-12570,50270-12570)*.08+Math.max(0,ukGross-50270)*.02:0;
  set('t_ukT','âˆ’Â£'+Math.round(ukTaxEst).toLocaleString());
  set('t_ukNI','âˆ’Â£'+Math.round(ukNIEst).toLocaleString());
  set('t_sipp','+Â£'+Math.round(sippA*12*0.40).toLocaleString()+'/yr');
  set('t_nreTax','âˆ’Â£'+Math.round(nreFDA*12*.075/fxI*.40).toLocaleString());
  set('t_usaG','$'+usaGross.toLocaleString());
  const usaFedEst=Math.min(Math.max(0,usaGross-15000),36550)*.12+Math.min(Math.max(0,usaGross-48475),54875)*.22+Math.max(0,Math.min(usaGross-103350,0))*.24;
  set('t_usaT','âˆ’$'+Math.round(usaFedEst).toLocaleString());
  set('t_fica','âˆ’$'+Math.round(Math.min(usaGross,176100)*.062+usaGross*.0145).toLocaleString());
  set('t_401ks','Saves ~$'+Math.round(Math.min(k401A*12,23500)*.22).toLocaleString()+'/yr');
  const fbarCheck=(nreFDA+nroFDA)*12/fxI*fxU;
  set('t_fbar',fbarCheck>10000?'âš  Required â€” file by Apr 15':'Not required (check annually)');
  set('t_nlG','â‚¬'+nlGross.toLocaleString());
  set('t_nl30',sv('nl30')==='yes'?'â‚¬'+Math.round(nlGross*.30).toLocaleString():'N/A');
  const nlTaxEst=nlGross*.70<=38441?nlGross*.70*.3697:38441*.3697+(nlGross*.70-38441)*.495;
  set('t_nlT','âˆ’â‚¬'+Math.round(Math.max(0,nlTaxEst-3362)).toLocaleString());
  const inT=nv('inRent')*.70+nv('inDiv')+nv('inFD')+nv('inCG');
  set('t_inG','â‚¹'+Math.round(inT).toLocaleString());
  set('t_nroTDS','âˆ’â‚¹'+Math.round(nroFDA*12*.30).toLocaleString()+'/yr');
  set('t_10f','â‚¹'+Math.round(nroFDA*12*.15).toLocaleString()+'/yr');

  buildStrategy({ukSav,usaSav,nlSav,indiaSav,totalSav,ukGross,usaGross,nlGross,horizon,goalAmt,risk,isaA,sippA,k401A,nreFDA,nroFDA,fxI,fxU,fxE});
  updateChart({isaA,sippA,ukCashA,nreFDA,nroFDA,mfA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nlCashA,fxI,fxU,fxE,horizon,goalAmt,risk});
  updateAlloc({ukSav,usaSav,nlSav,indiaSav,isaA,sippA,ukCashA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nreFDA,nroFDA,mfA,fxU,fxE,fxI});
  calcUK();calcUSA();calcNL();calcIndia();
  updTx();
}

// â”€â”€ STRATEGY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildStrategy({ukSav,usaSav,nlSav,indiaSav,totalSav,ukGross,usaGross,nlGross,horizon,goalAmt,risk,isaA,sippA,k401A,nreFDA,nroFDA,fxI}){
  const R={conservative:{uk:.055,usa:.055,nl:.045,india:.075},moderate:{uk:.08,usa:.085,nl:.07,india:.095},aggressive:{uk:.10,usa:.11,nl:.09,india:.12}};
  const r=R[risk]||R.moderate;
  const fv=(ann,rate,yr)=>ann&&yr?ann*((Math.pow(1+rate,yr)-1)/rate):0;
  const ukFV=fv(ukSav,r.uk,horizon),usaFV=fv(usaSav,r.usa,horizon),nlFV=fv(nlSav,r.nl,horizon),indFV=fv(indiaSav,r.india,horizon);
  const totFV=ukFV+usaFV+nlFV+indFV;
  const onTrack=totFV>=goalAmt*.95,gap=Math.max(0,goalAmt-totFV);
  const extra=gap>0?gap/((Math.pow(1.08,horizon)-1)/.08)/12:0;
  const cards=[];
  if(on.uk)cards.push(`<div class="scard"><h3>ğŸ‡¬ğŸ‡§ UK</h3>
    <div class="si">${20000-Math.min(20000,isaA*12)>0?'<strong>ISA headroom: Â£'+Math.round((20000-Math.min(20000,isaA*12))/12)+'/mo</strong> unused â€” tax-free growth potential':'âœ… ISA fully utilised'}</div>
    <div class="si"><strong>SIPP: +Â£${Math.round(sippA*12*.40).toLocaleString()}/yr</strong> tax relief â€” effective 40% subsidy</div>
    <div class="si">${ukGross>50270?'âš  <strong>40% taxpayer</strong> â€” max SIPP to reduce taxable income below Â£50K':'âœ… Basic rate band â€” prioritise ISA first'}</div>
    <div class="si">Projected at ${(r.uk*100).toFixed(0)}%/yr: <strong>Â£${Math.round(ukFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  if(on.usa)cards.push(`<div class="scard"><h3>ğŸ‡ºğŸ‡¸ USA</h3>
    <div class="si"><strong>Max 401(k) first</strong> â€” ${Math.max(0,23500-k401A*12)>0?'$'+Math.round(Math.max(0,23500-k401A*12)/12)+'/mo headroom left':'âœ… Maxed'} â€” pre-tax reduces federal AGI</div>
    <div class="si"><strong>HSA triple tax</strong> â€” pre-tax in, tax-free growth, tax-free for medical. Max it ($4,300/yr self)</div>
    <div class="si">âš  <strong>Avoid Indian MFs</strong> â€” PFIC rules = punitive tax + Form 8621. Use INDA/SMIN ETFs instead</div>
    <div class="si">âš  <strong>File FBAR</strong> if NRE+NRO total >$10K. Penalty: $10K+ per violation</div>
    <div class="si">Projected at ${(r.usa*100).toFixed(0)}%/yr: <strong>Â£${Math.round(usaFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  if(on.nl)cards.push(`<div class="scard"><h3>ğŸ‡³ğŸ‡± Netherlands</h3>
    <div class="si">${sv('nl30')==='yes'?'âœ… <strong>30% ruling active</strong> â€” 30% of salary tax-exempt. Valid max 5 years â€” use fully':'âš  Check 30% ruling eligibility â€” worth ~15% net pay increase'}</div>
    <div class="si"><strong>Prioritise pensioenrekening</strong> over beleggingsrekening â€” pension reduces Box 1; savings above â‚¬57K face Box 3 wealth tax</div>
    <div class="si">NRE FD: declare balance on Jan 1 in <strong>Box 3</strong> (not income tax)</div>
    <div class="si">Projected at ${(r.nl*100).toFixed(0)}%/yr: <strong>Â£${Math.round(nlFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  if(on.india)cards.push(`<div class="scard"><h3>ğŸ‡®ğŸ‡³ India (NRI)</h3>
    <div class="si"><strong>NRE over NRO</strong> â€” NRE interest tax-free in India. NRO suffers 30% TDS (â†’15% with Form 10F + TRC)</div>
    <div class="si"><strong>FCNR(B)</strong> over NRE FD â€” hold in GBP/USD to eliminate forex risk entirely</div>
    <div class="si">Form 10F saves: <strong>â‚¹${Math.round(nroFDA*12*.15).toLocaleString()}/yr</strong> â€” get TRC from HMRC/IRS/Belastingdienst</div>
    <div class="si">Projected at ${(r.india*100).toFixed(0)}%/yr: <strong>Â£${Math.round(indFV/1000)}K</strong> in ${horizon}yr</div></div>`);
  cards.push(`<div class="scard"><h3>ğŸ¯ Goal Status</h3>
    <div class="si">${onTrack?`<strong style="color:#7fd4a8">âœ… On track!</strong> Projected Â£${Math.round(totFV/1000)}K vs goal Â£${Math.round(goalAmt/1000)}K`:`<strong style="color:#f4a07a">âš  Gap: Â£${Math.round(gap/1000)}K</strong><br>Proj. Â£${Math.round(totFV/1000)}K vs target Â£${Math.round(goalAmt/1000)}K`}</div>
    ${gap>0?`<div class="si">Need <strong>+Â£${Math.round(extra).toLocaleString()}/mo</strong> extra to close gap by age ${nv('goalAge')}</div>`:''}
    <div class="si">UK Â£${Math.round(ukFV/1000)}K Â· USA Â£${Math.round(usaFV/1000)}K Â· NL Â£${Math.round(nlFV/1000)}K Â· India Â£${Math.round(indFV/1000)}K</div>
    <div class="si">Top priority: ${ukGross>50270?'Max UK SIPP (40% band)':usaGross>0?'Max 401(k) + HSA (USA)':'Optimise NRE FD + pension'}</div></div>`);
  el('stratGrid').innerHTML=cards.join('');
}

// â”€â”€ CHART â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateChart({isaA,sippA,ukCashA,nreFDA,nroFDA,mfA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nlCashA,fxI,fxU,fxE,horizon,goalAmt,risk}){
  const R={conservative:{uk:.055,usa:.055,nl:.045,india:.075},moderate:{uk:.08,usa:.085,nl:.07,india:.095},aggressive:{uk:.10,usa:.11,nl:.09,india:.12}};
  const r=R[risk]||R.moderate;
  const yrs=Array.from({length:horizon+1},(_,i)=>i);
  const fv=(m,rate,y)=>m&&y?m*12*((Math.pow(1+rate,y)-1)/rate):0;
  const ukD=yrs.map(y=>Math.round(fv(isaA,r.uk,y)+fv(sippA,r.uk,y)+fv(ukCashA,r.uk*.6,y)));
  const usaD=yrs.map(y=>Math.round((fv(k401A,r.usa,y)+fv(rothA,r.usa,y)+fv(hsaA,r.usa,y)+fv(usaBrokA,r.usa*.8,y))*fxU));
  const nlD=yrs.map(y=>Math.round((fv(nlPenA,r.nl,y)+fv(nlBrokA,r.nl*.85,y)+fv(nlCashA,r.nl*.55,y))*fxE));
  const indD=yrs.map(y=>Math.round((fv(nreFDA,r.india,y)+fv(nroFDA,r.india*.7,y)+fv(mfA,r.india*1.2,y))/fxI));
  const totD=yrs.map((_,i)=>ukD[i]+usaD[i]+nlD[i]+indD[i]);
  const goalLine=yrs.map(()=>goalAmt);
  const sets=[];
  if(on.uk)sets.push({label:'ğŸ‡¬ğŸ‡§ UK',data:ukD,borderColor:'#1a3a6b',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  if(on.usa)sets.push({label:'ğŸ‡ºğŸ‡¸ USA',data:usaD,borderColor:'#b22234',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  if(on.nl)sets.push({label:'ğŸ‡³ğŸ‡± Netherlands',data:nlD,borderColor:'#e67000',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  if(on.india)sets.push({label:'ğŸ‡®ğŸ‡³ India',data:indD,borderColor:'#e05c2a',borderWidth:2,tension:.4,fill:false,pointRadius:0});
  sets.push({label:'Total (Â£)',data:totD,borderColor:'#c9a84c',backgroundColor:'rgba(201,168,76,.07)',fill:true,borderWidth:2.5,tension:.4,pointRadius:0});
  sets.push({label:'Goal Â£'+Math.round(goalAmt/1000)+'K',data:goalLine,borderColor:'rgba(45,122,79,.5)',borderWidth:1.5,borderDash:[5,4],fill:false,pointRadius:0});
  const ctx=el('growthChart').getContext('2d');
  if(myChart)myChart.destroy();
  myChart=new Chart(ctx,{type:'line',data:{labels:yrs.map(y=>y+'yr'),datasets:sets},options:{responsive:true,interaction:{mode:'index',intersect:false},plugins:{legend:{labels:{font:{family:'DM Sans',size:10},color:'#0f0e0d'}}},scales:{x:{grid:{display:false},ticks:{font:{family:'DM Mono',size:9},maxTicksLimit:8}},y:{ticks:{font:{family:'DM Mono',size:9},callback:v=>'Â£'+(v>=1e6?(v/1e6).toFixed(1)+'M':v>=1000?Math.round(v/1000)+'K':v)}}}}});
}

// â”€â”€ ALLOC BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateAlloc({ukSav,usaSav,nlSav,indiaSav,isaA,sippA,ukCashA,k401A,rothA,hsaA,usaBrokA,nlPenA,nlBrokA,nreFDA,nroFDA,mfA,fxU,fxE,fxI}){
  const segs=[];
  if(on.uk){if(isaA)segs.push({l:'ISA',v:isaA*12,c:'#1a3a6b'});if(sippA)segs.push({l:'SIPP',v:sippA*12,c:'#3a5a9b'});if(ukCashA)segs.push({l:'Cash',v:ukCashA*12,c:'#6a8fcb'});}
  if(on.usa){if(k401A)segs.push({l:'401k',v:k401A*12*fxU,c:'#8b1a1a'});if(rothA)segs.push({l:'Roth',v:rothA*12*fxU,c:'#b22234'});if(hsaA)segs.push({l:'HSA',v:hsaA*12*fxU,c:'#d04060'});if(usaBrokA)segs.push({l:'Brok.',v:usaBrokA*12*fxU,c:'#e06080'});}
  if(on.nl){if(nlPenA)segs.push({l:'NL Pen',v:nlPenA*12*fxE,c:'#994d00'});if(nlBrokA)segs.push({l:'NL Inv',v:nlBrokA*12*fxE,c:'#e67000'});}
  if(on.india){if(nreFDA)segs.push({l:'NRE',v:nreFDA*12/fxI,c:'#e05c2a'});if(nroFDA)segs.push({l:'NRO',v:nroFDA*12/fxI,c:'#e88a63'});if(mfA)segs.push({l:'MF',v:mfA*12/fxI,c:'#c9a84c'});}
  const tot=segs.reduce((s,x)=>s+x.v,0)||1;
  el('allocBar').innerHTML=segs.map(s=>`<div class="aseg" style="flex:${Math.round(s.v/tot*1000)};background:${s.c}">${s.l}</div>`).join('');
  el('allocLeg').innerHTML=segs.map(s=>`<div class="aleg-item"><div class="adot" style="background:${s.c}"></div>${s.l} (Â£${Math.round(s.v/1000)}K/yr)</div>`).join('');
}

// â”€â”€ TRANSFER CALC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updTx(){
  const amt=nv('txAmt'),curr=sv('txCurr');
  const fxI=nv('fxI')||107,fxU=nv('fxU')||0.79,fxE=nv('fxE')||0.85;
  let inr=0;
  if(curr==='gbp')inr=amt*fxI*.994;
  else if(curr==='usd')inr=amt*(fxI/fxU)*.994;
  else if(curr==='eur')inr=amt*(fxI/fxE)*.994;
  el('txResult').textContent='â‚¹'+Math.round(inr).toLocaleString();
}

// â”€â”€ EMAIL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openMail(){el('emailModal').classList.add('open');}
function closeMail(){el('emailModal').classList.remove('open');}
function doEmail(){
  const to=el('emailTo').value.trim();
  if(!to||!to.includes('@')){alert('Please enter a valid email address.');return;}
  const note=el('emailNote').value;
  const ctry=Object.keys(on).filter(k=>on[k]).join('+').toUpperCase();
  const sub=`Global NRI Savings Summary â€” ${new Date().toLocaleDateString('en-GB')} (${ctry})`;
  const body=`Global NRI Savings Optimizer â€” Financial Summary
Generated: ${new Date().toLocaleString('en-GB')}
Active Countries: ${ctry} | Risk: ${sv('risk')}

WEALTH GOAL
Target: Â£${nv('goalAmt').toLocaleString()} by age ${nv('goalAge')} (current age ${nv('age')})

UK
Base: Â£${nv('ukBase').toLocaleString()} | Bonus: Â£${nv('ukBonus').toLocaleString()} | RSU: Â£${nv('ukStock').toLocaleString()}
ISA: Â£${nv('isa')}/mo | SIPP: Â£${nv('sipp')}/mo | Cash: Â£${nv('ukCash')}/mo
Student Loan: ${sv('ukSL')} | Scotland: ${sv('ukScot')}

USA
Base: $${nv('usaBase').toLocaleString()} | Bonus: $${nv('usaBonus').toLocaleString()} | RSU: $${nv('usaStock').toLocaleString()}
401(k): $${nv('k401')}/mo | Roth IRA: $${nv('roth')}/mo | HSA: $${nv('hsa')}/mo | Brokerage: $${nv('usaBrok')}/mo
State: ${sv('usaState')}% | Filing: ${sv('usaFiling')}

NETHERLANDS
Base: â‚¬${nv('nlBase').toLocaleString()} | Bonus: â‚¬${nv('nlBonus').toLocaleString()} | RSU: â‚¬${nv('nlStock').toLocaleString()}
Pensioenrekening: â‚¬${nv('nlPen')}/mo | Beleggingsrekening: â‚¬${nv('nlBrok')}/mo | Cash: â‚¬${nv('nlCash')}/mo
30% Ruling: ${sv('nl30')}

INDIA (NRI)
NRE FD: â‚¹${nv('nreFD')}/mo | NRO FD: â‚¹${nv('nroFD')}/mo | Mutual Funds: â‚¹${nv('mf')}/mo
Rental: â‚¹${nv('inRent').toLocaleString()}/yr | FD Interest: â‚¹${nv('inFD').toLocaleString()}/yr

KEY REMINDERS
UK: Declare NRE FD interest on SA106; ISA max Â£20K/yr
USA: File FBAR if India accounts >$10K; avoid Indian MFs (PFIC); Form 8938 (FATCA)
Netherlands: Declare India assets in Box 3 on Jan 1; check 30% ruling eligibility
India: Form 10F + TRC to reduce NRO TDS 30%â†’15%; PIS for equity trading

DISCLAIMER: Educational only. Not financial/tax/legal advice. Consult CA/IFA/CPA/SEBI advisor.
${note?'\nNOTE:\n'+note:''}
â€” Global NRI Savings Optimizer`;
  window.location.href=`mailto:${encodeURIComponent(to)}?subject=${encodeURIComponent(sub)}&body=${encodeURIComponent(body)}`;
  closeMail();
}
el('emailModal').addEventListener('click',e=>{if(e.target===el('emailModal'))closeMail();});

// â”€â”€ AI CHAT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SYS=`You are an expert multi-country NRI finance education assistant specialising in India, UK, USA and Netherlands. Cover FEMA, NRE/NRO accounts, DTAA treaties, ISA/SIPP (UK), 401k/Roth IRA/HSA/PFIC/FBAR/FATCA (USA), 30% ruling/Box 1/Box 2/Box 3 taxes (Netherlands), and cross-border wealth planning. Always clarify this is educational information, not regulated financial advice. Recommend a qualified CA/IFA/CPA/SEBI advisor for specific decisions. Use **bold** for key terms. Be practical and accurate.`;
function getCtx(){return `User profile: Age=${nv('age')}, Goal=Â£${nv('goalAmt')} by age ${nv('goalAge')}, Risk=${sv('risk')}, Countries active=${Object.keys(on).filter(k=>on[k]).join('+')}. UK gross=Â£${nv('ukBase')+nv('ukBonus')+nv('ukStock')}, USA gross=$${nv('usaBase')+nv('usaBonus')+nv('usaStock')}, NL gross=â‚¬${nv('nlBase')+nv('nlBonus')+nv('nlStock')}, NRE FD=â‚¹${nv('nreFD')}/mo, NRO FD=â‚¹${nv('nroFD')}/mo, 30% ruling=${sv('nl30')}.`;}
async function askQ(q){el('chatIn').value=q;sendMsg();}
async function sendMsg(){
  const input=el('chatIn'),msg=input.value.trim();if(!msg)return;
  const cw=el('chatWin'),sb=el('sendBtn');
  cw.innerHTML+=`<div class="msg user"><div class="mb">${msg}</div><div class="mtime">${new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</div></div>`;
  input.value='';sb.disabled=true;
  const tid='t'+Date.now();
  cw.innerHTML+=`<div class="msg ai" id="${tid}"><div class="mb"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div></div>`;
  cw.scrollTop=cw.scrollHeight;
  try{
    const res=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:1000,system:SYS,messages:[{role:'user',content:`${getCtx()}\n\nQuestion: ${msg}`}]})});
    const data=await res.json();
    const reply=data.content?.map(c=>c.text||'').join('')||'Unable to get a response. Please try again.';
    el(tid)?.remove();
    cw.innerHTML+=`<div class="msg ai"><div class="mb">${reply.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/\n/g,'<br>')}</div><div class="mtime">${new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</div></div>`;
  }catch(e){
    el(tid)?.remove();
    cw.innerHTML+=`<div class="msg ai"><div class="mb">âš ï¸ Connection error. Please check your network and try again.</div></div>`;
  }
  sb.disabled=false;cw.scrollTop=cw.scrollHeight;
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.onload=()=>{updTotals();calc();};
</script>
</body>
</html>
